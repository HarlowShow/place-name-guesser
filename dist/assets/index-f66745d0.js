(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function ma(e,t){const n=Object.create(null),r=e.split(",");for(let s=0;s<r.length;s++)n[r[s]]=!0;return t?s=>!!n[s.toLowerCase()]:s=>!!n[s]}const ut={},Fn=[],ue=()=>{},Gd=()=>!1,Xd=/^on[^a-z]/,_i=e=>Xd.test(e),_a=e=>e.startsWith("onUpdate:"),bt=Object.assign,ya=(e,t)=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)},Yd=Object.prototype.hasOwnProperty,J=(e,t)=>Yd.call(e,t),j=Array.isArray,Ln=e=>yi(e)==="[object Map]",Au=e=>yi(e)==="[object Set]",z=e=>typeof e=="function",wt=e=>typeof e=="string",Ea=e=>typeof e=="symbol",pt=e=>e!==null&&typeof e=="object",va=e=>pt(e)&&z(e.then)&&z(e.catch),Ru=Object.prototype.toString,yi=e=>Ru.call(e),Jd=e=>yi(e).slice(8,-1),Pu=e=>yi(e)==="[object Object]",Ta=e=>wt(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,Us=ma(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Ei=e=>{const t=Object.create(null);return n=>t[n]||(t[n]=e(n))},Zd=/-(\w)/g,Qn=Ei(e=>e.replace(Zd,(t,n)=>n?n.toUpperCase():"")),tp=/\B([A-Z])/g,or=Ei(e=>e.replace(tp,"-$1").toLowerCase()),Cu=Ei(e=>e.charAt(0).toUpperCase()+e.slice(1)),ro=Ei(e=>e?`on${Cu(e)}`:""),Mr=(e,t)=>!Object.is(e,t),so=(e,t)=>{for(let n=0;n<e.length;n++)e[n](t)},Qs=(e,t,n)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:n})},ep=e=>{const t=parseFloat(e);return isNaN(t)?e:t},np=e=>{const t=wt(e)?Number(e):NaN;return isNaN(t)?e:t};let jl;const Co=()=>jl||(jl=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function pn(e){if(j(e)){const t={};for(let n=0;n<e.length;n++){const r=e[n],s=wt(r)?op(r):pn(r);if(s)for(const i in s)t[i]=s[i]}return t}else{if(wt(e))return e;if(pt(e))return e}}const rp=/;(?![^(]*\))/g,sp=/:([^]+)/,ip=/\/\*[^]*?\*\//g;function op(e){const t={};return e.replace(ip,"").split(rp).forEach(n=>{if(n){const r=n.split(sp);r.length>1&&(t[r[0].trim()]=r[1].trim())}}),t}function vi(e){let t="";if(wt(e))t=e;else if(j(e))for(let n=0;n<e.length;n++){const r=vi(e[n]);r&&(t+=r+" ")}else if(pt(e))for(const n in e)e[n]&&(t+=n+" ");return t.trim()}const ap="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",lp=ma(ap);function Su(e){return!!e||e===""}const Bn=e=>wt(e)?e:e==null?"":j(e)||pt(e)&&(e.toString===Ru||!z(e.toString))?JSON.stringify(e,bu,2):String(e),bu=(e,t)=>t&&t.__v_isRef?bu(e,t.value):Ln(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((n,[r,s])=>(n[`${r} =>`]=s,n),{})}:Au(t)?{[`Set(${t.size})`]:[...t.values()]}:pt(t)&&!j(t)&&!Pu(t)?String(t):t;let oe;class cp{constructor(t=!1){this.detached=t,this._active=!0,this.effects=[],this.cleanups=[],this.parent=oe,!t&&oe&&(this.index=(oe.scopes||(oe.scopes=[])).push(this)-1)}get active(){return this._active}run(t){if(this._active){const n=oe;try{return oe=this,t()}finally{oe=n}}}on(){oe=this}off(){oe=this.parent}stop(t){if(this._active){let n,r;for(n=0,r=this.effects.length;n<r;n++)this.effects[n].stop();for(n=0,r=this.cleanups.length;n<r;n++)this.cleanups[n]();if(this.scopes)for(n=0,r=this.scopes.length;n<r;n++)this.scopes[n].stop(!0);if(!this.detached&&this.parent&&!t){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0,this._active=!1}}}function up(e,t=oe){t&&t.active&&t.effects.push(e)}function hp(){return oe}const wa=e=>{const t=new Set(e);return t.w=0,t.n=0,t},Vu=e=>(e.w&Ze)>0,Du=e=>(e.n&Ze)>0,fp=({deps:e})=>{if(e.length)for(let t=0;t<e.length;t++)e[t].w|=Ze},dp=e=>{const{deps:t}=e;if(t.length){let n=0;for(let r=0;r<t.length;r++){const s=t[r];Vu(s)&&!Du(s)?s.delete(e):t[n++]=s,s.w&=~Ze,s.n&=~Ze}t.length=n}},So=new WeakMap;let Tr=0,Ze=1;const bo=30;let le;const vn=Symbol(""),Vo=Symbol("");class Ia{constructor(t,n=null,r){this.fn=t,this.scheduler=n,this.active=!0,this.deps=[],this.parent=void 0,up(this,r)}run(){if(!this.active)return this.fn();let t=le,n=Ke;for(;t;){if(t===this)return;t=t.parent}try{return this.parent=le,le=this,Ke=!0,Ze=1<<++Tr,Tr<=bo?fp(this):ql(this),this.fn()}finally{Tr<=bo&&dp(this),Ze=1<<--Tr,le=this.parent,Ke=n,this.parent=void 0,this.deferStop&&this.stop()}}stop(){le===this?this.deferStop=!0:this.active&&(ql(this),this.onStop&&this.onStop(),this.active=!1)}}function ql(e){const{deps:t}=e;if(t.length){for(let n=0;n<t.length;n++)t[n].delete(e);t.length=0}}let Ke=!0;const xu=[];function ar(){xu.push(Ke),Ke=!1}function lr(){const e=xu.pop();Ke=e===void 0?!0:e}function Jt(e,t,n){if(Ke&&le){let r=So.get(e);r||So.set(e,r=new Map);let s=r.get(n);s||r.set(n,s=wa()),ku(s)}}function ku(e,t){let n=!1;Tr<=bo?Du(e)||(e.n|=Ze,n=!Vu(e)):n=!e.has(le),n&&(e.add(le),le.deps.push(e))}function Me(e,t,n,r,s,i){const o=So.get(e);if(!o)return;let a=[];if(t==="clear")a=[...o.values()];else if(n==="length"&&j(e)){const l=Number(r);o.forEach((c,u)=>{(u==="length"||u>=l)&&a.push(c)})}else switch(n!==void 0&&a.push(o.get(n)),t){case"add":j(e)?Ta(n)&&a.push(o.get("length")):(a.push(o.get(vn)),Ln(e)&&a.push(o.get(Vo)));break;case"delete":j(e)||(a.push(o.get(vn)),Ln(e)&&a.push(o.get(Vo)));break;case"set":Ln(e)&&a.push(o.get(vn));break}if(a.length===1)a[0]&&Do(a[0]);else{const l=[];for(const c of a)c&&l.push(...c);Do(wa(l))}}function Do(e,t){const n=j(e)?e:[...e];for(const r of n)r.computed&&Hl(r);for(const r of n)r.computed||Hl(r)}function Hl(e,t){(e!==le||e.allowRecurse)&&(e.scheduler?e.scheduler():e.run())}const pp=ma("__proto__,__v_isRef,__isVue"),Nu=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(Ea)),gp=Aa(),mp=Aa(!1,!0),_p=Aa(!0),zl=yp();function yp(){const e={};return["includes","indexOf","lastIndexOf"].forEach(t=>{e[t]=function(...n){const r=tt(this);for(let i=0,o=this.length;i<o;i++)Jt(r,"get",i+"");const s=r[t](...n);return s===-1||s===!1?r[t](...n.map(tt)):s}}),["push","pop","shift","unshift","splice"].forEach(t=>{e[t]=function(...n){ar();const r=tt(this)[t].apply(this,n);return lr(),r}}),e}function Ep(e){const t=tt(this);return Jt(t,"has",e),t.hasOwnProperty(e)}function Aa(e=!1,t=!1){return function(r,s,i){if(s==="__v_isReactive")return!e;if(s==="__v_isReadonly")return e;if(s==="__v_isShallow")return t;if(s==="__v_raw"&&i===(e?t?Mp:Bu:t?Lu:Fu).get(r))return r;const o=j(r);if(!e){if(o&&J(zl,s))return Reflect.get(zl,s,i);if(s==="hasOwnProperty")return Ep}const a=Reflect.get(r,s,i);return(Ea(s)?Nu.has(s):pp(s))||(e||Jt(r,"get",s),t)?a:jt(a)?o&&Ta(s)?a:a.value:pt(a)?e?Uu(a):gn(a):a}}const vp=Mu(),Tp=Mu(!0);function Mu(e=!1){return function(n,r,s,i){let o=n[r];if(Gn(o)&&jt(o)&&!jt(s))return!1;if(!e&&(!Gs(s)&&!Gn(s)&&(o=tt(o),s=tt(s)),!j(n)&&jt(o)&&!jt(s)))return o.value=s,!0;const a=j(n)&&Ta(r)?Number(r)<n.length:J(n,r),l=Reflect.set(n,r,s,i);return n===tt(i)&&(a?Mr(s,o)&&Me(n,"set",r,s):Me(n,"add",r,s)),l}}function wp(e,t){const n=J(e,t);e[t];const r=Reflect.deleteProperty(e,t);return r&&n&&Me(e,"delete",t,void 0),r}function Ip(e,t){const n=Reflect.has(e,t);return(!Ea(t)||!Nu.has(t))&&Jt(e,"has",t),n}function Ap(e){return Jt(e,"iterate",j(e)?"length":vn),Reflect.ownKeys(e)}const Ou={get:gp,set:vp,deleteProperty:wp,has:Ip,ownKeys:Ap},Rp={get:_p,set(e,t){return!0},deleteProperty(e,t){return!0}},Pp=bt({},Ou,{get:mp,set:Tp}),Ra=e=>e,Ti=e=>Reflect.getPrototypeOf(e);function As(e,t,n=!1,r=!1){e=e.__v_raw;const s=tt(e),i=tt(t);n||(t!==i&&Jt(s,"get",t),Jt(s,"get",i));const{has:o}=Ti(s),a=r?Ra:n?Sa:Or;if(o.call(s,t))return a(e.get(t));if(o.call(s,i))return a(e.get(i));e!==s&&e.get(t)}function Rs(e,t=!1){const n=this.__v_raw,r=tt(n),s=tt(e);return t||(e!==s&&Jt(r,"has",e),Jt(r,"has",s)),e===s?n.has(e):n.has(e)||n.has(s)}function Ps(e,t=!1){return e=e.__v_raw,!t&&Jt(tt(e),"iterate",vn),Reflect.get(e,"size",e)}function Kl(e){e=tt(e);const t=tt(this);return Ti(t).has.call(t,e)||(t.add(e),Me(t,"add",e,e)),this}function Wl(e,t){t=tt(t);const n=tt(this),{has:r,get:s}=Ti(n);let i=r.call(n,e);i||(e=tt(e),i=r.call(n,e));const o=s.call(n,e);return n.set(e,t),i?Mr(t,o)&&Me(n,"set",e,t):Me(n,"add",e,t),this}function Ql(e){const t=tt(this),{has:n,get:r}=Ti(t);let s=n.call(t,e);s||(e=tt(e),s=n.call(t,e)),r&&r.call(t,e);const i=t.delete(e);return s&&Me(t,"delete",e,void 0),i}function Gl(){const e=tt(this),t=e.size!==0,n=e.clear();return t&&Me(e,"clear",void 0,void 0),n}function Cs(e,t){return function(r,s){const i=this,o=i.__v_raw,a=tt(o),l=t?Ra:e?Sa:Or;return!e&&Jt(a,"iterate",vn),o.forEach((c,u)=>r.call(s,l(c),l(u),i))}}function Ss(e,t,n){return function(...r){const s=this.__v_raw,i=tt(s),o=Ln(i),a=e==="entries"||e===Symbol.iterator&&o,l=e==="keys"&&o,c=s[e](...r),u=n?Ra:t?Sa:Or;return!t&&Jt(i,"iterate",l?Vo:vn),{next(){const{value:h,done:d}=c.next();return d?{value:h,done:d}:{value:a?[u(h[0]),u(h[1])]:u(h),done:d}},[Symbol.iterator](){return this}}}}function $e(e){return function(...t){return e==="delete"?!1:this}}function Cp(){const e={get(i){return As(this,i)},get size(){return Ps(this)},has:Rs,add:Kl,set:Wl,delete:Ql,clear:Gl,forEach:Cs(!1,!1)},t={get(i){return As(this,i,!1,!0)},get size(){return Ps(this)},has:Rs,add:Kl,set:Wl,delete:Ql,clear:Gl,forEach:Cs(!1,!0)},n={get(i){return As(this,i,!0)},get size(){return Ps(this,!0)},has(i){return Rs.call(this,i,!0)},add:$e("add"),set:$e("set"),delete:$e("delete"),clear:$e("clear"),forEach:Cs(!0,!1)},r={get(i){return As(this,i,!0,!0)},get size(){return Ps(this,!0)},has(i){return Rs.call(this,i,!0)},add:$e("add"),set:$e("set"),delete:$e("delete"),clear:$e("clear"),forEach:Cs(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(i=>{e[i]=Ss(i,!1,!1),n[i]=Ss(i,!0,!1),t[i]=Ss(i,!1,!0),r[i]=Ss(i,!0,!0)}),[e,n,t,r]}const[Sp,bp,Vp,Dp]=Cp();function Pa(e,t){const n=t?e?Dp:Vp:e?bp:Sp;return(r,s,i)=>s==="__v_isReactive"?!e:s==="__v_isReadonly"?e:s==="__v_raw"?r:Reflect.get(J(n,s)&&s in r?n:r,s,i)}const xp={get:Pa(!1,!1)},kp={get:Pa(!1,!0)},Np={get:Pa(!0,!1)},Fu=new WeakMap,Lu=new WeakMap,Bu=new WeakMap,Mp=new WeakMap;function Op(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Fp(e){return e.__v_skip||!Object.isExtensible(e)?0:Op(Jd(e))}function gn(e){return Gn(e)?e:Ca(e,!1,Ou,xp,Fu)}function Lp(e){return Ca(e,!1,Pp,kp,Lu)}function Uu(e){return Ca(e,!0,Rp,Np,Bu)}function Ca(e,t,n,r,s){if(!pt(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const i=s.get(e);if(i)return i;const o=Fp(e);if(o===0)return e;const a=new Proxy(e,o===2?r:n);return s.set(e,a),a}function Un(e){return Gn(e)?Un(e.__v_raw):!!(e&&e.__v_isReactive)}function Gn(e){return!!(e&&e.__v_isReadonly)}function Gs(e){return!!(e&&e.__v_isShallow)}function $u(e){return Un(e)||Gn(e)}function tt(e){const t=e&&e.__v_raw;return t?tt(t):e}function ju(e){return Qs(e,"__v_skip",!0),e}const Or=e=>pt(e)?gn(e):e,Sa=e=>pt(e)?Uu(e):e;function qu(e){Ke&&le&&(e=tt(e),ku(e.dep||(e.dep=wa())))}function Hu(e,t){e=tt(e);const n=e.dep;n&&Do(n)}function jt(e){return!!(e&&e.__v_isRef===!0)}function ke(e){return Bp(e,!1)}function Bp(e,t){return jt(e)?e:new Up(e,t)}class Up{constructor(t,n){this.__v_isShallow=n,this.dep=void 0,this.__v_isRef=!0,this._rawValue=n?t:tt(t),this._value=n?t:Or(t)}get value(){return qu(this),this._value}set value(t){const n=this.__v_isShallow||Gs(t)||Gn(t);t=n?t:tt(t),Mr(t,this._rawValue)&&(this._rawValue=t,this._value=n?t:Or(t),Hu(this))}}function wn(e){return jt(e)?e.value:e}const $p={get:(e,t,n)=>wn(Reflect.get(e,t,n)),set:(e,t,n,r)=>{const s=e[t];return jt(s)&&!jt(n)?(s.value=n,!0):Reflect.set(e,t,n,r)}};function zu(e){return Un(e)?e:new Proxy(e,$p)}class jp{constructor(t,n,r,s){this._setter=n,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this._dirty=!0,this.effect=new Ia(t,()=>{this._dirty||(this._dirty=!0,Hu(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!s,this.__v_isReadonly=r}get value(){const t=tt(this);return qu(t),(t._dirty||!t._cacheable)&&(t._dirty=!1,t._value=t.effect.run()),t._value}set value(t){this._setter(t)}}function qp(e,t,n=!1){let r,s;const i=z(e);return i?(r=e,s=ue):(r=e.get,s=e.set),new jp(r,s,i||!s,n)}function We(e,t,n,r){let s;try{s=r?e(...r):e()}catch(i){is(i,t,n)}return s}function he(e,t,n,r){if(z(e)){const i=We(e,t,n,r);return i&&va(i)&&i.catch(o=>{is(o,t,n)}),i}const s=[];for(let i=0;i<e.length;i++)s.push(he(e[i],t,n,r));return s}function is(e,t,n,r=!0){const s=t?t.vnode:null;if(t){let i=t.parent;const o=t.proxy,a=n;for(;i;){const c=i.ec;if(c){for(let u=0;u<c.length;u++)if(c[u](e,o,a)===!1)return}i=i.parent}const l=t.appContext.config.errorHandler;if(l){We(l,null,10,[e,o,a]);return}}Hp(e,n,s,r)}function Hp(e,t,n,r=!0){console.error(e)}let Fr=!1,xo=!1;const Ut=[];let Ee=0;const $n=[];let De=null,fn=0;const Ku=Promise.resolve();let ba=null;function Wu(e){const t=ba||Ku;return e?t.then(this?e.bind(this):e):t}function zp(e){let t=Ee+1,n=Ut.length;for(;t<n;){const r=t+n>>>1;Lr(Ut[r])<e?t=r+1:n=r}return t}function Va(e){(!Ut.length||!Ut.includes(e,Fr&&e.allowRecurse?Ee+1:Ee))&&(e.id==null?Ut.push(e):Ut.splice(zp(e.id),0,e),Qu())}function Qu(){!Fr&&!xo&&(xo=!0,ba=Ku.then(Yu))}function Kp(e){const t=Ut.indexOf(e);t>Ee&&Ut.splice(t,1)}function Gu(e){j(e)?$n.push(...e):(!De||!De.includes(e,e.allowRecurse?fn+1:fn))&&$n.push(e),Qu()}function Xl(e,t=Fr?Ee+1:0){for(;t<Ut.length;t++){const n=Ut[t];n&&n.pre&&(Ut.splice(t,1),t--,n())}}function Xu(e){if($n.length){const t=[...new Set($n)];if($n.length=0,De){De.push(...t);return}for(De=t,De.sort((n,r)=>Lr(n)-Lr(r)),fn=0;fn<De.length;fn++)De[fn]();De=null,fn=0}}const Lr=e=>e.id==null?1/0:e.id,Wp=(e,t)=>{const n=Lr(e)-Lr(t);if(n===0){if(e.pre&&!t.pre)return-1;if(t.pre&&!e.pre)return 1}return n};function Yu(e){xo=!1,Fr=!0,Ut.sort(Wp);const t=ue;try{for(Ee=0;Ee<Ut.length;Ee++){const n=Ut[Ee];n&&n.active!==!1&&We(n,null,14)}}finally{Ee=0,Ut.length=0,Xu(),Fr=!1,ba=null,(Ut.length||$n.length)&&Yu()}}function Qp(e,t,...n){if(e.isUnmounted)return;const r=e.vnode.props||ut;let s=n;const i=t.startsWith("update:"),o=i&&t.slice(7);if(o&&o in r){const u=`${o==="modelValue"?"model":o}Modifiers`,{number:h,trim:d}=r[u]||ut;d&&(s=n.map(g=>wt(g)?g.trim():g)),h&&(s=n.map(ep))}let a,l=r[a=ro(t)]||r[a=ro(Qn(t))];!l&&i&&(l=r[a=ro(or(t))]),l&&he(l,e,6,s);const c=r[a+"Once"];if(c){if(!e.emitted)e.emitted={};else if(e.emitted[a])return;e.emitted[a]=!0,he(c,e,6,s)}}function Ju(e,t,n=!1){const r=t.emitsCache,s=r.get(e);if(s!==void 0)return s;const i=e.emits;let o={},a=!1;if(!z(e)){const l=c=>{const u=Ju(c,t,!0);u&&(a=!0,bt(o,u))};!n&&t.mixins.length&&t.mixins.forEach(l),e.extends&&l(e.extends),e.mixins&&e.mixins.forEach(l)}return!i&&!a?(pt(e)&&r.set(e,null),null):(j(i)?i.forEach(l=>o[l]=null):bt(o,i),pt(e)&&r.set(e,o),o)}function wi(e,t){return!e||!_i(t)?!1:(t=t.slice(2).replace(/Once$/,""),J(e,t[0].toLowerCase()+t.slice(1))||J(e,or(t))||J(e,t))}let qt=null,Ii=null;function Xs(e){const t=qt;return qt=e,Ii=e&&e.type.__scopeId||null,t}function Da(e){Ii=e}function xa(){Ii=null}function Br(e,t=qt,n){if(!t||e._n)return e;const r=(...s)=>{r._d&&cc(-1);const i=Xs(t);let o;try{o=e(...s)}finally{Xs(i),r._d&&cc(1)}return o};return r._n=!0,r._c=!0,r._d=!0,r}function io(e){const{type:t,vnode:n,proxy:r,withProxy:s,props:i,propsOptions:[o],slots:a,attrs:l,emit:c,render:u,renderCache:h,data:d,setupState:g,ctx:P,inheritAttrs:I}=e;let b,F;const U=Xs(e);try{if(n.shapeFlag&4){const w=s||r;b=ae(u.call(w,w,h,i,g,d,P)),F=l}else{const w=t;b=ae(w.length>1?w(i,{attrs:l,slots:a,emit:c}):w(i,null)),F=t.props?l:Xp(l)}}catch(w){br.length=0,is(w,e,1),b=Tt(Ae)}let W=b;if(F&&I!==!1){const w=Object.keys(F),{shapeFlag:L}=W;w.length&&L&7&&(o&&w.some(_a)&&(F=Yp(F,o)),W=Yn(W,F))}return n.dirs&&(W=Yn(W),W.dirs=W.dirs?W.dirs.concat(n.dirs):n.dirs),n.transition&&(W.transition=n.transition),b=W,Xs(U),b}function Gp(e){let t;for(let n=0;n<e.length;n++){const r=e[n];if(Fa(r)){if(r.type!==Ae||r.children==="v-if"){if(t)return;t=r}}else return}return t}const Xp=e=>{let t;for(const n in e)(n==="class"||n==="style"||_i(n))&&((t||(t={}))[n]=e[n]);return t},Yp=(e,t)=>{const n={};for(const r in e)(!_a(r)||!(r.slice(9)in t))&&(n[r]=e[r]);return n};function Jp(e,t,n){const{props:r,children:s,component:i}=e,{props:o,children:a,patchFlag:l}=t,c=i.emitsOptions;if(t.dirs||t.transition)return!0;if(n&&l>=0){if(l&1024)return!0;if(l&16)return r?Yl(r,o,c):!!o;if(l&8){const u=t.dynamicProps;for(let h=0;h<u.length;h++){const d=u[h];if(o[d]!==r[d]&&!wi(c,d))return!0}}}else return(s||a)&&(!a||!a.$stable)?!0:r===o?!1:r?o?Yl(r,o,c):!0:!!o;return!1}function Yl(e,t,n){const r=Object.keys(t);if(r.length!==Object.keys(e).length)return!0;for(let s=0;s<r.length;s++){const i=r[s];if(t[i]!==e[i]&&!wi(n,i))return!0}return!1}function ka({vnode:e,parent:t},n){for(;t&&t.subTree===e;)(e=t.vnode).el=n,t=t.parent}const Zp=e=>e.__isSuspense,tg={name:"Suspense",__isSuspense:!0,process(e,t,n,r,s,i,o,a,l,c){e==null?ng(t,n,r,s,i,o,a,l,c):rg(e,t,n,r,s,o,a,l,c)},hydrate:sg,create:Na,normalize:ig},eg=tg;function Ur(e,t){const n=e.props&&e.props[t];z(n)&&n()}function ng(e,t,n,r,s,i,o,a,l){const{p:c,o:{createElement:u}}=l,h=u("div"),d=e.suspense=Na(e,s,r,t,h,n,i,o,a,l);c(null,d.pendingBranch=e.ssContent,h,null,r,d,i,o),d.deps>0?(Ur(e,"onPending"),Ur(e,"onFallback"),c(null,e.ssFallback,t,n,r,null,i,o),jn(d,e.ssFallback)):d.resolve(!1,!0)}function rg(e,t,n,r,s,i,o,a,{p:l,um:c,o:{createElement:u}}){const h=t.suspense=e.suspense;h.vnode=t,t.el=e.el;const d=t.ssContent,g=t.ssFallback,{activeBranch:P,pendingBranch:I,isInFallback:b,isHydrating:F}=h;if(I)h.pendingBranch=d,He(d,I)?(l(I,d,h.hiddenContainer,null,s,h,i,o,a),h.deps<=0?h.resolve():b&&(l(P,g,n,r,s,null,i,o,a),jn(h,g))):(h.pendingId++,F?(h.isHydrating=!1,h.activeBranch=I):c(I,s,h),h.deps=0,h.effects.length=0,h.hiddenContainer=u("div"),b?(l(null,d,h.hiddenContainer,null,s,h,i,o,a),h.deps<=0?h.resolve():(l(P,g,n,r,s,null,i,o,a),jn(h,g))):P&&He(d,P)?(l(P,d,n,r,s,h,i,o,a),h.resolve(!0)):(l(null,d,h.hiddenContainer,null,s,h,i,o,a),h.deps<=0&&h.resolve()));else if(P&&He(d,P))l(P,d,n,r,s,h,i,o,a),jn(h,d);else if(Ur(t,"onPending"),h.pendingBranch=d,h.pendingId++,l(null,d,h.hiddenContainer,null,s,h,i,o,a),h.deps<=0)h.resolve();else{const{timeout:U,pendingId:W}=h;U>0?setTimeout(()=>{h.pendingId===W&&h.fallback(g)},U):U===0&&h.fallback(g)}}function Na(e,t,n,r,s,i,o,a,l,c,u=!1){const{p:h,m:d,um:g,n:P,o:{parentNode:I,remove:b}}=c;let F;const U=ag(e);U&&t!=null&&t.pendingBranch&&(F=t.pendingId,t.deps++);const W=e.props?np(e.props.timeout):void 0,w={vnode:e,parent:t,parentComponent:n,isSVG:o,container:r,hiddenContainer:s,anchor:i,deps:0,pendingId:0,timeout:typeof W=="number"?W:-1,activeBranch:null,pendingBranch:null,isInFallback:!0,isHydrating:u,isUnmounted:!1,effects:[],resolve(L=!1,X=!1){const{vnode:It,activeBranch:ct,pendingBranch:xt,pendingId:Pt,effects:Zt,parentComponent:Se,container:ge}=w;if(w.isHydrating)w.isHydrating=!1;else if(!L){const Ct=ct&&xt.transition&&xt.transition.mode==="out-in";Ct&&(ct.transition.afterLeave=()=>{Pt===w.pendingId&&d(xt,ge,ot,0)});let{anchor:ot}=w;ct&&(ot=P(ct),g(ct,Se,w,!0)),Ct||d(xt,ge,ot,0)}jn(w,xt),w.pendingBranch=null,w.isInFallback=!1;let be=w.parent,mr=!1;for(;be;){if(be.pendingBranch){be.effects.push(...Zt),mr=!0;break}be=be.parent}mr||Gu(Zt),w.effects=[],U&&t&&t.pendingBranch&&F===t.pendingId&&(t.deps--,t.deps===0&&!X&&t.resolve()),Ur(It,"onResolve")},fallback(L){if(!w.pendingBranch)return;const{vnode:X,activeBranch:It,parentComponent:ct,container:xt,isSVG:Pt}=w;Ur(X,"onFallback");const Zt=P(It),Se=()=>{w.isInFallback&&(h(null,L,xt,Zt,ct,null,Pt,a,l),jn(w,L))},ge=L.transition&&L.transition.mode==="out-in";ge&&(It.transition.afterLeave=Se),w.isInFallback=!0,g(It,ct,null,!0),ge||Se()},move(L,X,It){w.activeBranch&&d(w.activeBranch,L,X,It),w.container=L},next(){return w.activeBranch&&P(w.activeBranch)},registerDep(L,X){const It=!!w.pendingBranch;It&&w.deps++;const ct=L.vnode.el;L.asyncDep.catch(xt=>{is(xt,L,0)}).then(xt=>{if(L.isUnmounted||w.isUnmounted||w.pendingId!==L.suspenseId)return;L.asyncResolved=!0;const{vnode:Pt}=L;Lo(L,xt,!1),ct&&(Pt.el=ct);const Zt=!ct&&L.subTree.el;X(L,Pt,I(ct||L.subTree.el),ct?null:P(L.subTree),w,o,l),Zt&&b(Zt),ka(L,Pt.el),It&&--w.deps===0&&w.resolve()})},unmount(L,X){w.isUnmounted=!0,w.activeBranch&&g(w.activeBranch,n,L,X),w.pendingBranch&&g(w.pendingBranch,n,L,X)}};return w}function sg(e,t,n,r,s,i,o,a,l){const c=t.suspense=Na(t,r,n,e.parentNode,document.createElement("div"),null,s,i,o,a,!0),u=l(e,c.pendingBranch=t.ssContent,n,c,i,o);return c.deps===0&&c.resolve(!1,!0),u}function ig(e){const{shapeFlag:t,children:n}=e,r=t&32;e.ssContent=Jl(r?n.default:n),e.ssFallback=r?Jl(n.fallback):Tt(Ae)}function Jl(e){let t;if(z(e)){const n=Xn&&e._c;n&&(e._d=!1,nt()),e=e(),n&&(e._d=!0,t=se,ph())}return j(e)&&(e=Gp(e)),e=ae(e),t&&!e.dynamicChildren&&(e.dynamicChildren=t.filter(n=>n!==e)),e}function og(e,t){t&&t.pendingBranch?j(e)?t.effects.push(...e):t.effects.push(e):Gu(e)}function jn(e,t){e.activeBranch=t;const{vnode:n,parentComponent:r}=e,s=n.el=t.el;r&&r.subTree===n&&(r.vnode.el=s,ka(r,s))}function ag(e){var t;return((t=e.props)==null?void 0:t.suspensible)!=null&&e.props.suspensible!==!1}const bs={};function $s(e,t,n){return Zu(e,t,n)}function Zu(e,t,{immediate:n,deep:r,flush:s,onTrack:i,onTrigger:o}=ut){var a;const l=hp()===((a=Mt)==null?void 0:a.scope)?Mt:null;let c,u=!1,h=!1;if(jt(e)?(c=()=>e.value,u=Gs(e)):Un(e)?(c=()=>e,r=!0):j(e)?(h=!0,u=e.some(w=>Un(w)||Gs(w)),c=()=>e.map(w=>{if(jt(w))return w.value;if(Un(w))return mn(w);if(z(w))return We(w,l,2)})):z(e)?t?c=()=>We(e,l,2):c=()=>{if(!(l&&l.isUnmounted))return d&&d(),he(e,l,3,[g])}:c=ue,t&&r){const w=c;c=()=>mn(w())}let d,g=w=>{d=U.onStop=()=>{We(w,l,4)}},P;if($r)if(g=ue,t?n&&he(t,l,3,[c(),h?[]:void 0,g]):c(),s==="sync"){const w=tm();P=w.__watcherHandles||(w.__watcherHandles=[])}else return ue;let I=h?new Array(e.length).fill(bs):bs;const b=()=>{if(U.active)if(t){const w=U.run();(r||u||(h?w.some((L,X)=>Mr(L,I[X])):Mr(w,I)))&&(d&&d(),he(t,l,3,[w,I===bs?void 0:h&&I[0]===bs?[]:I,g]),I=w)}else U.run()};b.allowRecurse=!!t;let F;s==="sync"?F=b:s==="post"?F=()=>Xt(b,l&&l.suspense):(b.pre=!0,l&&(b.id=l.uid),F=()=>Va(b));const U=new Ia(c,F);t?n?b():I=U.run():s==="post"?Xt(U.run.bind(U),l&&l.suspense):U.run();const W=()=>{U.stop(),l&&l.scope&&ya(l.scope.effects,U)};return P&&P.push(W),W}function lg(e,t,n){const r=this.proxy,s=wt(e)?e.includes(".")?th(r,e):()=>r[e]:e.bind(r,r);let i;z(t)?i=t:(i=t.handler,n=t);const o=Mt;tn(this);const a=Zu(s,i.bind(r),n);return o?tn(o):Qe(),a}function th(e,t){const n=t.split(".");return()=>{let r=e;for(let s=0;s<n.length&&r;s++)r=r[n[s]];return r}}function mn(e,t){if(!pt(e)||e.__v_skip||(t=t||new Set,t.has(e)))return e;if(t.add(e),jt(e))mn(e.value,t);else if(j(e))for(let n=0;n<e.length;n++)mn(e[n],t);else if(Au(e)||Ln(e))e.forEach(n=>{mn(n,t)});else if(Pu(e))for(const n in e)mn(e[n],t);return e}function Zl(e,t){const n=qt;if(n===null)return e;const r=Ci(n)||n.proxy,s=e.dirs||(e.dirs=[]);for(let i=0;i<t.length;i++){let[o,a,l,c=ut]=t[i];o&&(z(o)&&(o={mounted:o,updated:o}),o.deep&&mn(a),s.push({dir:o,instance:r,value:a,oldValue:void 0,arg:l,modifiers:c}))}return e}function cn(e,t,n,r){const s=e.dirs,i=t&&t.dirs;for(let o=0;o<s.length;o++){const a=s[o];i&&(a.oldValue=i[o].value);let l=a.dir[r];l&&(ar(),he(l,n,8,[e.el,a,e,t]),lr())}}function Ce(e,t){return z(e)?(()=>bt({name:e.name},t,{setup:e}))():e}const Cr=e=>!!e.type.__asyncLoader,eh=e=>e.type.__isKeepAlive;function cg(e,t){nh(e,"a",t)}function ug(e,t){nh(e,"da",t)}function nh(e,t,n=Mt){const r=e.__wdc||(e.__wdc=()=>{let s=n;for(;s;){if(s.isDeactivated)return;s=s.parent}return e()});if(Ai(t,r,n),n){let s=n.parent;for(;s&&s.parent;)eh(s.parent.vnode)&&hg(r,t,n,s),s=s.parent}}function hg(e,t,n,r){const s=Ai(t,e,r,!0);rh(()=>{ya(r[t],s)},n)}function Ai(e,t,n=Mt,r=!1){if(n){const s=n[e]||(n[e]=[]),i=t.__weh||(t.__weh=(...o)=>{if(n.isUnmounted)return;ar(),tn(n);const a=he(t,n,e,o);return Qe(),lr(),a});return r?s.unshift(i):s.push(i),i}}const Ue=e=>(t,n=Mt)=>(!$r||e==="sp")&&Ai(e,(...r)=>t(...r),n),fg=Ue("bm"),dg=Ue("m"),pg=Ue("bu"),gg=Ue("u"),mg=Ue("bum"),rh=Ue("um"),_g=Ue("sp"),yg=Ue("rtg"),Eg=Ue("rtc");function vg(e,t=Mt){Ai("ec",e,t)}const Tg=Symbol.for("v-ndc");function sh(e,t,n,r){let s;const i=n&&n[r];if(j(e)||wt(e)){s=new Array(e.length);for(let o=0,a=e.length;o<a;o++)s[o]=t(e[o],o,void 0,i&&i[o])}else if(typeof e=="number"){s=new Array(e);for(let o=0;o<e;o++)s[o]=t(o+1,o,void 0,i&&i[o])}else if(pt(e))if(e[Symbol.iterator])s=Array.from(e,(o,a)=>t(o,a,void 0,i&&i[a]));else{const o=Object.keys(e);s=new Array(o.length);for(let a=0,l=o.length;a<l;a++){const c=o[a];s[a]=t(e[c],c,a,i&&i[a])}}else s=[];return n&&(n[r]=s),s}function wg(e,t,n={},r,s){if(qt.isCE||qt.parent&&Cr(qt.parent)&&qt.parent.isCE)return t!=="default"&&(n.name=t),Tt("slot",n,r&&r());let i=e[t];i&&i._c&&(i._d=!1),nt();const o=i&&ih(i(n)),a=qe(Yt,{key:n.key||o&&o.key||`_${t}`},o||(r?r():[]),o&&e._===1?64:-2);return!s&&a.scopeId&&(a.slotScopeIds=[a.scopeId+"-s"]),i&&i._c&&(i._d=!0),a}function ih(e){return e.some(t=>Fa(t)?!(t.type===Ae||t.type===Yt&&!ih(t.children)):!0)?e:null}const ko=e=>e?yh(e)?Ci(e)||e.proxy:ko(e.parent):null,Sr=bt(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>ko(e.parent),$root:e=>ko(e.root),$emit:e=>e.emit,$options:e=>Ma(e),$forceUpdate:e=>e.f||(e.f=()=>Va(e.update)),$nextTick:e=>e.n||(e.n=Wu.bind(e.proxy)),$watch:e=>lg.bind(e)}),oo=(e,t)=>e!==ut&&!e.__isScriptSetup&&J(e,t),Ig={get({_:e},t){const{ctx:n,setupState:r,data:s,props:i,accessCache:o,type:a,appContext:l}=e;let c;if(t[0]!=="$"){const g=o[t];if(g!==void 0)switch(g){case 1:return r[t];case 2:return s[t];case 4:return n[t];case 3:return i[t]}else{if(oo(r,t))return o[t]=1,r[t];if(s!==ut&&J(s,t))return o[t]=2,s[t];if((c=e.propsOptions[0])&&J(c,t))return o[t]=3,i[t];if(n!==ut&&J(n,t))return o[t]=4,n[t];No&&(o[t]=0)}}const u=Sr[t];let h,d;if(u)return t==="$attrs"&&Jt(e,"get",t),u(e);if((h=a.__cssModules)&&(h=h[t]))return h;if(n!==ut&&J(n,t))return o[t]=4,n[t];if(d=l.config.globalProperties,J(d,t))return d[t]},set({_:e},t,n){const{data:r,setupState:s,ctx:i}=e;return oo(s,t)?(s[t]=n,!0):r!==ut&&J(r,t)?(r[t]=n,!0):J(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(i[t]=n,!0)},has({_:{data:e,setupState:t,accessCache:n,ctx:r,appContext:s,propsOptions:i}},o){let a;return!!n[o]||e!==ut&&J(e,o)||oo(t,o)||(a=i[0])&&J(a,o)||J(r,o)||J(Sr,o)||J(s.config.globalProperties,o)},defineProperty(e,t,n){return n.get!=null?e._.accessCache[t]=0:J(n,"value")&&this.set(e,t,n.value,null),Reflect.defineProperty(e,t,n)}};function tc(e){return j(e)?e.reduce((t,n)=>(t[n]=null,t),{}):e}function ec(e){const t=Wg();let n=e();return Qe(),va(n)&&(n=n.catch(r=>{throw tn(t),r})),[n,()=>tn(t)]}let No=!0;function Ag(e){const t=Ma(e),n=e.proxy,r=e.ctx;No=!1,t.beforeCreate&&nc(t.beforeCreate,e,"bc");const{data:s,computed:i,methods:o,watch:a,provide:l,inject:c,created:u,beforeMount:h,mounted:d,beforeUpdate:g,updated:P,activated:I,deactivated:b,beforeDestroy:F,beforeUnmount:U,destroyed:W,unmounted:w,render:L,renderTracked:X,renderTriggered:It,errorCaptured:ct,serverPrefetch:xt,expose:Pt,inheritAttrs:Zt,components:Se,directives:ge,filters:be}=t;if(c&&Rg(c,r,null),o)for(const ot in o){const at=o[ot];z(at)&&(r[ot]=at.bind(n))}if(s){const ot=s.call(n,n);pt(ot)&&(e.data=gn(ot))}if(No=!0,i)for(const ot in i){const at=i[ot],an=z(at)?at.bind(n,n):z(at.get)?at.get.bind(n,n):ue,ws=!z(at)&&z(at.set)?at.set.bind(n):ue,ln=Ua({get:an,set:ws});Object.defineProperty(r,ot,{enumerable:!0,configurable:!0,get:()=>ln.value,set:me=>ln.value=me})}if(a)for(const ot in a)oh(a[ot],r,n,ot);if(l){const ot=z(l)?l.call(n):l;Reflect.ownKeys(ot).forEach(at=>{Dg(at,ot[at])})}u&&nc(u,e,"c");function Ct(ot,at){j(at)?at.forEach(an=>ot(an.bind(n))):at&&ot(at.bind(n))}if(Ct(fg,h),Ct(dg,d),Ct(pg,g),Ct(gg,P),Ct(cg,I),Ct(ug,b),Ct(vg,ct),Ct(Eg,X),Ct(yg,It),Ct(mg,U),Ct(rh,w),Ct(_g,xt),j(Pt))if(Pt.length){const ot=e.exposed||(e.exposed={});Pt.forEach(at=>{Object.defineProperty(ot,at,{get:()=>n[at],set:an=>n[at]=an})})}else e.exposed||(e.exposed={});L&&e.render===ue&&(e.render=L),Zt!=null&&(e.inheritAttrs=Zt),Se&&(e.components=Se),ge&&(e.directives=ge)}function Rg(e,t,n=ue){j(e)&&(e=Mo(e));for(const r in e){const s=e[r];let i;pt(s)?"default"in s?i=js(s.from||r,s.default,!0):i=js(s.from||r):i=js(s),jt(i)?Object.defineProperty(t,r,{enumerable:!0,configurable:!0,get:()=>i.value,set:o=>i.value=o}):t[r]=i}}function nc(e,t,n){he(j(e)?e.map(r=>r.bind(t.proxy)):e.bind(t.proxy),t,n)}function oh(e,t,n,r){const s=r.includes(".")?th(n,r):()=>n[r];if(wt(e)){const i=t[e];z(i)&&$s(s,i)}else if(z(e))$s(s,e.bind(n));else if(pt(e))if(j(e))e.forEach(i=>oh(i,t,n,r));else{const i=z(e.handler)?e.handler.bind(n):t[e.handler];z(i)&&$s(s,i,e)}}function Ma(e){const t=e.type,{mixins:n,extends:r}=t,{mixins:s,optionsCache:i,config:{optionMergeStrategies:o}}=e.appContext,a=i.get(t);let l;return a?l=a:!s.length&&!n&&!r?l=t:(l={},s.length&&s.forEach(c=>Ys(l,c,o,!0)),Ys(l,t,o)),pt(t)&&i.set(t,l),l}function Ys(e,t,n,r=!1){const{mixins:s,extends:i}=t;i&&Ys(e,i,n,!0),s&&s.forEach(o=>Ys(e,o,n,!0));for(const o in t)if(!(r&&o==="expose")){const a=Pg[o]||n&&n[o];e[o]=a?a(e[o],t[o]):t[o]}return e}const Pg={data:rc,props:sc,emits:sc,methods:wr,computed:wr,beforeCreate:Qt,created:Qt,beforeMount:Qt,mounted:Qt,beforeUpdate:Qt,updated:Qt,beforeDestroy:Qt,beforeUnmount:Qt,destroyed:Qt,unmounted:Qt,activated:Qt,deactivated:Qt,errorCaptured:Qt,serverPrefetch:Qt,components:wr,directives:wr,watch:Sg,provide:rc,inject:Cg};function rc(e,t){return t?e?function(){return bt(z(e)?e.call(this,this):e,z(t)?t.call(this,this):t)}:t:e}function Cg(e,t){return wr(Mo(e),Mo(t))}function Mo(e){if(j(e)){const t={};for(let n=0;n<e.length;n++)t[e[n]]=e[n];return t}return e}function Qt(e,t){return e?[...new Set([].concat(e,t))]:t}function wr(e,t){return e?bt(Object.create(null),e,t):t}function sc(e,t){return e?j(e)&&j(t)?[...new Set([...e,...t])]:bt(Object.create(null),tc(e),tc(t??{})):t}function Sg(e,t){if(!e)return t;if(!t)return e;const n=bt(Object.create(null),e);for(const r in t)n[r]=Qt(e[r],t[r]);return n}function ah(){return{app:null,config:{isNativeTag:Gd,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let bg=0;function Vg(e,t){return function(r,s=null){z(r)||(r=bt({},r)),s!=null&&!pt(s)&&(s=null);const i=ah(),o=new Set;let a=!1;const l=i.app={_uid:bg++,_component:r,_props:s,_container:null,_context:i,_instance:null,version:em,get config(){return i.config},set config(c){},use(c,...u){return o.has(c)||(c&&z(c.install)?(o.add(c),c.install(l,...u)):z(c)&&(o.add(c),c(l,...u))),l},mixin(c){return i.mixins.includes(c)||i.mixins.push(c),l},component(c,u){return u?(i.components[c]=u,l):i.components[c]},directive(c,u){return u?(i.directives[c]=u,l):i.directives[c]},mount(c,u,h){if(!a){const d=Tt(r,s);return d.appContext=i,u&&t?t(d,c):e(d,c,h),a=!0,l._container=c,c.__vue_app__=l,Ci(d.component)||d.component.proxy}},unmount(){a&&(e(null,l._container),delete l._container.__vue_app__)},provide(c,u){return i.provides[c]=u,l},runWithContext(c){Js=l;try{return c()}finally{Js=null}}};return l}}let Js=null;function Dg(e,t){if(Mt){let n=Mt.provides;const r=Mt.parent&&Mt.parent.provides;r===n&&(n=Mt.provides=Object.create(r)),n[e]=t}}function js(e,t,n=!1){const r=Mt||qt;if(r||Js){const s=r?r.parent==null?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:Js._context.provides;if(s&&e in s)return s[e];if(arguments.length>1)return n&&z(t)?t.call(r&&r.proxy):t}}function xg(e,t,n,r=!1){const s={},i={};Qs(i,Pi,1),e.propsDefaults=Object.create(null),lh(e,t,s,i);for(const o in e.propsOptions[0])o in s||(s[o]=void 0);n?e.props=r?s:Lp(s):e.type.props?e.props=s:e.props=i,e.attrs=i}function kg(e,t,n,r){const{props:s,attrs:i,vnode:{patchFlag:o}}=e,a=tt(s),[l]=e.propsOptions;let c=!1;if((r||o>0)&&!(o&16)){if(o&8){const u=e.vnode.dynamicProps;for(let h=0;h<u.length;h++){let d=u[h];if(wi(e.emitsOptions,d))continue;const g=t[d];if(l)if(J(i,d))g!==i[d]&&(i[d]=g,c=!0);else{const P=Qn(d);s[P]=Oo(l,a,P,g,e,!1)}else g!==i[d]&&(i[d]=g,c=!0)}}}else{lh(e,t,s,i)&&(c=!0);let u;for(const h in a)(!t||!J(t,h)&&((u=or(h))===h||!J(t,u)))&&(l?n&&(n[h]!==void 0||n[u]!==void 0)&&(s[h]=Oo(l,a,h,void 0,e,!0)):delete s[h]);if(i!==a)for(const h in i)(!t||!J(t,h))&&(delete i[h],c=!0)}c&&Me(e,"set","$attrs")}function lh(e,t,n,r){const[s,i]=e.propsOptions;let o=!1,a;if(t)for(let l in t){if(Us(l))continue;const c=t[l];let u;s&&J(s,u=Qn(l))?!i||!i.includes(u)?n[u]=c:(a||(a={}))[u]=c:wi(e.emitsOptions,l)||(!(l in r)||c!==r[l])&&(r[l]=c,o=!0)}if(i){const l=tt(n),c=a||ut;for(let u=0;u<i.length;u++){const h=i[u];n[h]=Oo(s,l,h,c[h],e,!J(c,h))}}return o}function Oo(e,t,n,r,s,i){const o=e[n];if(o!=null){const a=J(o,"default");if(a&&r===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&z(l)){const{propsDefaults:c}=s;n in c?r=c[n]:(tn(s),r=c[n]=l.call(null,t),Qe())}else r=l}o[0]&&(i&&!a?r=!1:o[1]&&(r===""||r===or(n))&&(r=!0))}return r}function ch(e,t,n=!1){const r=t.propsCache,s=r.get(e);if(s)return s;const i=e.props,o={},a=[];let l=!1;if(!z(e)){const u=h=>{l=!0;const[d,g]=ch(h,t,!0);bt(o,d),g&&a.push(...g)};!n&&t.mixins.length&&t.mixins.forEach(u),e.extends&&u(e.extends),e.mixins&&e.mixins.forEach(u)}if(!i&&!l)return pt(e)&&r.set(e,Fn),Fn;if(j(i))for(let u=0;u<i.length;u++){const h=Qn(i[u]);ic(h)&&(o[h]=ut)}else if(i)for(const u in i){const h=Qn(u);if(ic(h)){const d=i[u],g=o[h]=j(d)||z(d)?{type:d}:bt({},d);if(g){const P=lc(Boolean,g.type),I=lc(String,g.type);g[0]=P>-1,g[1]=I<0||P<I,(P>-1||J(g,"default"))&&a.push(h)}}}const c=[o,a];return pt(e)&&r.set(e,c),c}function ic(e){return e[0]!=="$"}function oc(e){const t=e&&e.toString().match(/^\s*(function|class) (\w+)/);return t?t[2]:e===null?"null":""}function ac(e,t){return oc(e)===oc(t)}function lc(e,t){return j(t)?t.findIndex(n=>ac(n,e)):z(t)&&ac(t,e)?0:-1}const uh=e=>e[0]==="_"||e==="$stable",Oa=e=>j(e)?e.map(ae):[ae(e)],Ng=(e,t,n)=>{if(t._n)return t;const r=Br((...s)=>Oa(t(...s)),n);return r._c=!1,r},hh=(e,t,n)=>{const r=e._ctx;for(const s in e){if(uh(s))continue;const i=e[s];if(z(i))t[s]=Ng(s,i,r);else if(i!=null){const o=Oa(i);t[s]=()=>o}}},fh=(e,t)=>{const n=Oa(t);e.slots.default=()=>n},Mg=(e,t)=>{if(e.vnode.shapeFlag&32){const n=t._;n?(e.slots=tt(t),Qs(t,"_",n)):hh(t,e.slots={})}else e.slots={},t&&fh(e,t);Qs(e.slots,Pi,1)},Og=(e,t,n)=>{const{vnode:r,slots:s}=e;let i=!0,o=ut;if(r.shapeFlag&32){const a=t._;a?n&&a===1?i=!1:(bt(s,t),!n&&a===1&&delete s._):(i=!t.$stable,hh(t,s)),o=t}else t&&(fh(e,t),o={default:1});if(i)for(const a in s)!uh(a)&&!(a in o)&&delete s[a]};function Fo(e,t,n,r,s=!1){if(j(e)){e.forEach((d,g)=>Fo(d,t&&(j(t)?t[g]:t),n,r,s));return}if(Cr(r)&&!s)return;const i=r.shapeFlag&4?Ci(r.component)||r.component.proxy:r.el,o=s?null:i,{i:a,r:l}=e,c=t&&t.r,u=a.refs===ut?a.refs={}:a.refs,h=a.setupState;if(c!=null&&c!==l&&(wt(c)?(u[c]=null,J(h,c)&&(h[c]=null)):jt(c)&&(c.value=null)),z(l))We(l,a,12,[o,u]);else{const d=wt(l),g=jt(l);if(d||g){const P=()=>{if(e.f){const I=d?J(h,l)?h[l]:u[l]:l.value;s?j(I)&&ya(I,i):j(I)?I.includes(i)||I.push(i):d?(u[l]=[i],J(h,l)&&(h[l]=u[l])):(l.value=[i],e.k&&(u[e.k]=l.value))}else d?(u[l]=o,J(h,l)&&(h[l]=o)):g&&(l.value=o,e.k&&(u[e.k]=o))};o?(P.id=-1,Xt(P,n)):P()}}}const Xt=og;function Fg(e){return Lg(e)}function Lg(e,t){const n=Co();n.__VUE__=!0;const{insert:r,remove:s,patchProp:i,createElement:o,createText:a,createComment:l,setText:c,setElementText:u,parentNode:h,nextSibling:d,setScopeId:g=ue,insertStaticContent:P}=e,I=(f,p,m,y=null,_=null,R=null,V=!1,A=null,C=!!p.dynamicChildren)=>{if(f===p)return;f&&!He(f,p)&&(y=Is(f),me(f,_,R,!0),f=null),p.patchFlag===-2&&(C=!1,p.dynamicChildren=null);const{type:v,ref:k,shapeFlag:D}=p;switch(v){case Ri:b(f,p,m,y);break;case Ae:F(f,p,m,y);break;case ao:f==null&&U(p,m,y,V);break;case Yt:Se(f,p,m,y,_,R,V,A,C);break;default:D&1?L(f,p,m,y,_,R,V,A,C):D&6?ge(f,p,m,y,_,R,V,A,C):(D&64||D&128)&&v.process(f,p,m,y,_,R,V,A,C,Vn)}k!=null&&_&&Fo(k,f&&f.ref,R,p||f,!p)},b=(f,p,m,y)=>{if(f==null)r(p.el=a(p.children),m,y);else{const _=p.el=f.el;p.children!==f.children&&c(_,p.children)}},F=(f,p,m,y)=>{f==null?r(p.el=l(p.children||""),m,y):p.el=f.el},U=(f,p,m,y)=>{[f.el,f.anchor]=P(f.children,p,m,y,f.el,f.anchor)},W=({el:f,anchor:p},m,y)=>{let _;for(;f&&f!==p;)_=d(f),r(f,m,y),f=_;r(p,m,y)},w=({el:f,anchor:p})=>{let m;for(;f&&f!==p;)m=d(f),s(f),f=m;s(p)},L=(f,p,m,y,_,R,V,A,C)=>{V=V||p.type==="svg",f==null?X(p,m,y,_,R,V,A,C):xt(f,p,_,R,V,A,C)},X=(f,p,m,y,_,R,V,A)=>{let C,v;const{type:k,props:D,shapeFlag:N,transition:q,dirs:Q}=f;if(C=f.el=o(f.type,R,D&&D.is,D),N&8?u(C,f.children):N&16&&ct(f.children,C,null,y,_,R&&k!=="foreignObject",V,A),Q&&cn(f,null,y,"created"),It(C,f,f.scopeId,V,y),D){for(const st in D)st!=="value"&&!Us(st)&&i(C,st,null,D[st],R,f.children,y,_,Ve);"value"in D&&i(C,"value",null,D.value),(v=D.onVnodeBeforeMount)&&ye(v,y,f)}Q&&cn(f,null,y,"beforeMount");const lt=(!_||_&&!_.pendingBranch)&&q&&!q.persisted;lt&&q.beforeEnter(C),r(C,p,m),((v=D&&D.onVnodeMounted)||lt||Q)&&Xt(()=>{v&&ye(v,y,f),lt&&q.enter(C),Q&&cn(f,null,y,"mounted")},_)},It=(f,p,m,y,_)=>{if(m&&g(f,m),y)for(let R=0;R<y.length;R++)g(f,y[R]);if(_){let R=_.subTree;if(p===R){const V=_.vnode;It(f,V,V.scopeId,V.slotScopeIds,_.parent)}}},ct=(f,p,m,y,_,R,V,A,C=0)=>{for(let v=C;v<f.length;v++){const k=f[v]=A?je(f[v]):ae(f[v]);I(null,k,p,m,y,_,R,V,A)}},xt=(f,p,m,y,_,R,V)=>{const A=p.el=f.el;let{patchFlag:C,dynamicChildren:v,dirs:k}=p;C|=f.patchFlag&16;const D=f.props||ut,N=p.props||ut;let q;m&&un(m,!1),(q=N.onVnodeBeforeUpdate)&&ye(q,m,p,f),k&&cn(p,f,m,"beforeUpdate"),m&&un(m,!0);const Q=_&&p.type!=="foreignObject";if(v?Pt(f.dynamicChildren,v,A,m,y,Q,R):V||at(f,p,A,null,m,y,Q,R,!1),C>0){if(C&16)Zt(A,p,D,N,m,y,_);else if(C&2&&D.class!==N.class&&i(A,"class",null,N.class,_),C&4&&i(A,"style",D.style,N.style,_),C&8){const lt=p.dynamicProps;for(let st=0;st<lt.length;st++){const yt=lt[st],ie=D[yt],Dn=N[yt];(Dn!==ie||yt==="value")&&i(A,yt,ie,Dn,_,f.children,m,y,Ve)}}C&1&&f.children!==p.children&&u(A,p.children)}else!V&&v==null&&Zt(A,p,D,N,m,y,_);((q=N.onVnodeUpdated)||k)&&Xt(()=>{q&&ye(q,m,p,f),k&&cn(p,f,m,"updated")},y)},Pt=(f,p,m,y,_,R,V)=>{for(let A=0;A<p.length;A++){const C=f[A],v=p[A],k=C.el&&(C.type===Yt||!He(C,v)||C.shapeFlag&70)?h(C.el):m;I(C,v,k,null,y,_,R,V,!0)}},Zt=(f,p,m,y,_,R,V)=>{if(m!==y){if(m!==ut)for(const A in m)!Us(A)&&!(A in y)&&i(f,A,m[A],null,V,p.children,_,R,Ve);for(const A in y){if(Us(A))continue;const C=y[A],v=m[A];C!==v&&A!=="value"&&i(f,A,v,C,V,p.children,_,R,Ve)}"value"in y&&i(f,"value",m.value,y.value)}},Se=(f,p,m,y,_,R,V,A,C)=>{const v=p.el=f?f.el:a(""),k=p.anchor=f?f.anchor:a("");let{patchFlag:D,dynamicChildren:N,slotScopeIds:q}=p;q&&(A=A?A.concat(q):q),f==null?(r(v,m,y),r(k,m,y),ct(p.children,m,k,_,R,V,A,C)):D>0&&D&64&&N&&f.dynamicChildren?(Pt(f.dynamicChildren,N,m,_,R,V,A),(p.key!=null||_&&p===_.subTree)&&dh(f,p,!0)):at(f,p,m,k,_,R,V,A,C)},ge=(f,p,m,y,_,R,V,A,C)=>{p.slotScopeIds=A,f==null?p.shapeFlag&512?_.ctx.activate(p,m,y,V,C):be(p,m,y,_,R,V,C):mr(f,p,C)},be=(f,p,m,y,_,R,V)=>{const A=f.component=Kg(f,y,_);if(eh(f)&&(A.ctx.renderer=Vn),Qg(A),A.asyncDep){if(_&&_.registerDep(A,Ct),!f.el){const C=A.subTree=Tt(Ae);F(null,C,p,m)}return}Ct(A,f,p,m,_,R,V)},mr=(f,p,m)=>{const y=p.component=f.component;if(Jp(f,p,m))if(y.asyncDep&&!y.asyncResolved){ot(y,p,m);return}else y.next=p,Kp(y.update),y.update();else p.el=f.el,y.vnode=p},Ct=(f,p,m,y,_,R,V)=>{const A=()=>{if(f.isMounted){let{next:k,bu:D,u:N,parent:q,vnode:Q}=f,lt=k,st;un(f,!1),k?(k.el=Q.el,ot(f,k,V)):k=Q,D&&so(D),(st=k.props&&k.props.onVnodeBeforeUpdate)&&ye(st,q,k,Q),un(f,!0);const yt=io(f),ie=f.subTree;f.subTree=yt,I(ie,yt,h(ie.el),Is(ie),f,_,R),k.el=yt.el,lt===null&&ka(f,yt.el),N&&Xt(N,_),(st=k.props&&k.props.onVnodeUpdated)&&Xt(()=>ye(st,q,k,Q),_)}else{let k;const{el:D,props:N}=p,{bm:q,m:Q,parent:lt}=f,st=Cr(p);if(un(f,!1),q&&so(q),!st&&(k=N&&N.onVnodeBeforeMount)&&ye(k,lt,p),un(f,!0),D&&no){const yt=()=>{f.subTree=io(f),no(D,f.subTree,f,_,null)};st?p.type.__asyncLoader().then(()=>!f.isUnmounted&&yt()):yt()}else{const yt=f.subTree=io(f);I(null,yt,m,y,f,_,R),p.el=yt.el}if(Q&&Xt(Q,_),!st&&(k=N&&N.onVnodeMounted)){const yt=p;Xt(()=>ye(k,lt,yt),_)}(p.shapeFlag&256||lt&&Cr(lt.vnode)&&lt.vnode.shapeFlag&256)&&f.a&&Xt(f.a,_),f.isMounted=!0,p=m=y=null}},C=f.effect=new Ia(A,()=>Va(v),f.scope),v=f.update=()=>C.run();v.id=f.uid,un(f,!0),v()},ot=(f,p,m)=>{p.component=f;const y=f.vnode.props;f.vnode=p,f.next=null,kg(f,p.props,y,m),Og(f,p.children,m),ar(),Xl(),lr()},at=(f,p,m,y,_,R,V,A,C=!1)=>{const v=f&&f.children,k=f?f.shapeFlag:0,D=p.children,{patchFlag:N,shapeFlag:q}=p;if(N>0){if(N&128){ws(v,D,m,y,_,R,V,A,C);return}else if(N&256){an(v,D,m,y,_,R,V,A,C);return}}q&8?(k&16&&Ve(v,_,R),D!==v&&u(m,D)):k&16?q&16?ws(v,D,m,y,_,R,V,A,C):Ve(v,_,R,!0):(k&8&&u(m,""),q&16&&ct(D,m,y,_,R,V,A,C))},an=(f,p,m,y,_,R,V,A,C)=>{f=f||Fn,p=p||Fn;const v=f.length,k=p.length,D=Math.min(v,k);let N;for(N=0;N<D;N++){const q=p[N]=C?je(p[N]):ae(p[N]);I(f[N],q,m,null,_,R,V,A,C)}v>k?Ve(f,_,R,!0,!1,D):ct(p,m,y,_,R,V,A,C,D)},ws=(f,p,m,y,_,R,V,A,C)=>{let v=0;const k=p.length;let D=f.length-1,N=k-1;for(;v<=D&&v<=N;){const q=f[v],Q=p[v]=C?je(p[v]):ae(p[v]);if(He(q,Q))I(q,Q,m,null,_,R,V,A,C);else break;v++}for(;v<=D&&v<=N;){const q=f[D],Q=p[N]=C?je(p[N]):ae(p[N]);if(He(q,Q))I(q,Q,m,null,_,R,V,A,C);else break;D--,N--}if(v>D){if(v<=N){const q=N+1,Q=q<k?p[q].el:y;for(;v<=N;)I(null,p[v]=C?je(p[v]):ae(p[v]),m,Q,_,R,V,A,C),v++}}else if(v>N)for(;v<=D;)me(f[v],_,R,!0),v++;else{const q=v,Q=v,lt=new Map;for(v=Q;v<=N;v++){const te=p[v]=C?je(p[v]):ae(p[v]);te.key!=null&&lt.set(te.key,v)}let st,yt=0;const ie=N-Q+1;let Dn=!1,Bl=0;const _r=new Array(ie);for(v=0;v<ie;v++)_r[v]=0;for(v=q;v<=D;v++){const te=f[v];if(yt>=ie){me(te,_,R,!0);continue}let _e;if(te.key!=null)_e=lt.get(te.key);else for(st=Q;st<=N;st++)if(_r[st-Q]===0&&He(te,p[st])){_e=st;break}_e===void 0?me(te,_,R,!0):(_r[_e-Q]=v+1,_e>=Bl?Bl=_e:Dn=!0,I(te,p[_e],m,null,_,R,V,A,C),yt++)}const Ul=Dn?Bg(_r):Fn;for(st=Ul.length-1,v=ie-1;v>=0;v--){const te=Q+v,_e=p[te],$l=te+1<k?p[te+1].el:y;_r[v]===0?I(null,_e,m,$l,_,R,V,A,C):Dn&&(st<0||v!==Ul[st]?ln(_e,m,$l,2):st--)}}},ln=(f,p,m,y,_=null)=>{const{el:R,type:V,transition:A,children:C,shapeFlag:v}=f;if(v&6){ln(f.component.subTree,p,m,y);return}if(v&128){f.suspense.move(p,m,y);return}if(v&64){V.move(f,p,m,Vn);return}if(V===Yt){r(R,p,m);for(let D=0;D<C.length;D++)ln(C[D],p,m,y);r(f.anchor,p,m);return}if(V===ao){W(f,p,m);return}if(y!==2&&v&1&&A)if(y===0)A.beforeEnter(R),r(R,p,m),Xt(()=>A.enter(R),_);else{const{leave:D,delayLeave:N,afterLeave:q}=A,Q=()=>r(R,p,m),lt=()=>{D(R,()=>{Q(),q&&q()})};N?N(R,Q,lt):lt()}else r(R,p,m)},me=(f,p,m,y=!1,_=!1)=>{const{type:R,props:V,ref:A,children:C,dynamicChildren:v,shapeFlag:k,patchFlag:D,dirs:N}=f;if(A!=null&&Fo(A,null,m,f,!0),k&256){p.ctx.deactivate(f);return}const q=k&1&&N,Q=!Cr(f);let lt;if(Q&&(lt=V&&V.onVnodeBeforeUnmount)&&ye(lt,p,f),k&6)Qd(f.component,m,y);else{if(k&128){f.suspense.unmount(m,y);return}q&&cn(f,null,p,"beforeUnmount"),k&64?f.type.remove(f,p,m,_,Vn,y):v&&(R!==Yt||D>0&&D&64)?Ve(v,p,m,!1,!0):(R===Yt&&D&384||!_&&k&16)&&Ve(C,p,m),y&&Fl(f)}(Q&&(lt=V&&V.onVnodeUnmounted)||q)&&Xt(()=>{lt&&ye(lt,p,f),q&&cn(f,null,p,"unmounted")},m)},Fl=f=>{const{type:p,el:m,anchor:y,transition:_}=f;if(p===Yt){Wd(m,y);return}if(p===ao){w(f);return}const R=()=>{s(m),_&&!_.persisted&&_.afterLeave&&_.afterLeave()};if(f.shapeFlag&1&&_&&!_.persisted){const{leave:V,delayLeave:A}=_,C=()=>V(m,R);A?A(f.el,R,C):C()}else R()},Wd=(f,p)=>{let m;for(;f!==p;)m=d(f),s(f),f=m;s(p)},Qd=(f,p,m)=>{const{bum:y,scope:_,update:R,subTree:V,um:A}=f;y&&so(y),_.stop(),R&&(R.active=!1,me(V,f,p,m)),A&&Xt(A,p),Xt(()=>{f.isUnmounted=!0},p),p&&p.pendingBranch&&!p.isUnmounted&&f.asyncDep&&!f.asyncResolved&&f.suspenseId===p.pendingId&&(p.deps--,p.deps===0&&p.resolve())},Ve=(f,p,m,y=!1,_=!1,R=0)=>{for(let V=R;V<f.length;V++)me(f[V],p,m,y,_)},Is=f=>f.shapeFlag&6?Is(f.component.subTree):f.shapeFlag&128?f.suspense.next():d(f.anchor||f.el),Ll=(f,p,m)=>{f==null?p._vnode&&me(p._vnode,null,null,!0):I(p._vnode||null,f,p,null,null,null,m),Xl(),Xu(),p._vnode=f},Vn={p:I,um:me,m:ln,r:Fl,mt:be,mc:ct,pc:at,pbc:Pt,n:Is,o:e};let eo,no;return t&&([eo,no]=t(Vn)),{render:Ll,hydrate:eo,createApp:Vg(Ll,eo)}}function un({effect:e,update:t},n){e.allowRecurse=t.allowRecurse=n}function dh(e,t,n=!1){const r=e.children,s=t.children;if(j(r)&&j(s))for(let i=0;i<r.length;i++){const o=r[i];let a=s[i];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=s[i]=je(s[i]),a.el=o.el),n||dh(o,a)),a.type===Ri&&(a.el=o.el)}}function Bg(e){const t=e.slice(),n=[0];let r,s,i,o,a;const l=e.length;for(r=0;r<l;r++){const c=e[r];if(c!==0){if(s=n[n.length-1],e[s]<c){t[r]=s,n.push(r);continue}for(i=0,o=n.length-1;i<o;)a=i+o>>1,e[n[a]]<c?i=a+1:o=a;c<e[n[i]]&&(i>0&&(t[r]=n[i-1]),n[i]=r)}}for(i=n.length,o=n[i-1];i-- >0;)n[i]=o,o=t[o];return n}const Ug=e=>e.__isTeleport,Yt=Symbol.for("v-fgt"),Ri=Symbol.for("v-txt"),Ae=Symbol.for("v-cmt"),ao=Symbol.for("v-stc"),br=[];let se=null;function nt(e=!1){br.push(se=e?null:[])}function ph(){br.pop(),se=br[br.length-1]||null}let Xn=1;function cc(e){Xn+=e}function gh(e){return e.dynamicChildren=Xn>0?se||Fn:null,ph(),Xn>0&&se&&se.push(e),e}function _t(e,t,n,r,s,i){return gh(it(e,t,n,r,s,i,!0))}function qe(e,t,n,r,s){return gh(Tt(e,t,n,r,s,!0))}function Fa(e){return e?e.__v_isVNode===!0:!1}function He(e,t){return e.type===t.type&&e.key===t.key}const Pi="__vInternal",mh=({key:e})=>e??null,qs=({ref:e,ref_key:t,ref_for:n})=>(typeof e=="number"&&(e=""+e),e!=null?wt(e)||jt(e)||z(e)?{i:qt,r:e,k:t,f:!!n}:e:null);function it(e,t=null,n=null,r=0,s=null,i=e===Yt?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&mh(t),ref:t&&qs(t),scopeId:Ii,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:r,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:qt};return a?(La(l,n),i&128&&e.normalize(l)):n&&(l.shapeFlag|=wt(n)?8:16),Xn>0&&!o&&se&&(l.patchFlag>0||i&6)&&l.patchFlag!==32&&se.push(l),l}const Tt=$g;function $g(e,t=null,n=null,r=0,s=null,i=!1){if((!e||e===Tg)&&(e=Ae),Fa(e)){const a=Yn(e,t,!0);return n&&La(a,n),Xn>0&&!i&&se&&(a.shapeFlag&6?se[se.indexOf(e)]=a:se.push(a)),a.patchFlag|=-2,a}if(Jg(e)&&(e=e.__vccOpts),t){t=jg(t);let{class:a,style:l}=t;a&&!wt(a)&&(t.class=vi(a)),pt(l)&&($u(l)&&!j(l)&&(l=bt({},l)),t.style=pn(l))}const o=wt(e)?1:Zp(e)?128:Ug(e)?64:pt(e)?4:z(e)?2:0;return it(e,t,n,r,s,o,i,!0)}function jg(e){return e?$u(e)||Pi in e?bt({},e):e:null}function Yn(e,t,n=!1){const{props:r,ref:s,patchFlag:i,children:o}=e,a=t?qg(r||{},t):r;return{__v_isVNode:!0,__v_skip:!0,type:e.type,props:a,key:a&&mh(a),ref:t&&t.ref?n&&s?j(s)?s.concat(qs(t)):[s,qs(t)]:qs(t):s,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:o,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==Yt?i===-1?16:i|16:i,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&Yn(e.ssContent),ssFallback:e.ssFallback&&Yn(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce}}function os(e=" ",t=0){return Tt(Ri,null,e,t)}function _h(e="",t=!1){return t?(nt(),qe(Ae,null,e)):Tt(Ae,null,e)}function ae(e){return e==null||typeof e=="boolean"?Tt(Ae):j(e)?Tt(Yt,null,e.slice()):typeof e=="object"?je(e):Tt(Ri,null,String(e))}function je(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:Yn(e)}function La(e,t){let n=0;const{shapeFlag:r}=e;if(t==null)t=null;else if(j(t))n=16;else if(typeof t=="object")if(r&65){const s=t.default;s&&(s._c&&(s._d=!1),La(e,s()),s._c&&(s._d=!0));return}else{n=32;const s=t._;!s&&!(Pi in t)?t._ctx=qt:s===3&&qt&&(qt.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else z(t)?(t={default:t,_ctx:qt},n=32):(t=String(t),r&64?(n=16,t=[os(t)]):n=8);e.children=t,e.shapeFlag|=n}function qg(...e){const t={};for(let n=0;n<e.length;n++){const r=e[n];for(const s in r)if(s==="class")t.class!==r.class&&(t.class=vi([t.class,r.class]));else if(s==="style")t.style=pn([t.style,r.style]);else if(_i(s)){const i=t[s],o=r[s];o&&i!==o&&!(j(i)&&i.includes(o))&&(t[s]=i?[].concat(i,o):o)}else s!==""&&(t[s]=r[s])}return t}function ye(e,t,n,r=null){he(e,t,7,[n,r])}const Hg=ah();let zg=0;function Kg(e,t,n){const r=e.type,s=(t?t.appContext:e.appContext)||Hg,i={uid:zg++,vnode:e,type:r,parent:t,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,scope:new cp(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(s.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:ch(r,s),emitsOptions:Ju(r,s),emit:null,emitted:null,propsDefaults:ut,inheritAttrs:r.inheritAttrs,ctx:ut,data:ut,props:ut,attrs:ut,slots:ut,refs:ut,setupState:ut,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=t?t.root:i,i.emit=Qp.bind(null,i),e.ce&&e.ce(i),i}let Mt=null;const Wg=()=>Mt||qt;let Ba,xn,uc="__VUE_INSTANCE_SETTERS__";(xn=Co()[uc])||(xn=Co()[uc]=[]),xn.push(e=>Mt=e),Ba=e=>{xn.length>1?xn.forEach(t=>t(e)):xn[0](e)};const tn=e=>{Ba(e),e.scope.on()},Qe=()=>{Mt&&Mt.scope.off(),Ba(null)};function yh(e){return e.vnode.shapeFlag&4}let $r=!1;function Qg(e,t=!1){$r=t;const{props:n,children:r}=e.vnode,s=yh(e);xg(e,n,s,t),Mg(e,r);const i=s?Gg(e,t):void 0;return $r=!1,i}function Gg(e,t){const n=e.type;e.accessCache=Object.create(null),e.proxy=ju(new Proxy(e.ctx,Ig));const{setup:r}=n;if(r){const s=e.setupContext=r.length>1?Yg(e):null;tn(e),ar();const i=We(r,e,0,[e.props,s]);if(lr(),Qe(),va(i)){if(i.then(Qe,Qe),t)return i.then(o=>{Lo(e,o,t)}).catch(o=>{is(o,e,0)});e.asyncDep=i}else Lo(e,i,t)}else Eh(e,t)}function Lo(e,t,n){z(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:pt(t)&&(e.setupState=zu(t)),Eh(e,n)}let hc;function Eh(e,t,n){const r=e.type;if(!e.render){if(!t&&hc&&!r.render){const s=r.template||Ma(e).template;if(s){const{isCustomElement:i,compilerOptions:o}=e.appContext.config,{delimiters:a,compilerOptions:l}=r,c=bt(bt({isCustomElement:i,delimiters:a},o),l);r.render=hc(s,c)}}e.render=r.render||ue}tn(e),ar(),Ag(e),lr(),Qe()}function Xg(e){return e.attrsProxy||(e.attrsProxy=new Proxy(e.attrs,{get(t,n){return Jt(e,"get","$attrs"),t[n]}}))}function Yg(e){const t=n=>{e.exposed=n||{}};return{get attrs(){return Xg(e)},slots:e.slots,emit:e.emit,expose:t}}function Ci(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(zu(ju(e.exposed)),{get(t,n){if(n in t)return t[n];if(n in Sr)return Sr[n](e)},has(t,n){return n in t||n in Sr}}))}function Jg(e){return z(e)&&"__vccOpts"in e}const Ua=(e,t)=>qp(e,t,$r),Zg=Symbol.for("v-scx"),tm=()=>js(Zg),em="3.3.4",nm="http://www.w3.org/2000/svg",dn=typeof document<"u"?document:null,fc=dn&&dn.createElement("template"),rm={insert:(e,t,n)=>{t.insertBefore(e,n||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,n,r)=>{const s=t?dn.createElementNS(nm,e):dn.createElement(e,n?{is:n}:void 0);return e==="select"&&r&&r.multiple!=null&&s.setAttribute("multiple",r.multiple),s},createText:e=>dn.createTextNode(e),createComment:e=>dn.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>dn.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,n,r,s,i){const o=n?n.previousSibling:t.lastChild;if(s&&(s===i||s.nextSibling))for(;t.insertBefore(s.cloneNode(!0),n),!(s===i||!(s=s.nextSibling)););else{fc.innerHTML=r?`<svg>${e}</svg>`:e;const a=fc.content;if(r){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}t.insertBefore(a,n)}return[o?o.nextSibling:t.firstChild,n?n.previousSibling:t.lastChild]}};function sm(e,t,n){const r=e._vtc;r&&(t=(t?[t,...r]:[...r]).join(" ")),t==null?e.removeAttribute("class"):n?e.setAttribute("class",t):e.className=t}function im(e,t,n){const r=e.style,s=wt(n);if(n&&!s){if(t&&!wt(t))for(const i in t)n[i]==null&&Bo(r,i,"");for(const i in n)Bo(r,i,n[i])}else{const i=r.display;s?t!==n&&(r.cssText=n):t&&e.removeAttribute("style"),"_vod"in e&&(r.display=i)}}const dc=/\s*!important$/;function Bo(e,t,n){if(j(n))n.forEach(r=>Bo(e,t,r));else if(n==null&&(n=""),t.startsWith("--"))e.setProperty(t,n);else{const r=om(e,t);dc.test(n)?e.setProperty(or(r),n.replace(dc,""),"important"):e[r]=n}}const pc=["Webkit","Moz","ms"],lo={};function om(e,t){const n=lo[t];if(n)return n;let r=Qn(t);if(r!=="filter"&&r in e)return lo[t]=r;r=Cu(r);for(let s=0;s<pc.length;s++){const i=pc[s]+r;if(i in e)return lo[t]=i}return t}const gc="http://www.w3.org/1999/xlink";function am(e,t,n,r,s){if(r&&t.startsWith("xlink:"))n==null?e.removeAttributeNS(gc,t.slice(6,t.length)):e.setAttributeNS(gc,t,n);else{const i=lp(t);n==null||i&&!Su(n)?e.removeAttribute(t):e.setAttribute(t,i?"":n)}}function lm(e,t,n,r,s,i,o){if(t==="innerHTML"||t==="textContent"){r&&o(r,s,i),e[t]=n??"";return}const a=e.tagName;if(t==="value"&&a!=="PROGRESS"&&!a.includes("-")){e._value=n;const c=a==="OPTION"?e.getAttribute("value"):e.value,u=n??"";c!==u&&(e.value=u),n==null&&e.removeAttribute(t);return}let l=!1;if(n===""||n==null){const c=typeof e[t];c==="boolean"?n=Su(n):n==null&&c==="string"?(n="",l=!0):c==="number"&&(n=0,l=!0)}try{e[t]=n}catch{}l&&e.removeAttribute(t)}function cm(e,t,n,r){e.addEventListener(t,n,r)}function um(e,t,n,r){e.removeEventListener(t,n,r)}function hm(e,t,n,r,s=null){const i=e._vei||(e._vei={}),o=i[t];if(r&&o)o.value=r;else{const[a,l]=fm(t);if(r){const c=i[t]=gm(r,s);cm(e,a,c,l)}else o&&(um(e,a,o,l),i[t]=void 0)}}const mc=/(?:Once|Passive|Capture)$/;function fm(e){let t;if(mc.test(e)){t={};let r;for(;r=e.match(mc);)e=e.slice(0,e.length-r[0].length),t[r[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):or(e.slice(2)),t]}let co=0;const dm=Promise.resolve(),pm=()=>co||(dm.then(()=>co=0),co=Date.now());function gm(e,t){const n=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=n.attached)return;he(mm(r,n.value),t,5,[r])};return n.value=e,n.attached=pm(),n}function mm(e,t){if(j(t)){const n=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{n.call(e),e._stopped=!0},t.map(r=>s=>!s._stopped&&r&&r(s))}else return t}const _c=/^on[a-z]/,_m=(e,t,n,r,s=!1,i,o,a,l)=>{t==="class"?sm(e,r,s):t==="style"?im(e,n,r):_i(t)?_a(t)||hm(e,t,n,r,o):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):ym(e,t,r,s))?lm(e,t,r,i,o,a,l):(t==="true-value"?e._trueValue=r:t==="false-value"&&(e._falseValue=r),am(e,t,r,s))};function ym(e,t,n,r){return r?!!(t==="innerHTML"||t==="textContent"||t in e&&_c.test(t)&&z(n)):t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA"||_c.test(t)&&wt(n)?!1:t in e}const yc={beforeMount(e,{value:t},{transition:n}){e._vod=e.style.display==="none"?"":e.style.display,n&&t?n.beforeEnter(e):yr(e,t)},mounted(e,{value:t},{transition:n}){n&&t&&n.enter(e)},updated(e,{value:t,oldValue:n},{transition:r}){!t!=!n&&(r?t?(r.beforeEnter(e),yr(e,!0),r.enter(e)):r.leave(e,()=>{yr(e,!1)}):yr(e,t))},beforeUnmount(e,{value:t}){yr(e,t)}};function yr(e,t){e.style.display=t?e._vod:"none"}const Em=bt({patchProp:_m},rm);let Ec;function vm(){return Ec||(Ec=Fg(Em))}const Tm=(...e)=>{const t=vm().createApp(...e),{mount:n}=t;return t.mount=r=>{const s=wm(r);if(!s)return;const i=t._component;!z(i)&&!i.render&&!i.template&&(i.template=s.innerHTML),s.innerHTML="";const o=n(s,!1,s instanceof SVGElement);return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),o},t};function wm(e){return wt(e)?document.querySelector(e):e}const Im={class:"button-wrapper"},Am=Ce({__name:"QuestionOption",props:{option:{},active:{}},emits:["submit","setactive"],setup(e,{emit:t}){const n=e,r=ke(null),s=Ua(()=>({active:n.active===n.option,"button-wrapper":!0}));console.log(n.active);const i=()=>{t("setactive",n.option)};return(o,a)=>(nt(),_t("div",Im,[it("button",{onClick:i,class:vi(s.value),ref_key:"choice",ref:r},Bn(o.option),3)]))}});const pe=(e,t)=>{const n=e.__vccOpts||e;for(const[r,s]of t)n[r]=s;return n},Rm=pe(Am,[["__scopeId","data-v-324116cb"]]);const Pm={},Cm={class:"button-primary"};function Sm(e,t){return nt(),_t("button",Cm,[wg(e.$slots,"default",{},()=>[os("content here")],!0)])}const $a=pe(Pm,[["render",Sm],["__scopeId","data-v-17a360b4"]]),bm={class:"option-wrapper"},Vm={class:"option"},Dm={class:"next-button"},xm=Ce({__name:"SingleQuestion",props:{answers:{}},emits:["update"],setup(e,{emit:t}){const n=e,r=ke("");let s=n.answers.sort(()=>Math.random()-.5);const i=()=>{r.value.length===0?console.log("will show validation message"):(t("update",r.value),r.value="")},o=l=>{r.value=l},a=Ua(()=>r.value);return $s(()=>n.answers,()=>{s=n.answers.sort(()=>Math.random()-.5)}),(l,c)=>(nt(),_t("div",bm,[(nt(!0),_t(Yt,null,sh(wn(s),u=>(nt(),_t("div",Vm,[Tt(Rm,{option:u,active:a.value,onSetactive:o},null,8,["option","active"])]))),256)),it("div",Dm,[Tt($a,{onClick:i},{default:Br(()=>[os("Next")]),_:1})])]))}});const km=pe(xm,[["__scopeId","data-v-f7102c3d"]]),Nm=["Piddlehinton","Upperthong","Shitterton","Fingringhoe","Wetwang","Titty Ho","Twatt","Dull","Great Snoring","Scratchy Bottom","Pity Me","Brokenwind","Crapstone","Nether Wallop","Pratts Bottom","Ugley","Bitchfield","Sandy Balls","Brown Willy","Booby Dingle","Old Sodbury","Scratch Arse Ware","Barton in the Beans","Sheepy Magna","Hooe","No Place","Bishop's Itchington","Bell End","Cockermouth","Lickey End","Spital-in-the-Street","Giggleswick","Snodland","Netherthong","Tockholes","Penistone","Blubberhouses","Boggy Bottom","Butt of Lewis","Wrabness"],Mm=["Plopington","Ballywobble","Hoe's End","Squabbleton","Tiddly Wink","Bumbersberry","Wankinbrook","Roobshead","Rye On Cock","Loober","Patrickshead","Nobbad","Wetswater","Banterbury","Sodderingay","Codsminster","Soggy Bank","Trout-on-Rye","Null","Amberprick"],Om={Upperthong:'Every year Upperthong hosts the "World Welly Wanging Championships."',Shitterton:"The sign of the hamlet of ”Shitterton,” has been stolen so many times that the residents replaced it with a large purbeck stone",Fingringhoe:'The name ”Fingringhoe” can be loosely translated as ”the spur or promontory shaped like a finger."',Wetwang:"The name ”Wetwang” is derived from the Old Norse language and translates to ”wet field” or ”marshy meadow.”","Titty Ho":"The name ”Titty Ho” is believed to be derived from the Old English word ”tethe,” meaning ”a small hill,” and the word ”hoe,” which refers to a high ridge or spur of land.",Twatt:"There are multiple Twatts in the UK, the name belonging to settlements in both Orkey and the Shetland Island.",Dull:"The village of Dull is twinned with Boring, a town in Oregon, USA.","Great Snoring":" “The name ”Snoring” is believed to come from the Old English word ”snear,” meaning ”narrow.”","Scratchy Bottom":"The name ”Scratchy Bottom” is believed to have originated from the Old English word ”scræf” meaning ”a small hollow” and ”bottm” referring to a valley or hollow.","Pity Me":"The origin of the name is ”Pity Me” is uncertain, but it is believed to come from an Old English word ”peth” or ”pit,” meaning ”a small enclosure.”",Brokenwind:'The Hamlet of Brokenwind is located in Aberdeenshire, Scotland. It was voted third "worst place names" in the British Isles in 2012.',Crapstone:"The residents of Crapstone are proud of its name, and successfully campaigned to prevent the village's name from being changed in the 1980s.","Nether Wallop":"The village of Nether Wallop is said to have inspired the setting for the fictional village of St. Mary Mead, the home of Miss Marple in many Agatha Christie detective novels.","Pratts Bottom":"The name Pratt’s Bottom originates from the Old English word ”prætt,” meaning ”trick or deceit,” combined with the word ”bottom,” which refers to a valley or hollow.",Ugley:"”Ugley” is home to the Ugley Women's Institute and Ugley Farmer’s Market.",Bitchfield:"The name ”Bitchfield” is believed to have originated from the Old English word ”bicce,” meaning ”female dog,” combined with the word ”feld,” which refers to an open area or field.","Sandy Balls":"The ”Sandy” in ”Sandy Balls” refers to the sandy soil found in the area, while ”Balls” is derived from an old English word meaning a prominent hill or rounded hilltop.","Brown Willy":"Brown Willy is the highest point in Cornwall, England.","Booby Dingle":"Booby Dingle is a valley in Herefordshire that sits close to the Welsh border.","Old Sodbury":"Old Sodbury is a small village in Gloucestershire.","Scratch Arse Ware":"Scratch Arse Ware is an area of limestone hills in Purbeck, Dorset, known for its picturesque views that make it popular with hikers.","Barton in the Beans":"It’s theorised that the ”Beans” in  ”Barton in the Beans” part was added to distinguish the village from other places named Barton.","Sheepy Magna":"The name Sheepy Magna is derived from the Old English word ”sceapige,” meaning ”sheep enclosure,” and ”magna,” meaning ”great” or ”large.”","No Place":"No Place was originally a small mining village, known for its coal mining industry in the 19th and early 20th centuries.","Bishop's Itchington":"Bishop's Itchington is a village in Warwickshire.","Bell End":"Bell End is the name of both a village in Worcestershire and a street in West Midlands.",Cockermouth:"Cockermouth is best known for being the birthplace of William Wordsworth in 1770.","Lickey End":"Lickey End is known for its connection to an early form of transportation: the Lickey Incline. Built in the 19th century, it’s one of the steepest sustained mainline railway inclines in the UK.","Spital-in-the-Street":"The name ”Spital-in-the-Street” is derived from the Old English word ”spital” or ”spyttel,” meaning a hospital or almshouse. During medieval times it was home to St. Mary Magdalene Hospital, which provided care for the sick and needy.",Giggleswick:"Giggleswick is known for its association with the Giggleswick School. Each year its students operate the scoreboards at the Open Championship golf tournament.",Hooe:"Every year the village of Hooe hosts the ”Hooe's Old Motor Club Swop Meet”, an event for motoring enthusiasts.",Snodland:"The town of Snodland was a significant centre for cement production in the 19th and early 20th centuries.",Netherthong:"Every year the village of Netherthong hosts the “Netherthong Scarecrow Festival.”",Tockholes:"In 1989 the village of Tockholes hosted the Live The Dream rave, that was thought to be a big turning point in house/techno culture.",Penistone:"The annual ”Penistone Agricultural Show” has been taking place for over 150 years, making it one of the oldest agricultural shows in the country.",Blubberhouses:"It is believed that the name ”Blubberhouses” is derived from the old English word ”bluber,” meaning bubble or boil, and ”houses,” which refers to small buildings or huts.","Boggy Bottom":"Boggy Bottom is a hamlet in Hertfordshire. In 2016 it was voted the third funniest place names in the UK. ","Butt of Lewis":"The Butt of Lewis is located on the northernmost tip of the Isle of Lewis in the Outer Hebrides, Scotland and is known for its iconic lighthouse.",Wrabness:"In 2015 Wrabness became the location of a conceptual holiday home built by artist Grayson Perry.",Piddlehinton:"The word ”Piddle” is derived from the River Piddle, which flows through the area."};function Fm(e,t){const n=[],[...r]=t,[...s]=e;for(let i=0;n.length<20;i++){const o=[],a=Math.floor(Math.random()*r.length),l=r[a];r.splice(a,1),o.push(l);const c=Math.floor(Math.random()*s.length),u=s[c];s.splice(c,1),o.push(u);const h=Math.floor(Math.random()*s.length),d=s[h];s.splice(h,1),o.push(d),o.length===3&&n.push(o)}return n}const Lm={class:"quiz"},Bm={class:"heading-wrapper"},Um={class:"question-number"},$m=Ce({__name:"QuizSection",emits:["updateStage"],setup(e,{emit:t}){const n=ke(0),r=Fm(Nm,Mm),[...s]=r,i=[];s.forEach(u=>i.push(u[0]));const o=ke(s[0]),a=[],l=u=>{let h=!1;u===i[n.value]&&(h=!0);const d={answer:u,isCorrect:h};a.push(d)},c=async u=>{n.value===19?(l(u),t("updateStage",a)):(l(u),n.value+=1,o.value=s[n.value],await Wu())};return(u,h)=>(nt(),_t("div",Lm,[it("div",Bm,[it("h1",Um,"Question "+Bn(n.value+1)+" of 20",1)]),Tt(km,{answers:o.value,onUpdate:c},null,8,["answers"])]))}});const jm=e=>(Da("data-v-2839a0a3"),e=e(),xa(),e),qm={class:"quiz"},Hm=jm(()=>it("div",{class:"title"},[it("h1",null,"Place Name or Fake Name?"),it("h2",null,"Guess which of three UK placenames is fake")],-1)),zm=Ce({__name:"HomePage",emits:["updateStage"],setup(e,{emit:t}){const n=()=>{t("updateStage")};return(r,s)=>(nt(),_t("div",qm,[Hm,Tt($a,{onClick:n},{default:Br(()=>[os("Start")]),_:1})]))}});const Km=pe(zm,[["__scopeId","data-v-2839a0a3"]]);function Wm(e){return Om[e.answer]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vh=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let s=e.charCodeAt(r);s<128?t[n++]=s:s<2048?(t[n++]=s>>6|192,t[n++]=s&63|128):(s&64512)===55296&&r+1<e.length&&(e.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(e.charCodeAt(++r)&1023),t[n++]=s>>18|240,t[n++]=s>>12&63|128,t[n++]=s>>6&63|128,t[n++]=s&63|128):(t[n++]=s>>12|224,t[n++]=s>>6&63|128,t[n++]=s&63|128)}return t},Qm=function(e){const t=[];let n=0,r=0;for(;n<e.length;){const s=e[n++];if(s<128)t[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=e[n++];t[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=e[n++],o=e[n++],a=e[n++],l=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;t[r++]=String.fromCharCode(55296+(l>>10)),t[r++]=String.fromCharCode(56320+(l&1023))}else{const i=e[n++],o=e[n++];t[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return t.join("")},Th={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<e.length;s+=3){const i=e[s],o=s+1<e.length,a=o?e[s+1]:0,l=s+2<e.length,c=l?e[s+2]:0,u=i>>2,h=(i&3)<<4|a>>4;let d=(a&15)<<2|c>>6,g=c&63;l||(g=64,o||(d=64)),r.push(n[u],n[h],n[d],n[g])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(vh(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):Qm(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<e.length;){const i=n[e.charAt(s++)],a=s<e.length?n[e.charAt(s)]:0;++s;const c=s<e.length?n[e.charAt(s)]:64;++s;const h=s<e.length?n[e.charAt(s)]:64;if(++s,i==null||a==null||c==null||h==null)throw new Gm;const d=i<<2|a>>4;if(r.push(d),c!==64){const g=a<<4&240|c>>2;if(r.push(g),h!==64){const P=c<<6&192|h;r.push(P)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class Gm extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Xm=function(e){const t=vh(e);return Th.encodeByteArray(t,!0)},Zs=function(e){return Xm(e).replace(/\./g,"")},Ym=function(e){try{return Th.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jm(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zm=()=>Jm().__FIREBASE_DEFAULTS__,t_=()=>{if(typeof process>"u"||typeof process.env>"u")return;const e={}.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)},e_=()=>{if(typeof document>"u")return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=e&&Ym(e[1]);return t&&JSON.parse(t)},wh=()=>{try{return Zm()||t_()||e_()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},n_=e=>{var t,n;return(n=(t=wh())===null||t===void 0?void 0:t.emulatorHosts)===null||n===void 0?void 0:n[e]},r_=e=>{const t=n_(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(n+1),10);return t[0]==="["?[t.substring(1,n-1),r]:[t.substring(0,n),r]},Ih=()=>{var e;return(e=wh())===null||e===void 0?void 0:e.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s_{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,n)=>{this.resolve=t,this.reject=n})}wrapCallback(t){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(n):t(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i_(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=t||"demo-project",s=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e),a="";return[Zs(JSON.stringify(n)),Zs(JSON.stringify(o)),a].join(".")}function o_(){try{return typeof indexedDB=="object"}catch{return!1}}function a_(){return new Promise((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;t(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){t(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l_="FirebaseError";class cr extends Error{constructor(t,n,r){super(n),this.code=t,this.customData=r,this.name=l_,Object.setPrototypeOf(this,cr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ah.prototype.create)}}class Ah{constructor(t,n,r){this.service=t,this.serviceName=n,this.errors=r}create(t,...n){const r=n[0]||{},s=`${this.service}/${t}`,i=this.errors[t],o=i?c_(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new cr(s,a,r)}}function c_(e,t){return e.replace(u_,(n,r)=>{const s=t[r];return s!=null?String(s):`<${r}?>`})}const u_=/\{\$([^}]+)}/g;function Uo(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const s of n){if(!r.includes(s))return!1;const i=e[s],o=t[s];if(vc(i)&&vc(o)){if(!Uo(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function vc(e){return e!==null&&typeof e=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jr(e){return e&&e._delegate?e._delegate:e}class qr{constructor(t,n,r){this.name=t,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hn="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h_{constructor(t,n){this.name=t,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const n=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(n)){const r=new s_;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(t){var n;const r=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),s=(n=t==null?void 0:t.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(d_(t))try{this.getOrInitializeService({instanceIdentifier:hn})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(t=hn){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...t.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=hn){return this.instances.has(t)}getOptions(t=hn){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:n={}}=t,r=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(t,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(t),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&t(o,s),()=>{i.delete(t)}}invokeOnInitCallbacks(t,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(t,n)}catch{}}getOrInitializeService({instanceIdentifier:t,options:n={}}){let r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:f_(t),options:n}),this.instances.set(t,r),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch{}return r||null}normalizeInstanceIdentifier(t=hn){return this.component?this.component.multipleInstances?t:hn:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function f_(e){return e===hn?void 0:e}function d_(e){return e.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p_{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const n=this.getProvider(t.name);if(n.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);n.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const n=new h_(t,this);return this.providers.set(t,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var et;(function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"})(et||(et={}));const g_={debug:et.DEBUG,verbose:et.VERBOSE,info:et.INFO,warn:et.WARN,error:et.ERROR,silent:et.SILENT},m_=et.INFO,__={[et.DEBUG]:"log",[et.VERBOSE]:"log",[et.INFO]:"info",[et.WARN]:"warn",[et.ERROR]:"error"},y_=(e,t,...n)=>{if(t<e.logLevel)return;const r=new Date().toISOString(),s=__[t];if(s)console[s](`[${r}]  ${e.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class Rh{constructor(t){this.name=t,this._logLevel=m_,this._logHandler=y_,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in et))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?g_[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,et.DEBUG,...t),this._logHandler(this,et.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,et.VERBOSE,...t),this._logHandler(this,et.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,et.INFO,...t),this._logHandler(this,et.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,et.WARN,...t),this._logHandler(this,et.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,et.ERROR,...t),this._logHandler(this,et.ERROR,...t)}}const E_=(e,t)=>t.some(n=>e instanceof n);let Tc,wc;function v_(){return Tc||(Tc=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function T_(){return wc||(wc=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Ph=new WeakMap,$o=new WeakMap,Ch=new WeakMap,uo=new WeakMap,ja=new WeakMap;function w_(e){const t=new Promise((n,r)=>{const s=()=>{e.removeEventListener("success",i),e.removeEventListener("error",o)},i=()=>{n(Ge(e.result)),s()},o=()=>{r(e.error),s()};e.addEventListener("success",i),e.addEventListener("error",o)});return t.then(n=>{n instanceof IDBCursor&&Ph.set(n,e)}).catch(()=>{}),ja.set(t,e),t}function I_(e){if($o.has(e))return;const t=new Promise((n,r)=>{const s=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",o),e.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(e.error||new DOMException("AbortError","AbortError")),s()};e.addEventListener("complete",i),e.addEventListener("error",o),e.addEventListener("abort",o)});$o.set(e,t)}let jo={get(e,t,n){if(e instanceof IDBTransaction){if(t==="done")return $o.get(e);if(t==="objectStoreNames")return e.objectStoreNames||Ch.get(e);if(t==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Ge(e[t])},set(e,t,n){return e[t]=n,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function A_(e){jo=e(jo)}function R_(e){return e===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...n){const r=e.call(ho(this),t,...n);return Ch.set(r,t.sort?t.sort():[t]),Ge(r)}:T_().includes(e)?function(...t){return e.apply(ho(this),t),Ge(Ph.get(this))}:function(...t){return Ge(e.apply(ho(this),t))}}function P_(e){return typeof e=="function"?R_(e):(e instanceof IDBTransaction&&I_(e),E_(e,v_())?new Proxy(e,jo):e)}function Ge(e){if(e instanceof IDBRequest)return w_(e);if(uo.has(e))return uo.get(e);const t=P_(e);return t!==e&&(uo.set(e,t),ja.set(t,e)),t}const ho=e=>ja.get(e);function C_(e,t,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(e,t),a=Ge(o);return r&&o.addEventListener("upgradeneeded",l=>{r(Ge(o.result),l.oldVersion,l.newVersion,Ge(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const S_=["get","getKey","getAll","getAllKeys","count"],b_=["put","add","delete","clear"],fo=new Map;function Ic(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(fo.get(t))return fo.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,s=b_.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||S_.includes(n)))return;const i=async function(o,...a){const l=this.transaction(o,s?"readwrite":"readonly");let c=l.store;return r&&(c=c.index(a.shift())),(await Promise.all([c[n](...a),s&&l.done]))[0]};return fo.set(t,i),i}A_(e=>({...e,get:(t,n,r)=>Ic(t,n)||e.get(t,n,r),has:(t,n)=>!!Ic(t,n)||e.has(t,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V_{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(D_(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function D_(e){const t=e.getComponent();return(t==null?void 0:t.type)==="VERSION"}const qo="@firebase/app",Ac="0.9.14";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const In=new Rh("@firebase/app"),x_="@firebase/app-compat",k_="@firebase/analytics-compat",N_="@firebase/analytics",M_="@firebase/app-check-compat",O_="@firebase/app-check",F_="@firebase/auth",L_="@firebase/auth-compat",B_="@firebase/database",U_="@firebase/database-compat",$_="@firebase/functions",j_="@firebase/functions-compat",q_="@firebase/installations",H_="@firebase/installations-compat",z_="@firebase/messaging",K_="@firebase/messaging-compat",W_="@firebase/performance",Q_="@firebase/performance-compat",G_="@firebase/remote-config",X_="@firebase/remote-config-compat",Y_="@firebase/storage",J_="@firebase/storage-compat",Z_="@firebase/firestore",ty="@firebase/firestore-compat",ey="firebase",ny="10.0.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ho="[DEFAULT]",ry={[qo]:"fire-core",[x_]:"fire-core-compat",[N_]:"fire-analytics",[k_]:"fire-analytics-compat",[O_]:"fire-app-check",[M_]:"fire-app-check-compat",[F_]:"fire-auth",[L_]:"fire-auth-compat",[B_]:"fire-rtdb",[U_]:"fire-rtdb-compat",[$_]:"fire-fn",[j_]:"fire-fn-compat",[q_]:"fire-iid",[H_]:"fire-iid-compat",[z_]:"fire-fcm",[K_]:"fire-fcm-compat",[W_]:"fire-perf",[Q_]:"fire-perf-compat",[G_]:"fire-rc",[X_]:"fire-rc-compat",[Y_]:"fire-gcs",[J_]:"fire-gcs-compat",[Z_]:"fire-fst",[ty]:"fire-fst-compat","fire-js":"fire-js",[ey]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ti=new Map,zo=new Map;function sy(e,t){try{e.container.addComponent(t)}catch(n){In.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function ei(e){const t=e.name;if(zo.has(t))return In.debug(`There were multiple attempts to register component ${t}.`),!1;zo.set(t,e);for(const n of ti.values())sy(n,e);return!0}function iy(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oy={["no-app"]:"No Firebase App '{$appName}' has been created - call initializeApp() first",["bad-app-name"]:"Illegal App name: '{$appName}",["duplicate-app"]:"Firebase App named '{$appName}' already exists with different options or config",["app-deleted"]:"Firebase App named '{$appName}' already deleted",["no-options"]:"Need to provide options, when not being deployed to hosting via source.",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance.",["invalid-log-argument"]:"First argument to `onLog` must be null or a function.",["idb-open"]:"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.",["idb-get"]:"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.",["idb-set"]:"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.",["idb-delete"]:"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},Xe=new Ah("app","Firebase",oy);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ay{constructor(t,n,r){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new qr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw Xe.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ly=ny;function Sh(e,t={}){let n=e;typeof t!="object"&&(t={name:t});const r=Object.assign({name:Ho,automaticDataCollectionEnabled:!1},t),s=r.name;if(typeof s!="string"||!s)throw Xe.create("bad-app-name",{appName:String(s)});if(n||(n=Ih()),!n)throw Xe.create("no-options");const i=ti.get(s);if(i){if(Uo(n,i.options)&&Uo(r,i.config))return i;throw Xe.create("duplicate-app",{appName:s})}const o=new p_(s);for(const l of zo.values())o.addComponent(l);const a=new ay(n,r,o);return ti.set(s,a),a}function cy(e=Ho){const t=ti.get(e);if(!t&&e===Ho&&Ih())return Sh();if(!t)throw Xe.create("no-app",{appName:e});return t}function qn(e,t,n){var r;let s=(r=ry[e])!==null&&r!==void 0?r:e;n&&(s+=`-${n}`);const i=s.match(/\s|\//),o=t.match(/\s|\//);if(i||o){const a=[`Unable to register library "${s}" with version "${t}":`];i&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${t}" contains illegal characters (whitespace or "/")`),In.warn(a.join(" "));return}ei(new qr(`${s}-version`,()=>({library:s,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uy="firebase-heartbeat-database",hy=1,Hr="firebase-heartbeat-store";let po=null;function bh(){return po||(po=C_(uy,hy,{upgrade:(e,t)=>{switch(t){case 0:e.createObjectStore(Hr)}}}).catch(e=>{throw Xe.create("idb-open",{originalErrorMessage:e.message})})),po}async function fy(e){try{return await(await bh()).transaction(Hr).objectStore(Hr).get(Vh(e))}catch(t){if(t instanceof cr)In.warn(t.message);else{const n=Xe.create("idb-get",{originalErrorMessage:t==null?void 0:t.message});In.warn(n.message)}}}async function Rc(e,t){try{const r=(await bh()).transaction(Hr,"readwrite");await r.objectStore(Hr).put(t,Vh(e)),await r.done}catch(n){if(n instanceof cr)In.warn(n.message);else{const r=Xe.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});In.warn(r.message)}}}function Vh(e){return`${e.name}!${e.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dy=1024,py=30*24*60*60*1e3;class gy{constructor(t){this.container=t,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new _y(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=Pc();if(this._heartbeatsCache===null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(s=>s.date===r)))return this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(s=>{const i=new Date(s.date).valueOf();return Date.now()-i<=py}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache===null||this._heartbeatsCache.heartbeats.length===0)return"";const t=Pc(),{heartbeatsToSend:n,unsentEntries:r}=my(this._heartbeatsCache.heartbeats),s=Zs(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}}function Pc(){return new Date().toISOString().substring(0,10)}function my(e,t=dy){const n=[];let r=e.slice();for(const s of e){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),Cc(n)>t){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Cc(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class _y{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return o_()?a_().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await fy(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(t){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Rc(this.app,{lastSentHeartbeatDate:(n=t.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Rc(this.app,{lastSentHeartbeatDate:(n=t.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...t.heartbeats]})}else return}}function Cc(e){return Zs(JSON.stringify({version:2,heartbeats:e})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yy(e){ei(new qr("platform-logger",t=>new V_(t),"PRIVATE")),ei(new qr("heartbeat",t=>new gy(t),"PRIVATE")),qn(qo,Ac,e),qn(qo,Ac,"esm2017"),qn("fire-js","")}yy("");var Ey=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},S,qa=qa||{},$=Ey||self;function Si(e){var t=typeof e;return t=t!="object"?t:e?Array.isArray(e)?"array":t:"null",t=="array"||t=="object"&&typeof e.length=="number"}function as(e){var t=typeof e;return t=="object"&&e!=null||t=="function"}function vy(e){return Object.prototype.hasOwnProperty.call(e,go)&&e[go]||(e[go]=++Ty)}var go="closure_uid_"+(1e9*Math.random()>>>0),Ty=0;function wy(e,t,n){return e.call.apply(e.bind,arguments)}function Iy(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var s=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(s,r),e.apply(t,s)}}return function(){return e.apply(t,arguments)}}function Ht(e,t,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?Ht=wy:Ht=Iy,Ht.apply(null,arguments)}function Vs(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),e.apply(this,r)}}function Dt(e,t){function n(){}n.prototype=t.prototype,e.$=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.ac=function(r,s,i){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return t.prototype[s].apply(r,o)}}function sn(){this.s=this.s,this.o=this.o}var Ay=0;sn.prototype.s=!1;sn.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),Ay!=0)&&vy(this)};sn.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const Dh=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if(typeof e=="string")return typeof t!="string"||t.length!=1?-1:e.indexOf(t,0);for(let n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1};function Ha(e){const t=e.length;if(0<t){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function Sc(e,t){for(let n=1;n<arguments.length;n++){const r=arguments[n];if(Si(r)){const s=e.length||0,i=r.length||0;e.length=s+i;for(let o=0;o<i;o++)e[s+o]=r[o]}else e.push(r)}}function zt(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}zt.prototype.h=function(){this.defaultPrevented=!0};var Ry=function(){if(!$.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{$.addEventListener("test",()=>{},t),$.removeEventListener("test",()=>{},t)}catch{}return e}();function zr(e){return/^[\s\xa0]*$/.test(e)}function bi(){var e=$.navigator;return e&&(e=e.userAgent)?e:""}function ve(e){return bi().indexOf(e)!=-1}function za(e){return za[" "](e),e}za[" "]=function(){};function Py(e,t){var n=yE;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}var Cy=ve("Opera"),Jn=ve("Trident")||ve("MSIE"),xh=ve("Edge"),Ko=xh||Jn,kh=ve("Gecko")&&!(bi().toLowerCase().indexOf("webkit")!=-1&&!ve("Edge"))&&!(ve("Trident")||ve("MSIE"))&&!ve("Edge"),Sy=bi().toLowerCase().indexOf("webkit")!=-1&&!ve("Edge");function Nh(){var e=$.document;return e?e.documentMode:void 0}var Wo;t:{var mo="",_o=function(){var e=bi();if(kh)return/rv:([^\);]+)(\)|;)/.exec(e);if(xh)return/Edge\/([\d\.]+)/.exec(e);if(Jn)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(e);if(Sy)return/WebKit\/(\S+)/.exec(e);if(Cy)return/(?:Version)[ \/]?(\S+)/.exec(e)}();if(_o&&(mo=_o?_o[1]:""),Jn){var yo=Nh();if(yo!=null&&yo>parseFloat(mo)){Wo=String(yo);break t}}Wo=mo}var Qo;if($.document&&Jn){var bc=Nh();Qo=bc||parseInt(Wo,10)||void 0}else Qo=void 0;var by=Qo;function Kr(e,t){if(zt.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(kh){t:{try{za(t.nodeName);var s=!0;break t}catch{}s=!1}s||(t=null)}}else n=="mouseover"?t=e.fromElement:n=="mouseout"&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=e.clientX!==void 0?e.clientX:e.pageX,this.clientY=e.clientY!==void 0?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType=typeof e.pointerType=="string"?e.pointerType:Vy[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&Kr.$.h.call(this)}}Dt(Kr,zt);var Vy={2:"touch",3:"pen",4:"mouse"};Kr.prototype.h=function(){Kr.$.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var ls="closure_listenable_"+(1e6*Math.random()|0),Dy=0;function xy(e,t,n,r,s){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.la=s,this.key=++Dy,this.fa=this.ia=!1}function Vi(e){e.fa=!0,e.listener=null,e.proxy=null,e.src=null,e.la=null}function Ka(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function ky(e,t){for(const n in e)t.call(void 0,e[n],n,e)}function Mh(e){const t={};for(const n in e)t[n]=e[n];return t}const Vc="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Oh(e,t){let n,r;for(let s=1;s<arguments.length;s++){r=arguments[s];for(n in r)e[n]=r[n];for(let i=0;i<Vc.length;i++)n=Vc[i],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function Di(e){this.src=e,this.g={},this.h=0}Di.prototype.add=function(e,t,n,r,s){var i=e.toString();e=this.g[i],e||(e=this.g[i]=[],this.h++);var o=Xo(e,t,r,s);return-1<o?(t=e[o],n||(t.ia=!1)):(t=new xy(t,this.src,i,!!r,s),t.ia=n,e.push(t)),t};function Go(e,t){var n=t.type;if(n in e.g){var r=e.g[n],s=Dh(r,t),i;(i=0<=s)&&Array.prototype.splice.call(r,s,1),i&&(Vi(t),e.g[n].length==0&&(delete e.g[n],e.h--))}}function Xo(e,t,n,r){for(var s=0;s<e.length;++s){var i=e[s];if(!i.fa&&i.listener==t&&i.capture==!!n&&i.la==r)return s}return-1}var Wa="closure_lm_"+(1e6*Math.random()|0),Eo={};function Fh(e,t,n,r,s){if(r&&r.once)return Bh(e,t,n,r,s);if(Array.isArray(t)){for(var i=0;i<t.length;i++)Fh(e,t[i],n,r,s);return null}return n=Xa(n),e&&e[ls]?e.O(t,n,as(r)?!!r.capture:!!r,s):Lh(e,t,n,!1,r,s)}function Lh(e,t,n,r,s,i){if(!t)throw Error("Invalid event type");var o=as(s)?!!s.capture:!!s,a=Ga(e);if(a||(e[Wa]=a=new Di(e)),n=a.add(t,n,r,o,i),n.proxy)return n;if(r=Ny(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)Ry||(s=o),s===void 0&&(s=!1),e.addEventListener(t.toString(),r,s);else if(e.attachEvent)e.attachEvent($h(t.toString()),r);else if(e.addListener&&e.removeListener)e.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function Ny(){function e(n){return t.call(e.src,e.listener,n)}const t=My;return e}function Bh(e,t,n,r,s){if(Array.isArray(t)){for(var i=0;i<t.length;i++)Bh(e,t[i],n,r,s);return null}return n=Xa(n),e&&e[ls]?e.P(t,n,as(r)?!!r.capture:!!r,s):Lh(e,t,n,!0,r,s)}function Uh(e,t,n,r,s){if(Array.isArray(t))for(var i=0;i<t.length;i++)Uh(e,t[i],n,r,s);else r=as(r)?!!r.capture:!!r,n=Xa(n),e&&e[ls]?(e=e.i,t=String(t).toString(),t in e.g&&(i=e.g[t],n=Xo(i,n,r,s),-1<n&&(Vi(i[n]),Array.prototype.splice.call(i,n,1),i.length==0&&(delete e.g[t],e.h--)))):e&&(e=Ga(e))&&(t=e.g[t.toString()],e=-1,t&&(e=Xo(t,n,r,s)),(n=-1<e?t[e]:null)&&Qa(n))}function Qa(e){if(typeof e!="number"&&e&&!e.fa){var t=e.src;if(t&&t[ls])Go(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent($h(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=Ga(t))?(Go(n,e),n.h==0&&(n.src=null,t[Wa]=null)):Vi(e)}}}function $h(e){return e in Eo?Eo[e]:Eo[e]="on"+e}function My(e,t){if(e.fa)e=!0;else{t=new Kr(t,this);var n=e.listener,r=e.la||e.src;e.ia&&Qa(e),e=n.call(r,t)}return e}function Ga(e){return e=e[Wa],e instanceof Di?e:null}var vo="__closure_events_fn_"+(1e9*Math.random()>>>0);function Xa(e){return typeof e=="function"?e:(e[vo]||(e[vo]=function(t){return e.handleEvent(t)}),e[vo])}function Vt(){sn.call(this),this.i=new Di(this),this.S=this,this.J=null}Dt(Vt,sn);Vt.prototype[ls]=!0;Vt.prototype.removeEventListener=function(e,t,n,r){Uh(this,e,t,n,r)};function Ot(e,t){var n,r=e.J;if(r)for(n=[];r;r=r.J)n.push(r);if(e=e.S,r=t.type||t,typeof t=="string")t=new zt(t,e);else if(t instanceof zt)t.target=t.target||e;else{var s=t;t=new zt(r,e),Oh(t,s)}if(s=!0,n)for(var i=n.length-1;0<=i;i--){var o=t.g=n[i];s=Ds(o,r,!0,t)&&s}if(o=t.g=e,s=Ds(o,r,!0,t)&&s,s=Ds(o,r,!1,t)&&s,n)for(i=0;i<n.length;i++)o=t.g=n[i],s=Ds(o,r,!1,t)&&s}Vt.prototype.N=function(){if(Vt.$.N.call(this),this.i){var e=this.i,t;for(t in e.g){for(var n=e.g[t],r=0;r<n.length;r++)Vi(n[r]);delete e.g[t],e.h--}}this.J=null};Vt.prototype.O=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)};Vt.prototype.P=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};function Ds(e,t,n,r){if(t=e.i.g[String(t)],!t)return!0;t=t.concat();for(var s=!0,i=0;i<t.length;++i){var o=t[i];if(o&&!o.fa&&o.capture==n){var a=o.listener,l=o.la||o.src;o.ia&&Go(e.i,o),s=a.call(l,r)!==!1&&s}}return s&&!r.defaultPrevented}var Ya=$.JSON.stringify;class Oy{constructor(t,n){this.i=t,this.j=n,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}function Fy(){var e=Ja;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}class Ly{constructor(){this.h=this.g=null}add(t,n){const r=jh.get();r.set(t,n),this.h?this.h.next=r:this.g=r,this.h=r}}var jh=new Oy(()=>new By,e=>e.reset());class By{constructor(){this.next=this.g=this.h=null}set(t,n){this.h=t,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}}function Uy(e){var t=1;e=e.split(":");const n=[];for(;0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function $y(e){$.setTimeout(()=>{throw e},0)}let Wr,Qr=!1,Ja=new Ly,qh=()=>{const e=$.Promise.resolve(void 0);Wr=()=>{e.then(jy)}};var jy=()=>{for(var e;e=Fy();){try{e.h.call(e.g)}catch(n){$y(n)}var t=jh;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}Qr=!1};function xi(e,t){Vt.call(this),this.h=e||1,this.g=t||$,this.j=Ht(this.qb,this),this.l=Date.now()}Dt(xi,Vt);S=xi.prototype;S.ga=!1;S.T=null;S.qb=function(){if(this.ga){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-e):(this.T&&(this.g.clearTimeout(this.T),this.T=null),Ot(this,"tick"),this.ga&&(Za(this),this.start()))}};S.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function Za(e){e.ga=!1,e.T&&(e.g.clearTimeout(e.T),e.T=null)}S.N=function(){xi.$.N.call(this),Za(this),delete this.g};function tl(e,t,n){if(typeof e=="function")n&&(e=Ht(e,n));else if(e&&typeof e.handleEvent=="function")e=Ht(e.handleEvent,e);else throw Error("Invalid listener argument");return 2147483647<Number(t)?-1:$.setTimeout(e,t||0)}function Hh(e){e.g=tl(()=>{e.g=null,e.i&&(e.i=!1,Hh(e))},e.j);const t=e.h;e.h=null,e.m.apply(null,t)}class qy extends sn{constructor(t,n){super(),this.m=t,this.j=n,this.h=null,this.i=!1,this.g=null}l(t){this.h=arguments,this.g?this.i=!0:Hh(this)}N(){super.N(),this.g&&($.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Gr(e){sn.call(this),this.h=e,this.g={}}Dt(Gr,sn);var Dc=[];function zh(e,t,n,r){Array.isArray(n)||(n&&(Dc[0]=n.toString()),n=Dc);for(var s=0;s<n.length;s++){var i=Fh(t,n[s],r||e.handleEvent,!1,e.h||e);if(!i)break;e.g[i.key]=i}}function Kh(e){Ka(e.g,function(t,n){this.g.hasOwnProperty(n)&&Qa(t)},e),e.g={}}Gr.prototype.N=function(){Gr.$.N.call(this),Kh(this)};Gr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function ki(){this.g=!0}ki.prototype.Ea=function(){this.g=!1};function Hy(e,t,n,r,s,i){e.info(function(){if(e.g)if(i)for(var o="",a=i.split("&"),l=0;l<a.length;l++){var c=a[l].split("=");if(1<c.length){var u=c[0];c=c[1];var h=u.split("_");o=2<=h.length&&h[1]=="type"?o+(u+"="+c+"&"):o+(u+"=redacted&")}}else o=null;else o=i;return"XMLHTTP REQ ("+r+") [attempt "+s+"]: "+t+`
`+n+`
`+o})}function zy(e,t,n,r,s,i,o){e.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+s+"]: "+t+`
`+n+`
`+i+" "+o})}function On(e,t,n,r){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+Wy(e,n)+(r?" "+r:"")})}function Ky(e,t){e.info(function(){return"TIMEOUT: "+t})}ki.prototype.info=function(){};function Wy(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n){for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var s=r[1];if(Array.isArray(s)&&!(1>s.length)){var i=s[0];if(i!="noop"&&i!="stop"&&i!="close")for(var o=1;o<s.length;o++)s[o]=""}}}}return Ya(n)}catch{return t}}var Cn={},xc=null;function Ni(){return xc=xc||new Vt}Cn.Ta="serverreachability";function Wh(e){zt.call(this,Cn.Ta,e)}Dt(Wh,zt);function Xr(e){const t=Ni();Ot(t,new Wh(t))}Cn.STAT_EVENT="statevent";function Qh(e,t){zt.call(this,Cn.STAT_EVENT,e),this.stat=t}Dt(Qh,zt);function Gt(e){const t=Ni();Ot(t,new Qh(t,e))}Cn.Ua="timingevent";function Gh(e,t){zt.call(this,Cn.Ua,e),this.size=t}Dt(Gh,zt);function cs(e,t){if(typeof e!="function")throw Error("Fn must not be null and must be a function");return $.setTimeout(function(){e()},t)}var Mi={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},Xh={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function el(){}el.prototype.h=null;function kc(e){return e.h||(e.h=e.i())}function Yh(){}var us={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function nl(){zt.call(this,"d")}Dt(nl,zt);function rl(){zt.call(this,"c")}Dt(rl,zt);var Yo;function Oi(){}Dt(Oi,el);Oi.prototype.g=function(){return new XMLHttpRequest};Oi.prototype.i=function(){return{}};Yo=new Oi;function hs(e,t,n,r){this.l=e,this.j=t,this.m=n,this.W=r||1,this.U=new Gr(this),this.P=Qy,e=Ko?125:void 0,this.V=new xi(e),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new Jh}function Jh(){this.i=null,this.g="",this.h=!1}var Qy=45e3,Jo={},ni={};S=hs.prototype;S.setTimeout=function(e){this.P=e};function Zo(e,t,n){e.L=1,e.v=Li(Oe(t)),e.s=n,e.S=!0,Zh(e,null)}function Zh(e,t){e.G=Date.now(),fs(e),e.A=Oe(e.v);var n=e.A,r=e.W;Array.isArray(r)||(r=[String(r)]),lf(n.i,"t",r),e.C=0,n=e.l.J,e.h=new Jh,e.g=bf(e.l,n?t:null,!e.s),0<e.O&&(e.M=new qy(Ht(e.Pa,e,e.g),e.O)),zh(e.U,e.g,"readystatechange",e.nb),t=e.I?Mh(e.I):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ha(e.A,e.u,e.s,t)):(e.u="GET",e.g.ha(e.A,e.u,null,t)),Xr(),Hy(e.j,e.u,e.A,e.m,e.W,e.s)}S.nb=function(e){e=e.target;const t=this.M;t&&Te(e)==3?t.l():this.Pa(e)};S.Pa=function(e){try{if(e==this.g)t:{const u=Te(this.g);var t=this.g.Ia();const h=this.g.da();if(!(3>u)&&(u!=3||Ko||this.g&&(this.h.h||this.g.ja()||Fc(this.g)))){this.J||u!=4||t==7||(t==8||0>=h?Xr(3):Xr(2)),Fi(this);var n=this.g.da();this.ca=n;e:if(tf(this)){var r=Fc(this.g);e="";var s=r.length,i=Te(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){_n(this),Vr(this);var o="";break e}this.h.i=new $.TextDecoder}for(t=0;t<s;t++)this.h.h=!0,e+=this.h.i.decode(r[t],{stream:i&&t==s-1});r.splice(0,s),this.h.g+=e,this.C=0,o=this.h.g}else o=this.g.ja();if(this.i=n==200,zy(this.j,this.u,this.A,this.m,this.W,u,n),this.i){if(this.aa&&!this.K){e:{if(this.g){var a,l=this.g;if((a=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!zr(a)){var c=a;break e}}c=null}if(n=c)On(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,ta(this,n);else{this.i=!1,this.o=3,Gt(12),_n(this),Vr(this);break t}}this.S?(ef(this,u,o),Ko&&this.i&&u==3&&(zh(this.U,this.V,"tick",this.mb),this.V.start())):(On(this.j,this.m,o,null),ta(this,o)),u==4&&_n(this),this.i&&!this.J&&(u==4?Rf(this.l,this):(this.i=!1,fs(this)))}else gE(this.g),n==400&&0<o.indexOf("Unknown SID")?(this.o=3,Gt(12)):(this.o=0,Gt(13)),_n(this),Vr(this)}}}catch{}finally{}};function tf(e){return e.g?e.u=="GET"&&e.L!=2&&e.l.Ha:!1}function ef(e,t,n){let r=!0,s;for(;!e.J&&e.C<n.length;)if(s=Gy(e,n),s==ni){t==4&&(e.o=4,Gt(14),r=!1),On(e.j,e.m,null,"[Incomplete Response]");break}else if(s==Jo){e.o=4,Gt(15),On(e.j,e.m,n,"[Invalid Chunk]"),r=!1;break}else On(e.j,e.m,s,null),ta(e,s);tf(e)&&s!=ni&&s!=Jo&&(e.h.g="",e.C=0),t!=4||n.length!=0||e.h.h||(e.o=1,Gt(16),r=!1),e.i=e.i&&r,r?0<n.length&&!e.ba&&(e.ba=!0,t=e.l,t.g==e&&t.ca&&!t.M&&(t.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),cl(t),t.M=!0,Gt(11))):(On(e.j,e.m,n,"[Invalid Chunked Response]"),_n(e),Vr(e))}S.mb=function(){if(this.g){var e=Te(this.g),t=this.g.ja();this.C<t.length&&(Fi(this),ef(this,e,t),this.i&&e!=4&&fs(this))}};function Gy(e,t){var n=e.C,r=t.indexOf(`
`,n);return r==-1?ni:(n=Number(t.substring(n,r)),isNaN(n)?Jo:(r+=1,r+n>t.length?ni:(t=t.slice(r,r+n),e.C=r+n,t)))}S.cancel=function(){this.J=!0,_n(this)};function fs(e){e.Y=Date.now()+e.P,nf(e,e.P)}function nf(e,t){if(e.B!=null)throw Error("WatchDog timer not null");e.B=cs(Ht(e.lb,e),t)}function Fi(e){e.B&&($.clearTimeout(e.B),e.B=null)}S.lb=function(){this.B=null;const e=Date.now();0<=e-this.Y?(Ky(this.j,this.A),this.L!=2&&(Xr(),Gt(17)),_n(this),this.o=2,Vr(this)):nf(this,this.Y-e)};function Vr(e){e.l.H==0||e.J||Rf(e.l,e)}function _n(e){Fi(e);var t=e.M;t&&typeof t.sa=="function"&&t.sa(),e.M=null,Za(e.V),Kh(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.sa())}function ta(e,t){try{var n=e.l;if(n.H!=0&&(n.g==e||ea(n.i,e))){if(!e.K&&ea(n.i,e)&&n.H==3){try{var r=n.Ja.g.parse(t)}catch{r=null}if(Array.isArray(r)&&r.length==3){var s=r;if(s[0]==0){t:if(!n.u){if(n.g)if(n.g.G+3e3<e.G)ii(n),$i(n);else break t;ll(n),Gt(18)}}else n.Fa=s[1],0<n.Fa-n.V&&37500>s[2]&&n.G&&n.A==0&&!n.v&&(n.v=cs(Ht(n.ib,n),6e3));if(1>=hf(n.i)&&n.oa){try{n.oa()}catch{}n.oa=void 0}}else yn(n,11)}else if((e.K||n.g==e)&&ii(n),!zr(t))for(s=n.Ja.g.parse(t),t=0;t<s.length;t++){let c=s[t];if(n.V=c[0],c=c[1],n.H==2)if(c[0]=="c"){n.K=c[1],n.pa=c[2];const u=c[3];u!=null&&(n.ra=u,n.l.info("VER="+n.ra));const h=c[4];h!=null&&(n.Ga=h,n.l.info("SVER="+n.Ga));const d=c[5];d!=null&&typeof d=="number"&&0<d&&(r=1.5*d,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;const g=e.g;if(g){const P=g.g?g.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(P){var i=r.i;i.g||P.indexOf("spdy")==-1&&P.indexOf("quic")==-1&&P.indexOf("h2")==-1||(i.j=i.l,i.g=new Set,i.h&&(sl(i,i.h),i.h=null))}if(r.F){const I=g.g?g.g.getResponseHeader("X-HTTP-Session-Id"):null;I&&(r.Da=I,ht(r.I,r.F,I))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-e.G,n.l.info("Handshake RTT: "+n.S+"ms")),r=n;var o=e;if(r.wa=Sf(r,r.J?r.pa:null,r.Y),o.K){ff(r.i,o);var a=o,l=r.L;l&&a.setTimeout(l),a.B&&(Fi(a),fs(a)),r.g=o}else If(r);0<n.j.length&&ji(n)}else c[0]!="stop"&&c[0]!="close"||yn(n,7);else n.H==3&&(c[0]=="stop"||c[0]=="close"?c[0]=="stop"?yn(n,7):al(n):c[0]!="noop"&&n.h&&n.h.Aa(c),n.A=0)}}Xr(4)}catch{}}function Xy(e){if(e.Z&&typeof e.Z=="function")return e.Z();if(typeof Map<"u"&&e instanceof Map||typeof Set<"u"&&e instanceof Set)return Array.from(e.values());if(typeof e=="string")return e.split("");if(Si(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}t=[],n=0;for(r in e)t[n++]=e[r];return t}function Yy(e){if(e.ta&&typeof e.ta=="function")return e.ta();if(!e.Z||typeof e.Z!="function"){if(typeof Map<"u"&&e instanceof Map)return Array.from(e.keys());if(!(typeof Set<"u"&&e instanceof Set)){if(Si(e)||typeof e=="string"){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const r in e)t[n++]=r;return t}}}function rf(e,t){if(e.forEach&&typeof e.forEach=="function")e.forEach(t,void 0);else if(Si(e)||typeof e=="string")Array.prototype.forEach.call(e,t,void 0);else for(var n=Yy(e),r=Xy(e),s=r.length,i=0;i<s;i++)t.call(void 0,r[i],n&&n[i],e)}var sf=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Jy(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),s=null;if(0<=r){var i=e[n].substring(0,r);s=e[n].substring(r+1)}else i=e[n];t(i,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}function Tn(e){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,e instanceof Tn){this.h=e.h,ri(this,e.j),this.s=e.s,this.g=e.g,si(this,e.m),this.l=e.l;var t=e.i,n=new Yr;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),Nc(this,n),this.o=e.o}else e&&(t=String(e).match(sf))?(this.h=!1,ri(this,t[1]||"",!0),this.s=Ir(t[2]||""),this.g=Ir(t[3]||"",!0),si(this,t[4]),this.l=Ir(t[5]||"",!0),Nc(this,t[6]||"",!0),this.o=Ir(t[7]||"")):(this.h=!1,this.i=new Yr(null,this.h))}Tn.prototype.toString=function(){var e=[],t=this.j;t&&e.push(Ar(t,Mc,!0),":");var n=this.g;return(n||t=="file")&&(e.push("//"),(t=this.s)&&e.push(Ar(t,Mc,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&e.push(":",String(n))),(n=this.l)&&(this.g&&n.charAt(0)!="/"&&e.push("/"),e.push(Ar(n,n.charAt(0)=="/"?eE:tE,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.o)&&e.push("#",Ar(n,rE)),e.join("")};function Oe(e){return new Tn(e)}function ri(e,t,n){e.j=n?Ir(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function si(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function Nc(e,t,n){t instanceof Yr?(e.i=t,sE(e.i,e.h)):(n||(t=Ar(t,nE)),e.i=new Yr(t,e.h))}function ht(e,t,n){e.i.set(t,n)}function Li(e){return ht(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function Ir(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function Ar(e,t,n){return typeof e=="string"?(e=encodeURI(e).replace(t,Zy),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function Zy(e){return e=e.charCodeAt(0),"%"+(e>>4&15).toString(16)+(e&15).toString(16)}var Mc=/[#\/\?@]/g,tE=/[#\?:]/g,eE=/[#\?]/g,nE=/[#\?@]/g,rE=/#/g;function Yr(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function on(e){e.g||(e.g=new Map,e.h=0,e.i&&Jy(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}S=Yr.prototype;S.add=function(e,t){on(this),this.i=null,e=ur(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this};function of(e,t){on(e),t=ur(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function af(e,t){return on(e),t=ur(e,t),e.g.has(t)}S.forEach=function(e,t){on(this),this.g.forEach(function(n,r){n.forEach(function(s){e.call(t,s,r,this)},this)},this)};S.ta=function(){on(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let r=0;r<t.length;r++){const s=e[r];for(let i=0;i<s.length;i++)n.push(t[r])}return n};S.Z=function(e){on(this);let t=[];if(typeof e=="string")af(this,e)&&(t=t.concat(this.g.get(ur(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t};S.set=function(e,t){return on(this),this.i=null,e=ur(this,e),af(this,e)&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this};S.get=function(e,t){return e?(e=this.Z(e),0<e.length?String(e[0]):t):t};function lf(e,t,n){of(e,t),0<n.length&&(e.i=null,e.g.set(ur(e,t),Ha(n)),e.h+=n.length)}S.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var r=t[n];const i=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var s=i;o[r]!==""&&(s+="="+encodeURIComponent(String(o[r]))),e.push(s)}}return this.i=e.join("&")};function ur(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function sE(e,t){t&&!e.j&&(on(e),e.i=null,e.g.forEach(function(n,r){var s=r.toLowerCase();r!=s&&(of(this,r),lf(this,s,n))},e)),e.j=t}var iE=class{constructor(e,t){this.g=e,this.map=t}};function cf(e){this.l=e||oE,$.PerformanceNavigationTiming?(e=$.performance.getEntriesByType("navigation"),e=0<e.length&&(e[0].nextHopProtocol=="hq"||e[0].nextHopProtocol=="h2")):e=!!($.g&&$.g.Ka&&$.g.Ka()&&$.g.Ka().ec),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var oE=10;function uf(e){return e.h?!0:e.g?e.g.size>=e.j:!1}function hf(e){return e.h?1:e.g?e.g.size:0}function ea(e,t){return e.h?e.h==t:e.g?e.g.has(t):!1}function sl(e,t){e.g?e.g.add(t):e.h=t}function ff(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}cf.prototype.cancel=function(){if(this.i=df(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const e of this.g.values())e.cancel();this.g.clear()}};function df(e){if(e.h!=null)return e.i.concat(e.h.F);if(e.g!=null&&e.g.size!==0){let t=e.i;for(const n of e.g.values())t=t.concat(n.F);return t}return Ha(e.i)}var aE=class{stringify(e){return $.JSON.stringify(e,void 0)}parse(e){return $.JSON.parse(e,void 0)}};function lE(){this.g=new aE}function cE(e,t,n){const r=n||"";try{rf(e,function(s,i){let o=s;as(s)&&(o=Ya(s)),t.push(r+i+"="+encodeURIComponent(o))})}catch(s){throw t.push(r+"type="+encodeURIComponent("_badmap")),s}}function uE(e,t){const n=new ki;if($.Image){const r=new Image;r.onload=Vs(xs,n,r,"TestLoadImage: loaded",!0,t),r.onerror=Vs(xs,n,r,"TestLoadImage: error",!1,t),r.onabort=Vs(xs,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=Vs(xs,n,r,"TestLoadImage: timeout",!1,t),$.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=e}else t(!1)}function xs(e,t,n,r,s){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,s(r)}catch{}}function ds(e){this.l=e.fc||null,this.j=e.ob||!1}Dt(ds,el);ds.prototype.g=function(){return new Bi(this.l,this.j)};ds.prototype.i=function(e){return function(){return e}}({});function Bi(e,t){Vt.call(this),this.F=e,this.u=t,this.m=void 0,this.readyState=il,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Dt(Bi,Vt);var il=0;S=Bi.prototype;S.open=function(e,t){if(this.readyState!=il)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,Jr(this)};S.send=function(e){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.F||$).fetch(new Request(this.B,t)).then(this.$a.bind(this),this.ka.bind(this))};S.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,ps(this)),this.readyState=il};S.$a=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Jr(this)),this.g&&(this.readyState=3,Jr(this),this.g)))if(this.responseType==="arraybuffer")e.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof $.ReadableStream<"u"&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;pf(this)}else e.text().then(this.Za.bind(this),this.ka.bind(this))};function pf(e){e.j.read().then(e.Xa.bind(e)).catch(e.ka.bind(e))}S.Xa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?ps(this):Jr(this),this.readyState==3&&pf(this)}};S.Za=function(e){this.g&&(this.response=this.responseText=e,ps(this))};S.Ya=function(e){this.g&&(this.response=e,ps(this))};S.ka=function(){this.g&&ps(this)};function ps(e){e.readyState=4,e.l=null,e.j=null,e.A=null,Jr(e)}S.setRequestHeader=function(e,t){this.v.append(e,t)};S.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""};S.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join(`\r
`)};function Jr(e){e.onreadystatechange&&e.onreadystatechange.call(e)}Object.defineProperty(Bi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(e){this.m=e?"include":"same-origin"}});var hE=$.JSON.parse;function mt(e){Vt.call(this),this.headers=new Map,this.u=e||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=gf,this.L=this.M=!1}Dt(mt,Vt);var gf="",fE=/^https?$/i,dE=["POST","PUT"];S=mt.prototype;S.Oa=function(e){this.M=e};S.ha=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+e);t=t?t.toUpperCase():"GET",this.I=e,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():Yo.g(),this.C=this.u?kc(this.u):kc(Yo),this.g.onreadystatechange=Ht(this.La,this);try{this.G=!0,this.g.open(t,String(e),!0),this.G=!1}catch(i){Oc(this,i);return}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var s in r)n.set(s,r[s]);else if(typeof r.keys=="function"&&typeof r.get=="function")for(const i of r.keys())n.set(i,r.get(i));else throw Error("Unknown input type for opt_headers: "+String(r));r=Array.from(n.keys()).find(i=>i.toLowerCase()=="content-type"),s=$.FormData&&e instanceof $.FormData,!(0<=Dh(dE,t))||r||s||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[i,o]of n)this.g.setRequestHeader(i,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{yf(this),0<this.B&&((this.L=pE(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Ht(this.ua,this)):this.A=tl(this.ua,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(i){Oc(this,i)}};function pE(e){return Jn&&typeof e.timeout=="number"&&e.ontimeout!==void 0}S.ua=function(){typeof qa<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Ot(this,"timeout"),this.abort(8))};function Oc(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,mf(e),Ui(e)}function mf(e){e.F||(e.F=!0,Ot(e,"complete"),Ot(e,"error"))}S.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,Ot(this,"complete"),Ot(this,"abort"),Ui(this))};S.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Ui(this,!0)),mt.$.N.call(this)};S.La=function(){this.s||(this.G||this.v||this.l?_f(this):this.kb())};S.kb=function(){_f(this)};function _f(e){if(e.h&&typeof qa<"u"&&(!e.C[1]||Te(e)!=4||e.da()!=2)){if(e.v&&Te(e)==4)tl(e.La,0,e);else if(Ot(e,"readystatechange"),Te(e)==4){e.h=!1;try{const o=e.da();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break t;default:t=!1}var n;if(!(n=t)){var r;if(r=o===0){var s=String(e.I).match(sf)[1]||null;!s&&$.self&&$.self.location&&(s=$.self.location.protocol.slice(0,-1)),r=!fE.test(s?s.toLowerCase():"")}n=r}if(n)Ot(e,"complete"),Ot(e,"success");else{e.m=6;try{var i=2<Te(e)?e.g.statusText:""}catch{i=""}e.j=i+" ["+e.da()+"]",mf(e)}}finally{Ui(e)}}}}function Ui(e,t){if(e.g){yf(e);const n=e.g,r=e.C[0]?()=>{}:null;e.g=null,e.C=null,t||Ot(e,"ready");try{n.onreadystatechange=r}catch{}}}function yf(e){e.g&&e.L&&(e.g.ontimeout=null),e.A&&($.clearTimeout(e.A),e.A=null)}S.isActive=function(){return!!this.g};function Te(e){return e.g?e.g.readyState:0}S.da=function(){try{return 2<Te(this)?this.g.status:-1}catch{return-1}};S.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};S.Wa=function(e){if(this.g){var t=this.g.responseText;return e&&t.indexOf(e)==0&&(t=t.substring(e.length)),hE(t)}};function Fc(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.K){case gf:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch{return null}}function gE(e){const t={};e=(e.g&&2<=Te(e)&&e.g.getAllResponseHeaders()||"").split(`\r
`);for(let r=0;r<e.length;r++){if(zr(e[r]))continue;var n=Uy(e[r]);const s=n[0];if(n=n[1],typeof n!="string")continue;n=n.trim();const i=t[s]||[];t[s]=i,i.push(n)}ky(t,function(r){return r.join(", ")})}S.Ia=function(){return this.m};S.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function Ef(e){let t="";return Ka(e,function(n,r){t+=r,t+=":",t+=n,t+=`\r
`}),t}function ol(e,t,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=Ef(n),typeof e=="string"?n!=null&&encodeURIComponent(String(n)):ht(e,t,n))}function Er(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function vf(e){this.Ga=0,this.j=[],this.l=new ki,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Er("failFast",!1,e),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Er("baseRetryDelayMs",5e3,e),this.hb=Er("retryDelaySeedMs",1e4,e),this.eb=Er("forwardChannelMaxRetries",2,e),this.xa=Er("forwardChannelRequestTimeoutMs",2e4,e),this.va=e&&e.xmlHttpFactory||void 0,this.Ha=e&&e.dc||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.i=new cf(e&&e.concurrentRequestLimit),this.Ja=new lE,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=e&&e.bc||!1,e&&e.Ea&&this.l.Ea(),e&&e.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&e&&e.detectBufferingProxy||!1,this.qa=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.qa=e.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}S=vf.prototype;S.ra=8;S.H=1;function al(e){if(Tf(e),e.H==3){var t=e.W++,n=Oe(e.I);if(ht(n,"SID",e.K),ht(n,"RID",t),ht(n,"TYPE","terminate"),gs(e,n),t=new hs(e,e.l,t),t.L=2,t.v=Li(Oe(n)),n=!1,$.navigator&&$.navigator.sendBeacon)try{n=$.navigator.sendBeacon(t.v.toString(),"")}catch{}!n&&$.Image&&(new Image().src=t.v,n=!0),n||(t.g=bf(t.l,null),t.g.ha(t.v)),t.G=Date.now(),fs(t)}Cf(e)}function $i(e){e.g&&(cl(e),e.g.cancel(),e.g=null)}function Tf(e){$i(e),e.u&&($.clearTimeout(e.u),e.u=null),ii(e),e.i.cancel(),e.m&&(typeof e.m=="number"&&$.clearTimeout(e.m),e.m=null)}function ji(e){if(!uf(e.i)&&!e.m){e.m=!0;var t=e.Na;Wr||qh(),Qr||(Wr(),Qr=!0),Ja.add(t,e),e.C=0}}function mE(e,t){return hf(e.i)>=e.i.j-(e.m?1:0)?!1:e.m?(e.j=t.F.concat(e.j),!0):e.H==1||e.H==2||e.C>=(e.cb?0:e.eb)?!1:(e.m=cs(Ht(e.Na,e,t),Pf(e,e.C)),e.C++,!0)}S.Na=function(e){if(this.m)if(this.m=null,this.H==1){if(!e){this.W=Math.floor(1e5*Math.random()),e=this.W++;const s=new hs(this,this.l,e);let i=this.s;if(this.U&&(i?(i=Mh(i),Oh(i,this.U)):i=this.U),this.o!==null||this.O||(s.I=i,i=null),this.P)t:{for(var t=0,n=0;n<this.j.length;n++){e:{var r=this.j[n];if("__data__"in r.map&&(r=r.map.__data__,typeof r=="string")){r=r.length;break e}r=void 0}if(r===void 0)break;if(t+=r,4096<t){t=n;break t}if(t===4096||n===this.j.length-1){t=n+1;break t}}t=1e3}else t=1e3;t=wf(this,s,t),n=Oe(this.I),ht(n,"RID",e),ht(n,"CVER",22),this.F&&ht(n,"X-HTTP-Session-Id",this.F),gs(this,n),i&&(this.O?t="headers="+encodeURIComponent(String(Ef(i)))+"&"+t:this.o&&ol(n,this.o,i)),sl(this.i,s),this.bb&&ht(n,"TYPE","init"),this.P?(ht(n,"$req",t),ht(n,"SID","null"),s.aa=!0,Zo(s,n,null)):Zo(s,n,t),this.H=2}}else this.H==3&&(e?Lc(this,e):this.j.length==0||uf(this.i)||Lc(this))};function Lc(e,t){var n;t?n=t.m:n=e.W++;const r=Oe(e.I);ht(r,"SID",e.K),ht(r,"RID",n),ht(r,"AID",e.V),gs(e,r),e.o&&e.s&&ol(r,e.o,e.s),n=new hs(e,e.l,n,e.C+1),e.o===null&&(n.I=e.s),t&&(e.j=t.F.concat(e.j)),t=wf(e,n,1e3),n.setTimeout(Math.round(.5*e.xa)+Math.round(.5*e.xa*Math.random())),sl(e.i,n),Zo(n,r,t)}function gs(e,t){e.na&&Ka(e.na,function(n,r){ht(t,r,n)}),e.h&&rf({},function(n,r){ht(t,r,n)})}function wf(e,t,n){n=Math.min(e.j.length,n);var r=e.h?Ht(e.h.Va,e.h,e):null;t:{var s=e.j;let i=-1;for(;;){const o=["count="+n];i==-1?0<n?(i=s[0].g,o.push("ofs="+i)):i=0:o.push("ofs="+i);let a=!0;for(let l=0;l<n;l++){let c=s[l].g;const u=s[l].map;if(c-=i,0>c)i=Math.max(0,s[l].g-100),a=!1;else try{cE(u,o,"req"+c+"_")}catch{r&&r(u)}}if(a){r=o.join("&");break t}}}return e=e.j.splice(0,n),t.F=e,r}function If(e){if(!e.g&&!e.u){e.ba=1;var t=e.Ma;Wr||qh(),Qr||(Wr(),Qr=!0),Ja.add(t,e),e.A=0}}function ll(e){return e.g||e.u||3<=e.A?!1:(e.ba++,e.u=cs(Ht(e.Ma,e),Pf(e,e.A)),e.A++,!0)}S.Ma=function(){if(this.u=null,Af(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var e=2*this.S;this.l.info("BP detection timer enabled: "+e),this.B=cs(Ht(this.jb,this),e)}};S.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,Gt(10),$i(this),Af(this))};function cl(e){e.B!=null&&($.clearTimeout(e.B),e.B=null)}function Af(e){e.g=new hs(e,e.l,"rpc",e.ba),e.o===null&&(e.g.I=e.s),e.g.O=0;var t=Oe(e.wa);ht(t,"RID","rpc"),ht(t,"SID",e.K),ht(t,"AID",e.V),ht(t,"CI",e.G?"0":"1"),!e.G&&e.qa&&ht(t,"TO",e.qa),ht(t,"TYPE","xmlhttp"),gs(e,t),e.o&&e.s&&ol(t,e.o,e.s),e.L&&e.g.setTimeout(e.L);var n=e.g;e=e.pa,n.L=1,n.v=Li(Oe(t)),n.s=null,n.S=!0,Zh(n,e)}S.ib=function(){this.v!=null&&(this.v=null,$i(this),ll(this),Gt(19))};function ii(e){e.v!=null&&($.clearTimeout(e.v),e.v=null)}function Rf(e,t){var n=null;if(e.g==t){ii(e),cl(e),e.g=null;var r=2}else if(ea(e.i,t))n=t.F,ff(e.i,t),r=1;else return;if(e.H!=0){if(t.i)if(r==1){n=t.s?t.s.length:0,t=Date.now()-t.G;var s=e.C;r=Ni(),Ot(r,new Gh(r,n)),ji(e)}else If(e);else if(s=t.o,s==3||s==0&&0<t.ca||!(r==1&&mE(e,t)||r==2&&ll(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),s){case 1:yn(e,5);break;case 4:yn(e,10);break;case 3:yn(e,6);break;default:yn(e,2)}}}function Pf(e,t){let n=e.ab+Math.floor(Math.random()*e.hb);return e.isActive()||(n*=2),n*t}function yn(e,t){if(e.l.info("Error code "+t),t==2){var n=null;e.h&&(n=null);var r=Ht(e.pb,e);n||(n=new Tn("//www.google.com/images/cleardot.gif"),$.location&&$.location.protocol=="http"||ri(n,"https"),Li(n)),uE(n.toString(),r)}else Gt(2);e.H=0,e.h&&e.h.za(t),Cf(e),Tf(e)}S.pb=function(e){e?(this.l.info("Successfully pinged google.com"),Gt(2)):(this.l.info("Failed to ping google.com"),Gt(1))};function Cf(e){if(e.H=0,e.ma=[],e.h){const t=df(e.i);(t.length!=0||e.j.length!=0)&&(Sc(e.ma,t),Sc(e.ma,e.j),e.i.i.length=0,Ha(e.j),e.j.length=0),e.h.ya()}}function Sf(e,t,n){var r=n instanceof Tn?Oe(n):new Tn(n);if(r.g!="")t&&(r.g=t+"."+r.g),si(r,r.m);else{var s=$.location;r=s.protocol,t=t?t+"."+s.hostname:s.hostname,s=+s.port;var i=new Tn(null);r&&ri(i,r),t&&(i.g=t),s&&si(i,s),n&&(i.l=n),r=i}return n=e.F,t=e.Da,n&&t&&ht(r,n,t),ht(r,"VER",e.ra),gs(e,r),r}function bf(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return t=n&&e.Ha&&!e.va?new mt(new ds({ob:!0})):new mt(e.va),t.Oa(e.J),t}S.isActive=function(){return!!this.h&&this.h.isActive(this)};function Vf(){}S=Vf.prototype;S.Ba=function(){};S.Aa=function(){};S.za=function(){};S.ya=function(){};S.isActive=function(){return!0};S.Va=function(){};function oi(){if(Jn&&!(10<=Number(by)))throw Error("Environmental error: no available transport.")}oi.prototype.g=function(e,t){return new ee(e,t)};function ee(e,t){Vt.call(this),this.g=new vf(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.Ca&&(e?e["X-WebChannel-Client-Profile"]=t.Ca:e={"X-WebChannel-Client-Profile":t.Ca}),this.g.U=e,(e=t&&t.cc)&&!zr(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!zr(t)&&(this.g.F=t,e=this.h,e!==null&&t in e&&(e=this.h,t in e&&delete e[t])),this.j=new hr(this)}Dt(ee,Vt);ee.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var e=this.g,t=this.l,n=this.h||void 0;Gt(0),e.Y=t,e.na=n||{},e.G=e.aa,e.I=Sf(e,null,e.Y),ji(e)};ee.prototype.close=function(){al(this.g)};ee.prototype.u=function(e){var t=this.g;if(typeof e=="string"){var n={};n.__data__=e,e=n}else this.v&&(n={},n.__data__=Ya(e),e=n);t.j.push(new iE(t.fb++,e)),t.H==3&&ji(t)};ee.prototype.N=function(){this.g.h=null,delete this.j,al(this.g),delete this.g,ee.$.N.call(this)};function Df(e){nl.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){t:{for(const n in t){e=n;break t}e=void 0}(this.i=e)&&(e=this.i,t=t!==null&&e in t?t[e]:void 0),this.data=t}else this.data=e}Dt(Df,nl);function xf(){rl.call(this),this.status=1}Dt(xf,rl);function hr(e){this.g=e}Dt(hr,Vf);hr.prototype.Ba=function(){Ot(this.g,"a")};hr.prototype.Aa=function(e){Ot(this.g,new Df(e))};hr.prototype.za=function(e){Ot(this.g,new xf)};hr.prototype.ya=function(){Ot(this.g,"b")};function _E(){this.blockSize=-1}function de(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}Dt(de,_E);de.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function To(e,t,n){n||(n=0);var r=Array(16);if(typeof t=="string")for(var s=0;16>s;++s)r[s]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(s=0;16>s;++s)r[s]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],s=e.g[2];var i=e.g[3],o=t+(i^n&(s^i))+r[0]+3614090360&4294967295;t=n+(o<<7&4294967295|o>>>25),o=i+(s^t&(n^s))+r[1]+3905402710&4294967295,i=t+(o<<12&4294967295|o>>>20),o=s+(n^i&(t^n))+r[2]+606105819&4294967295,s=i+(o<<17&4294967295|o>>>15),o=n+(t^s&(i^t))+r[3]+3250441966&4294967295,n=s+(o<<22&4294967295|o>>>10),o=t+(i^n&(s^i))+r[4]+4118548399&4294967295,t=n+(o<<7&4294967295|o>>>25),o=i+(s^t&(n^s))+r[5]+1200080426&4294967295,i=t+(o<<12&4294967295|o>>>20),o=s+(n^i&(t^n))+r[6]+2821735955&4294967295,s=i+(o<<17&4294967295|o>>>15),o=n+(t^s&(i^t))+r[7]+4249261313&4294967295,n=s+(o<<22&4294967295|o>>>10),o=t+(i^n&(s^i))+r[8]+1770035416&4294967295,t=n+(o<<7&4294967295|o>>>25),o=i+(s^t&(n^s))+r[9]+2336552879&4294967295,i=t+(o<<12&4294967295|o>>>20),o=s+(n^i&(t^n))+r[10]+4294925233&4294967295,s=i+(o<<17&4294967295|o>>>15),o=n+(t^s&(i^t))+r[11]+2304563134&4294967295,n=s+(o<<22&4294967295|o>>>10),o=t+(i^n&(s^i))+r[12]+1804603682&4294967295,t=n+(o<<7&4294967295|o>>>25),o=i+(s^t&(n^s))+r[13]+4254626195&4294967295,i=t+(o<<12&4294967295|o>>>20),o=s+(n^i&(t^n))+r[14]+2792965006&4294967295,s=i+(o<<17&4294967295|o>>>15),o=n+(t^s&(i^t))+r[15]+1236535329&4294967295,n=s+(o<<22&4294967295|o>>>10),o=t+(s^i&(n^s))+r[1]+4129170786&4294967295,t=n+(o<<5&4294967295|o>>>27),o=i+(n^s&(t^n))+r[6]+3225465664&4294967295,i=t+(o<<9&4294967295|o>>>23),o=s+(t^n&(i^t))+r[11]+643717713&4294967295,s=i+(o<<14&4294967295|o>>>18),o=n+(i^t&(s^i))+r[0]+3921069994&4294967295,n=s+(o<<20&4294967295|o>>>12),o=t+(s^i&(n^s))+r[5]+3593408605&4294967295,t=n+(o<<5&4294967295|o>>>27),o=i+(n^s&(t^n))+r[10]+38016083&4294967295,i=t+(o<<9&4294967295|o>>>23),o=s+(t^n&(i^t))+r[15]+3634488961&4294967295,s=i+(o<<14&4294967295|o>>>18),o=n+(i^t&(s^i))+r[4]+3889429448&4294967295,n=s+(o<<20&4294967295|o>>>12),o=t+(s^i&(n^s))+r[9]+568446438&4294967295,t=n+(o<<5&4294967295|o>>>27),o=i+(n^s&(t^n))+r[14]+3275163606&4294967295,i=t+(o<<9&4294967295|o>>>23),o=s+(t^n&(i^t))+r[3]+4107603335&4294967295,s=i+(o<<14&4294967295|o>>>18),o=n+(i^t&(s^i))+r[8]+1163531501&4294967295,n=s+(o<<20&4294967295|o>>>12),o=t+(s^i&(n^s))+r[13]+2850285829&4294967295,t=n+(o<<5&4294967295|o>>>27),o=i+(n^s&(t^n))+r[2]+4243563512&4294967295,i=t+(o<<9&4294967295|o>>>23),o=s+(t^n&(i^t))+r[7]+1735328473&4294967295,s=i+(o<<14&4294967295|o>>>18),o=n+(i^t&(s^i))+r[12]+2368359562&4294967295,n=s+(o<<20&4294967295|o>>>12),o=t+(n^s^i)+r[5]+4294588738&4294967295,t=n+(o<<4&4294967295|o>>>28),o=i+(t^n^s)+r[8]+2272392833&4294967295,i=t+(o<<11&4294967295|o>>>21),o=s+(i^t^n)+r[11]+1839030562&4294967295,s=i+(o<<16&4294967295|o>>>16),o=n+(s^i^t)+r[14]+4259657740&4294967295,n=s+(o<<23&4294967295|o>>>9),o=t+(n^s^i)+r[1]+2763975236&4294967295,t=n+(o<<4&4294967295|o>>>28),o=i+(t^n^s)+r[4]+1272893353&4294967295,i=t+(o<<11&4294967295|o>>>21),o=s+(i^t^n)+r[7]+4139469664&4294967295,s=i+(o<<16&4294967295|o>>>16),o=n+(s^i^t)+r[10]+3200236656&4294967295,n=s+(o<<23&4294967295|o>>>9),o=t+(n^s^i)+r[13]+681279174&4294967295,t=n+(o<<4&4294967295|o>>>28),o=i+(t^n^s)+r[0]+3936430074&4294967295,i=t+(o<<11&4294967295|o>>>21),o=s+(i^t^n)+r[3]+3572445317&4294967295,s=i+(o<<16&4294967295|o>>>16),o=n+(s^i^t)+r[6]+76029189&4294967295,n=s+(o<<23&4294967295|o>>>9),o=t+(n^s^i)+r[9]+3654602809&4294967295,t=n+(o<<4&4294967295|o>>>28),o=i+(t^n^s)+r[12]+3873151461&4294967295,i=t+(o<<11&4294967295|o>>>21),o=s+(i^t^n)+r[15]+530742520&4294967295,s=i+(o<<16&4294967295|o>>>16),o=n+(s^i^t)+r[2]+3299628645&4294967295,n=s+(o<<23&4294967295|o>>>9),o=t+(s^(n|~i))+r[0]+4096336452&4294967295,t=n+(o<<6&4294967295|o>>>26),o=i+(n^(t|~s))+r[7]+1126891415&4294967295,i=t+(o<<10&4294967295|o>>>22),o=s+(t^(i|~n))+r[14]+2878612391&4294967295,s=i+(o<<15&4294967295|o>>>17),o=n+(i^(s|~t))+r[5]+4237533241&4294967295,n=s+(o<<21&4294967295|o>>>11),o=t+(s^(n|~i))+r[12]+1700485571&4294967295,t=n+(o<<6&4294967295|o>>>26),o=i+(n^(t|~s))+r[3]+2399980690&4294967295,i=t+(o<<10&4294967295|o>>>22),o=s+(t^(i|~n))+r[10]+4293915773&4294967295,s=i+(o<<15&4294967295|o>>>17),o=n+(i^(s|~t))+r[1]+2240044497&4294967295,n=s+(o<<21&4294967295|o>>>11),o=t+(s^(n|~i))+r[8]+1873313359&4294967295,t=n+(o<<6&4294967295|o>>>26),o=i+(n^(t|~s))+r[15]+4264355552&4294967295,i=t+(o<<10&4294967295|o>>>22),o=s+(t^(i|~n))+r[6]+2734768916&4294967295,s=i+(o<<15&4294967295|o>>>17),o=n+(i^(s|~t))+r[13]+1309151649&4294967295,n=s+(o<<21&4294967295|o>>>11),o=t+(s^(n|~i))+r[4]+4149444226&4294967295,t=n+(o<<6&4294967295|o>>>26),o=i+(n^(t|~s))+r[11]+3174756917&4294967295,i=t+(o<<10&4294967295|o>>>22),o=s+(t^(i|~n))+r[2]+718787259&4294967295,s=i+(o<<15&4294967295|o>>>17),o=n+(i^(s|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(s+(o<<21&4294967295|o>>>11))&4294967295,e.g[2]=e.g[2]+s&4294967295,e.g[3]=e.g[3]+i&4294967295}de.prototype.j=function(e,t){t===void 0&&(t=e.length);for(var n=t-this.blockSize,r=this.m,s=this.h,i=0;i<t;){if(s==0)for(;i<=n;)To(this,e,i),i+=this.blockSize;if(typeof e=="string"){for(;i<t;)if(r[s++]=e.charCodeAt(i++),s==this.blockSize){To(this,r),s=0;break}}else for(;i<t;)if(r[s++]=e[i++],s==this.blockSize){To(this,r),s=0;break}}this.h=s,this.i+=t};de.prototype.l=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.i;for(t=e.length-8;t<e.length;++t)e[t]=n&255,n/=256;for(this.j(e),e=Array(16),t=n=0;4>t;++t)for(var r=0;32>r;r+=8)e[n++]=this.g[t]>>>r&255;return e};function rt(e,t){this.h=t;for(var n=[],r=!0,s=e.length-1;0<=s;s--){var i=e[s]|0;r&&i==t||(n[s]=i,r=!1)}this.g=n}var yE={};function ul(e){return-128<=e&&128>e?Py(e,function(t){return new rt([t|0],0>t?-1:0)}):new rt([e|0],0>e?-1:0)}function we(e){if(isNaN(e)||!isFinite(e))return Hn;if(0>e)return Nt(we(-e));for(var t=[],n=1,r=0;e>=n;r++)t[r]=e/n|0,n*=na;return new rt(t,0)}function kf(e,t){if(e.length==0)throw Error("number format error: empty string");if(t=t||10,2>t||36<t)throw Error("radix out of range: "+t);if(e.charAt(0)=="-")return Nt(kf(e.substring(1),t));if(0<=e.indexOf("-"))throw Error('number format error: interior "-" character');for(var n=we(Math.pow(t,8)),r=Hn,s=0;s<e.length;s+=8){var i=Math.min(8,e.length-s),o=parseInt(e.substring(s,s+i),t);8>i?(i=we(Math.pow(t,i)),r=r.R(i).add(we(o))):(r=r.R(n),r=r.add(we(o)))}return r}var na=4294967296,Hn=ul(0),ra=ul(1),Bc=ul(16777216);S=rt.prototype;S.ea=function(){if(ne(this))return-Nt(this).ea();for(var e=0,t=1,n=0;n<this.g.length;n++){var r=this.D(n);e+=(0<=r?r:na+r)*t,t*=na}return e};S.toString=function(e){if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(xe(this))return"0";if(ne(this))return"-"+Nt(this).toString(e);for(var t=we(Math.pow(e,6)),n=this,r="";;){var s=li(n,t).g;n=ai(n,s.R(t));var i=((0<n.g.length?n.g[0]:n.h)>>>0).toString(e);if(n=s,xe(n))return i+r;for(;6>i.length;)i="0"+i;r=i+r}};S.D=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h};function xe(e){if(e.h!=0)return!1;for(var t=0;t<e.g.length;t++)if(e.g[t]!=0)return!1;return!0}function ne(e){return e.h==-1}S.X=function(e){return e=ai(this,e),ne(e)?-1:xe(e)?0:1};function Nt(e){for(var t=e.g.length,n=[],r=0;r<t;r++)n[r]=~e.g[r];return new rt(n,~e.h).add(ra)}S.abs=function(){return ne(this)?Nt(this):this};S.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0,s=0;s<=t;s++){var i=r+(this.D(s)&65535)+(e.D(s)&65535),o=(i>>>16)+(this.D(s)>>>16)+(e.D(s)>>>16);r=o>>>16,i&=65535,o&=65535,n[s]=o<<16|i}return new rt(n,n[n.length-1]&-2147483648?-1:0)};function ai(e,t){return e.add(Nt(t))}S.R=function(e){if(xe(this)||xe(e))return Hn;if(ne(this))return ne(e)?Nt(this).R(Nt(e)):Nt(Nt(this).R(e));if(ne(e))return Nt(this.R(Nt(e)));if(0>this.X(Bc)&&0>e.X(Bc))return we(this.ea()*e.ea());for(var t=this.g.length+e.g.length,n=[],r=0;r<2*t;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var s=0;s<e.g.length;s++){var i=this.D(r)>>>16,o=this.D(r)&65535,a=e.D(s)>>>16,l=e.D(s)&65535;n[2*r+2*s]+=o*l,ks(n,2*r+2*s),n[2*r+2*s+1]+=i*l,ks(n,2*r+2*s+1),n[2*r+2*s+1]+=o*a,ks(n,2*r+2*s+1),n[2*r+2*s+2]+=i*a,ks(n,2*r+2*s+2)}for(r=0;r<t;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=t;r<2*t;r++)n[r]=0;return new rt(n,0)};function ks(e,t){for(;(e[t]&65535)!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function vr(e,t){this.g=e,this.h=t}function li(e,t){if(xe(t))throw Error("division by zero");if(xe(e))return new vr(Hn,Hn);if(ne(e))return t=li(Nt(e),t),new vr(Nt(t.g),Nt(t.h));if(ne(t))return t=li(e,Nt(t)),new vr(Nt(t.g),t.h);if(30<e.g.length){if(ne(e)||ne(t))throw Error("slowDivide_ only works with positive integers.");for(var n=ra,r=t;0>=r.X(e);)n=Uc(n),r=Uc(r);var s=kn(n,1),i=kn(r,1);for(r=kn(r,2),n=kn(n,2);!xe(r);){var o=i.add(r);0>=o.X(e)&&(s=s.add(n),i=o),r=kn(r,1),n=kn(n,1)}return t=ai(e,s.R(t)),new vr(s,t)}for(s=Hn;0<=e.X(t);){for(n=Math.max(1,Math.floor(e.ea()/t.ea())),r=Math.ceil(Math.log(n)/Math.LN2),r=48>=r?1:Math.pow(2,r-48),i=we(n),o=i.R(t);ne(o)||0<o.X(e);)n-=r,i=we(n),o=i.R(t);xe(i)&&(i=ra),s=s.add(i),e=ai(e,o)}return new vr(s,e)}S.gb=function(e){return li(this,e).h};S.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)&e.D(r);return new rt(n,this.h&e.h)};S.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)|e.D(r);return new rt(n,this.h|e.h)};S.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)^e.D(r);return new rt(n,this.h^e.h)};function Uc(e){for(var t=e.g.length+1,n=[],r=0;r<t;r++)n[r]=e.D(r)<<1|e.D(r-1)>>>31;return new rt(n,e.h)}function kn(e,t){var n=t>>5;t%=32;for(var r=e.g.length-n,s=[],i=0;i<r;i++)s[i]=0<t?e.D(i+n)>>>t|e.D(i+n+1)<<32-t:e.D(i+n);return new rt(s,e.h)}oi.prototype.createWebChannel=oi.prototype.g;ee.prototype.send=ee.prototype.u;ee.prototype.open=ee.prototype.m;ee.prototype.close=ee.prototype.close;Mi.NO_ERROR=0;Mi.TIMEOUT=8;Mi.HTTP_ERROR=6;Xh.COMPLETE="complete";Yh.EventType=us;us.OPEN="a";us.CLOSE="b";us.ERROR="c";us.MESSAGE="d";Vt.prototype.listen=Vt.prototype.O;mt.prototype.listenOnce=mt.prototype.P;mt.prototype.getLastError=mt.prototype.Sa;mt.prototype.getLastErrorCode=mt.prototype.Ia;mt.prototype.getStatus=mt.prototype.da;mt.prototype.getResponseJson=mt.prototype.Wa;mt.prototype.getResponseText=mt.prototype.ja;mt.prototype.send=mt.prototype.ha;mt.prototype.setWithCredentials=mt.prototype.Oa;de.prototype.digest=de.prototype.l;de.prototype.reset=de.prototype.reset;de.prototype.update=de.prototype.j;rt.prototype.add=rt.prototype.add;rt.prototype.multiply=rt.prototype.R;rt.prototype.modulo=rt.prototype.gb;rt.prototype.compare=rt.prototype.X;rt.prototype.toNumber=rt.prototype.ea;rt.prototype.toString=rt.prototype.toString;rt.prototype.getBits=rt.prototype.D;rt.fromNumber=we;rt.fromString=kf;var EE=function(){return new oi},vE=function(){return Ni()},wo=Mi,TE=Xh,wE=Cn,$c={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},IE=ds,Ns=Yh,AE=mt,RE=de,zn=rt;const jc="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lt{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}Lt.UNAUTHENTICATED=new Lt(null),Lt.GOOGLE_CREDENTIALS=new Lt("google-credentials-uid"),Lt.FIRST_PARTY=new Lt("first-party-uid"),Lt.MOCK_USER=new Lt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let fr="10.0.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const An=new Rh("@firebase/firestore");function qc(){return An.logLevel}function x(e,...t){if(An.logLevel<=et.DEBUG){const n=t.map(hl);An.debug(`Firestore (${fr}): ${e}`,...n)}}function Fe(e,...t){if(An.logLevel<=et.ERROR){const n=t.map(hl);An.error(`Firestore (${fr}): ${e}`,...n)}}function Zn(e,...t){if(An.logLevel<=et.WARN){const n=t.map(hl);An.warn(`Firestore (${fr}): ${e}`,...n)}}function hl(e){if(typeof e=="string")return e;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(e)}catch{return e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B(e="Unexpected state"){const t=`FIRESTORE (${fr}) INTERNAL ASSERTION FAILED: `+e;throw Fe(t),new Error(t)}function ft(e,t){e||B()}function K(e,t){return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class M extends cr{constructor(t,n){super(t,n),this.code=t,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ye{constructor(){this.promise=new Promise((t,n)=>{this.resolve=t,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nf{constructor(t,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class PE{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,n){t.enqueueRetryable(()=>n(Lt.UNAUTHENTICATED))}shutdown(){}}class CE{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,n){this.changeListener=n,t.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class SE{constructor(t){this.t=t,this.currentUser=Lt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,n){let r=this.i;const s=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let i=new Ye;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Ye,t.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const l=i;t.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},a=l=>{x("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(x("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Ye)}},0),o()}getToken(){const t=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==t?(x("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ft(typeof r.accessToken=="string"),new Nf(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const t=this.auth&&this.auth.getUid();return ft(t===null||typeof t=="string"),new Lt(t)}}class bE{constructor(t,n,r){this.l=t,this.h=n,this.P=r,this.type="FirstParty",this.user=Lt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const t=this.T();return t&&this.I.set("Authorization",t),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class VE{constructor(t,n,r){this.l=t,this.h=n,this.P=r}getToken(){return Promise.resolve(new bE(this.l,this.h,this.P))}start(t,n){t.enqueueRetryable(()=>n(Lt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class DE{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class xE{constructor(t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(t,n){const r=i=>{i.error!=null&&x("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.R;return this.R=i.token,x("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{t.enqueueRetryable(()=>r(i))};const s=i=>{x("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):x("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(n=>n?(ft(typeof n.token=="string"),this.R=n.token,new DE(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kE(e){const t=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mf{static V(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/t.length)*t.length;let r="";for(;r.length<20;){const s=kE(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=t.charAt(s[i]%t.length))}return r}}function Z(e,t){return e<t?-1:e>t?1:0}function tr(e,t,n){return e.length===t.length&&e.every((r,s)=>n(r,t[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rt{constructor(t,n){if(this.seconds=t,this.nanoseconds=n,n<0)throw new M(E.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new M(E.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(t<-62135596800)throw new M(E.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new M(E.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return Rt.fromMillis(Date.now())}static fromDate(t){return Rt.fromMillis(t.getTime())}static fromMillis(t){const n=Math.floor(t/1e3),r=Math.floor(1e6*(t-1e3*n));return new Rt(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?Z(this.nanoseconds,t.nanoseconds):Z(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H{constructor(t){this.timestamp=t}static fromTimestamp(t){return new H(t)}static min(){return new H(new Rt(0,0))}static max(){return new H(new Rt(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zr{constructor(t,n,r){n===void 0?n=0:n>t.length&&B(),r===void 0?r=t.length-n:r>t.length-n&&B(),this.segments=t,this.offset=n,this.len=r}get length(){return this.len}isEqual(t){return Zr.comparator(this,t)===0}child(t){const n=this.segments.slice(this.offset,this.limit());return t instanceof Zr?t.forEach(r=>{n.push(r)}):n.push(t),this.construct(n)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==t.get(n))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==t.get(n))return!1;return!0}forEach(t){for(let n=this.offset,r=this.limit();n<r;n++)t(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,n){const r=Math.min(t.length,n.length);for(let s=0;s<r;s++){const i=t.get(s),o=n.get(s);if(i<o)return-1;if(i>o)return 1}return t.length<n.length?-1:t.length>n.length?1:0}}class dt extends Zr{construct(t,n,r){return new dt(t,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...t){const n=[];for(const r of t){if(r.indexOf("//")>=0)throw new M(E.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new dt(n)}static emptyPath(){return new dt([])}}const NE=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class $t extends Zr{construct(t,n,r){return new $t(t,n,r)}static isValidIdentifier(t){return NE.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),$t.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new $t(["__name__"])}static fromServerFormat(t){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new M(E.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<t.length;){const a=t[s];if(a==="\\"){if(s+1===t.length)throw new M(E.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const l=t[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new M(E.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=l,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new M(E.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new $t(n)}static emptyPath(){return new $t([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O{constructor(t){this.path=t}static fromPath(t){return new O(dt.fromString(t))}static fromName(t){return new O(dt.fromString(t).popFirst(5))}static empty(){return new O(dt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&dt.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,n){return dt.comparator(t.path,n.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new O(new dt(t.slice()))}}function ME(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,s=H.fromTimestamp(r===1e9?new Rt(n+1,0):new Rt(n,r));return new en(s,O.empty(),t)}function OE(e){return new en(e.readTime,e.key,-1)}class en{constructor(t,n,r){this.readTime=t,this.documentKey=n,this.largestBatchId=r}static min(){return new en(H.min(),O.empty(),-1)}static max(){return new en(H.max(),O.empty(),-1)}}function FE(e,t){let n=e.readTime.compareTo(t.readTime);return n!==0?n:(n=O.comparator(e.documentKey,t.documentKey),n!==0?n:Z(e.largestBatchId,t.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LE="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class BE{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ms(e){if(e.code!==E.FAILED_PRECONDITION||e.message!==LE)throw e;x("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(t){return this.next(void 0,t)}next(t,n){return this.callbackAttached&&B(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new T((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(t,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((t,n)=>{this.next(t,n)})}wrapUserFunction(t){try{const n=t();return n instanceof T?n:T.resolve(n)}catch(n){return T.reject(n)}}wrapSuccess(t,n){return t?this.wrapUserFunction(()=>t(n)):T.resolve(n)}wrapFailure(t,n){return t?this.wrapUserFunction(()=>t(n)):T.reject(n)}static resolve(t){return new T((n,r)=>{n(t)})}static reject(t){return new T((n,r)=>{r(t)})}static waitFor(t){return new T((n,r)=>{let s=0,i=0,o=!1;t.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&n()},l=>r(l))}),o=!0,i===s&&n()})}static or(t){let n=T.resolve(!1);for(const r of t)n=n.next(s=>s?T.resolve(s):r());return n}static forEach(t,n){const r=[];return t.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(t,n){return new T((r,s)=>{const i=t.length,o=new Array(i);let a=0;for(let l=0;l<i;l++){const c=l;n(t[c]).next(u=>{o[c]=u,++a,a===i&&r(o)},u=>s(u))}})}static doWhile(t,n){return new T((r,s)=>{const i=()=>{t()===!0?n().next(()=>{i()},s):r()};i()})}}function _s(e){return e.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fl{constructor(t,n){this.previousValue=t,n&&(n.sequenceNumberHandler=r=>this.oe(r),this._e=r=>n.writeSequenceNumber(r))}oe(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this._e&&this._e(t),t}}fl.ae=-1;function qi(e){return e==null}function ci(e){return e===0&&1/e==-1/0}function UE(e){return typeof e=="number"&&Number.isInteger(e)&&!ci(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hc(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function dr(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function Of(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gt{constructor(t,n){this.comparator=t,this.root=n||kt.EMPTY}insert(t,n){return new gt(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,kt.BLACK,null,null))}remove(t){return new gt(this.comparator,this.root.remove(t,this.comparator).copy(null,null,kt.BLACK,null,null))}get(t){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(t,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(t){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(t,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((n,r)=>(t(n,r),!1))}toString(){const t=[];return this.inorderTraversal((n,r)=>(t.push(`${n}:${r}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new Ms(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new Ms(this.root,t,this.comparator,!1)}getReverseIterator(){return new Ms(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new Ms(this.root,t,this.comparator,!0)}}class Ms{constructor(t,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!t.isEmpty();)if(i=n?r(t.key,n):1,n&&s&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(i===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const n={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class kt{constructor(t,n,r,s,i){this.key=t,this.value=n,this.color=r??kt.RED,this.left=s??kt.EMPTY,this.right=i??kt.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,n,r,s,i){return new kt(t??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,n,r){let s=this;const i=r(t,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(t,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(t,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return kt.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,n){let r,s=this;if(n(t,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(t,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(t,s.key)===0){if(s.right.isEmpty())return kt.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(t,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,kt.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,kt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,n)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw B();const t=this.left.check();if(t!==this.right.check())throw B();return t+(this.isRed()?0:1)}}kt.EMPTY=null,kt.RED=!0,kt.BLACK=!1;kt.EMPTY=new class{constructor(){this.size=0}get key(){throw B()}get value(){throw B()}get color(){throw B()}get left(){throw B()}get right(){throw B()}copy(t,n,r,s,i){return this}insert(t,n,r){return new kt(t,n)}remove(t,n){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kt{constructor(t){this.comparator=t,this.data=new gt(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((n,r)=>(t(n),!1))}forEachInRange(t,n){const r=this.data.getIteratorFrom(t[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,t[1])>=0)return;n(s.key)}}forEachWhile(t,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!t(r.getNext().key))return}firstAfterOrEqual(t){const n=this.data.getIteratorFrom(t);return n.hasNext()?n.getNext().key:null}getIterator(){return new zc(this.data.getIterator())}getIteratorFrom(t){return new zc(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let n=this;return n.size<t.size&&(n=t,t=this),t.forEach(r=>{n=n.add(r)}),n}isEqual(t){if(!(t instanceof Kt)||this.size!==t.size)return!1;const n=this.data.getIterator(),r=t.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const t=[];return this.forEach(n=>{t.push(n)}),t}toString(){const t=[];return this.forEach(n=>t.push(n)),"SortedSet("+t.toString()+")"}copy(t){const n=new Kt(this.comparator);return n.data=t,n}}class zc{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ce{constructor(t){this.fields=t,t.sort($t.comparator)}static empty(){return new ce([])}unionWith(t){let n=new Kt($t.comparator);for(const r of this.fields)n=n.add(r);for(const r of t)n=n.add(r);return new ce(n.toArray())}covers(t){for(const n of this.fields)if(n.isPrefixOf(t))return!0;return!1}isEqual(t){return tr(this.fields,t.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ff extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wt{constructor(t){this.binaryString=t}static fromBase64String(t){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new Ff("Invalid base64 string: "+i):i}}(t);return new Wt(n)}static fromUint8Array(t){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(t);return new Wt(n)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return Z(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}Wt.EMPTY_BYTE_STRING=new Wt("");const $E=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function nn(e){if(ft(!!e),typeof e=="string"){let t=0;const n=$E.exec(e);if(ft(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),t=Number(s)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:vt(e.seconds),nanos:vt(e.nanos)}}function vt(e){return typeof e=="number"?e:typeof e=="string"?Number(e):0}function Rn(e){return typeof e=="string"?Wt.fromBase64String(e):Wt.fromUint8Array(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dl(e){var t,n;return((n=(((t=e==null?void 0:e.mapValue)===null||t===void 0?void 0:t.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function pl(e){const t=e.mapValue.fields.__previous_value__;return dl(t)?pl(t):t}function ts(e){const t=nn(e.mapValue.fields.__local_write_time__.timestampValue);return new Rt(t.seconds,t.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jE{constructor(t,n,r,s,i,o,a,l,c){this.databaseId=t,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c}}class es{constructor(t,n){this.projectId=t,this.database=n||"(default)"}static empty(){return new es("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(t){return t instanceof es&&t.projectId===this.projectId&&t.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Os={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Pn(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?dl(e)?4:qE(e)?9007199254740991:10:B()}function Re(e,t){if(e===t)return!0;const n=Pn(e);if(n!==Pn(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return ts(e).isEqual(ts(t));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=nn(s.timestampValue),a=nn(i.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(s,i){return Rn(s.bytesValue).isEqual(Rn(i.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(s,i){return vt(s.geoPointValue.latitude)===vt(i.geoPointValue.latitude)&&vt(s.geoPointValue.longitude)===vt(i.geoPointValue.longitude)}(e,t);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return vt(s.integerValue)===vt(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=vt(s.doubleValue),a=vt(i.doubleValue);return o===a?ci(o)===ci(a):isNaN(o)&&isNaN(a)}return!1}(e,t);case 9:return tr(e.arrayValue.values||[],t.arrayValue.values||[],Re);case 10:return function(s,i){const o=s.mapValue.fields||{},a=i.mapValue.fields||{};if(Hc(o)!==Hc(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!Re(o[l],a[l])))return!1;return!0}(e,t);default:return B()}}function ns(e,t){return(e.values||[]).find(n=>Re(n,t))!==void 0}function er(e,t){if(e===t)return 0;const n=Pn(e),r=Pn(t);if(n!==r)return Z(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Z(e.booleanValue,t.booleanValue);case 2:return function(i,o){const a=vt(i.integerValue||i.doubleValue),l=vt(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(e,t);case 3:return Kc(e.timestampValue,t.timestampValue);case 4:return Kc(ts(e),ts(t));case 5:return Z(e.stringValue,t.stringValue);case 6:return function(i,o){const a=Rn(i),l=Rn(o);return a.compareTo(l)}(e.bytesValue,t.bytesValue);case 7:return function(i,o){const a=i.split("/"),l=o.split("/");for(let c=0;c<a.length&&c<l.length;c++){const u=Z(a[c],l[c]);if(u!==0)return u}return Z(a.length,l.length)}(e.referenceValue,t.referenceValue);case 8:return function(i,o){const a=Z(vt(i.latitude),vt(o.latitude));return a!==0?a:Z(vt(i.longitude),vt(o.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(i,o){const a=i.values||[],l=o.values||[];for(let c=0;c<a.length&&c<l.length;++c){const u=er(a[c],l[c]);if(u)return u}return Z(a.length,l.length)}(e.arrayValue,t.arrayValue);case 10:return function(i,o){if(i===Os.mapValue&&o===Os.mapValue)return 0;if(i===Os.mapValue)return 1;if(o===Os.mapValue)return-1;const a=i.fields||{},l=Object.keys(a),c=o.fields||{},u=Object.keys(c);l.sort(),u.sort();for(let h=0;h<l.length&&h<u.length;++h){const d=Z(l[h],u[h]);if(d!==0)return d;const g=er(a[l[h]],c[u[h]]);if(g!==0)return g}return Z(l.length,u.length)}(e.mapValue,t.mapValue);default:throw B()}}function Kc(e,t){if(typeof e=="string"&&typeof t=="string"&&e.length===t.length)return Z(e,t);const n=nn(e),r=nn(t),s=Z(n.seconds,r.seconds);return s!==0?s:Z(n.nanos,r.nanos)}function nr(e){return sa(e)}function sa(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(n){const r=nn(n);return`time(${r.seconds},${r.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(n){return Rn(n).toBase64()}(e.bytesValue):"referenceValue"in e?function(n){return O.fromName(n).toString()}(e.referenceValue):"geoPointValue"in e?function(n){return`geo(${n.latitude},${n.longitude})`}(e.geoPointValue):"arrayValue"in e?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=sa(i);return r+"]"}(e.arrayValue):"mapValue"in e?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${sa(n.fields[o])}`;return s+"}"}(e.mapValue):B()}function ia(e){return!!e&&"integerValue"in e}function gl(e){return!!e&&"arrayValue"in e}function Wc(e){return!!e&&"nullValue"in e}function Qc(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function Hs(e){return!!e&&"mapValue"in e}function Dr(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&typeof e.timestampValue=="object")return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return dr(e.mapValue.fields,(n,r)=>t.mapValue.fields[n]=Dr(r)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=Dr(e.arrayValue.values[n]);return t}return Object.assign({},e)}function qE(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class re{constructor(t){this.value=t}static empty(){return new re({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let n=this.value;for(let r=0;r<t.length-1;++r)if(n=(n.mapValue.fields||{})[t.get(r)],!Hs(n))return null;return n=(n.mapValue.fields||{})[t.lastSegment()],n||null}}set(t,n){this.getFieldsMap(t.popLast())[t.lastSegment()]=Dr(n)}setAll(t){let n=$t.emptyPath(),r={},s=[];t.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,r,s),r={},s=[],n=a.popLast()}o?r[a.lastSegment()]=Dr(o):s.push(a.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(t){const n=this.field(t.popLast());Hs(n)&&n.mapValue.fields&&delete n.mapValue.fields[t.lastSegment()]}isEqual(t){return Re(this.value,t.value)}getFieldsMap(t){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<t.length;++r){let s=n.mapValue.fields[t.get(r)];Hs(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[t.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(t,n,r){dr(n,(s,i)=>t[s]=i);for(const s of r)delete t[s]}clone(){return new re(Dr(this.value))}}function Lf(e){const t=[];return dr(e.fields,(n,r)=>{const s=new $t([n]);if(Hs(r)){const i=Lf(r.mapValue).fields;if(i.length===0)t.push(s);else for(const o of i)t.push(s.child(o))}else t.push(s)}),new ce(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bt{constructor(t,n,r,s,i,o,a){this.key=t,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(t){return new Bt(t,0,H.min(),H.min(),H.min(),re.empty(),0)}static newFoundDocument(t,n,r,s){return new Bt(t,1,n,H.min(),r,s,0)}static newNoDocument(t,n){return new Bt(t,2,n,H.min(),H.min(),re.empty(),0)}static newUnknownDocument(t,n){return new Bt(t,3,n,H.min(),H.min(),re.empty(),2)}convertToFoundDocument(t,n){return!this.createTime.isEqual(H.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=re.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=re.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=H.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof Bt&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new Bt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ui{constructor(t,n){this.position=t,this.inclusive=n}}function Gc(e,t,n){let r=0;for(let s=0;s<e.position.length;s++){const i=t[s],o=e.position[s];if(i.field.isKeyField()?r=O.comparator(O.fromName(o.referenceValue),n.key):r=er(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function Xc(e,t){if(e===null)return t===null;if(t===null||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!Re(e.position[n],t.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xr{constructor(t,n="asc"){this.field=t,this.dir=n}}function HE(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bf{}class At extends Bf{constructor(t,n,r){super(),this.field=t,this.op=n,this.value=r}static create(t,n,r){return t.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(t,n,r):new KE(t,n,r):n==="array-contains"?new GE(t,r):n==="in"?new XE(t,r):n==="not-in"?new YE(t,r):n==="array-contains-any"?new JE(t,r):new At(t,n,r)}static createKeyFieldInFilter(t,n,r){return n==="in"?new WE(t,r):new QE(t,r)}matches(t){const n=t.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(er(n,this.value)):n!==null&&Pn(this.value)===Pn(n)&&this.matchesComparison(er(n,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return B()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class Pe extends Bf{constructor(t,n){super(),this.filters=t,this.op=n,this.ce=null}static create(t,n){return new Pe(t,n)}matches(t){return Uf(this)?this.filters.find(n=>!n.matches(t))===void 0:this.filters.find(n=>n.matches(t))!==void 0}getFlattenedFilters(){return this.ce!==null||(this.ce=this.filters.reduce((t,n)=>t.concat(n.getFlattenedFilters()),[])),this.ce}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const t=this.le(n=>n.isInequality());return t!==null?t.field:null}le(t){for(const n of this.getFlattenedFilters())if(t(n))return n;return null}}function Uf(e){return e.op==="and"}function $f(e){return zE(e)&&Uf(e)}function zE(e){for(const t of e.filters)if(t instanceof Pe)return!1;return!0}function oa(e){if(e instanceof At)return e.field.canonicalString()+e.op.toString()+nr(e.value);if($f(e))return e.filters.map(t=>oa(t)).join(",");{const t=e.filters.map(n=>oa(n)).join(",");return`${e.op}(${t})`}}function jf(e,t){return e instanceof At?function(r,s){return s instanceof At&&r.op===s.op&&r.field.isEqual(s.field)&&Re(r.value,s.value)}(e,t):e instanceof Pe?function(r,s){return s instanceof Pe&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,a)=>i&&jf(o,s.filters[a]),!0):!1}(e,t):void B()}function qf(e){return e instanceof At?function(n){return`${n.field.canonicalString()} ${n.op} ${nr(n.value)}`}(e):e instanceof Pe?function(n){return n.op.toString()+" {"+n.getFilters().map(qf).join(" ,")+"}"}(e):"Filter"}class KE extends At{constructor(t,n,r){super(t,n,r),this.key=O.fromName(r.referenceValue)}matches(t){const n=O.comparator(t.key,this.key);return this.matchesComparison(n)}}class WE extends At{constructor(t,n){super(t,"in",n),this.keys=Hf("in",n)}matches(t){return this.keys.some(n=>n.isEqual(t.key))}}class QE extends At{constructor(t,n){super(t,"not-in",n),this.keys=Hf("not-in",n)}matches(t){return!this.keys.some(n=>n.isEqual(t.key))}}function Hf(e,t){var n;return(((n=t.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>O.fromName(r.referenceValue))}class GE extends At{constructor(t,n){super(t,"array-contains",n)}matches(t){const n=t.data.field(this.field);return gl(n)&&ns(n.arrayValue,this.value)}}class XE extends At{constructor(t,n){super(t,"in",n)}matches(t){const n=t.data.field(this.field);return n!==null&&ns(this.value.arrayValue,n)}}class YE extends At{constructor(t,n){super(t,"not-in",n)}matches(t){if(ns(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=t.data.field(this.field);return n!==null&&!ns(this.value.arrayValue,n)}}class JE extends At{constructor(t,n){super(t,"array-contains-any",n)}matches(t){const n=t.data.field(this.field);return!(!gl(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>ns(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZE{constructor(t,n=null,r=[],s=[],i=null,o=null,a=null){this.path=t,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.he=null}}function Yc(e,t=null,n=[],r=[],s=null,i=null,o=null){return new ZE(e,t,n,r,s,i,o)}function ml(e){const t=K(e);if(t.he===null){let n=t.path.canonicalString();t.collectionGroup!==null&&(n+="|cg:"+t.collectionGroup),n+="|f:",n+=t.filters.map(r=>oa(r)).join(","),n+="|ob:",n+=t.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),qi(t.limit)||(n+="|l:",n+=t.limit),t.startAt&&(n+="|lb:",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(r=>nr(r)).join(",")),t.endAt&&(n+="|ub:",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(r=>nr(r)).join(",")),t.he=n}return t.he}function _l(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!HE(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!jf(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!Xc(e.startAt,t.startAt)&&Xc(e.endAt,t.endAt)}function aa(e){return O.isDocumentKey(e.path)&&e.collectionGroup===null&&e.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hi{constructor(t,n=null,r=[],s=[],i=null,o="F",a=null,l=null){this.path=t,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=l,this.Pe=null,this.Ie=null,this.startAt,this.endAt}}function tv(e,t,n,r,s,i,o,a){return new Hi(e,t,n,r,s,i,o,a)}function zf(e){return new Hi(e)}function Jc(e){return e.filters.length===0&&e.limit===null&&e.startAt==null&&e.endAt==null&&(e.explicitOrderBy.length===0||e.explicitOrderBy.length===1&&e.explicitOrderBy[0].field.isKeyField())}function ev(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}function nv(e){for(const t of e.filters){const n=t.getFirstInequalityField();if(n!==null)return n}return null}function rv(e){return e.collectionGroup!==null}function Kn(e){const t=K(e);if(t.Pe===null){t.Pe=[];const n=nv(t),r=ev(t);if(n!==null&&r===null)n.isKeyField()||t.Pe.push(new xr(n)),t.Pe.push(new xr($t.keyField(),"asc"));else{let s=!1;for(const i of t.explicitOrderBy)t.Pe.push(i),i.field.isKeyField()&&(s=!0);if(!s){const i=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.Pe.push(new xr($t.keyField(),i))}}}return t.Pe}function Le(e){const t=K(e);if(!t.Ie)if(t.limitType==="F")t.Ie=Yc(t.path,t.collectionGroup,Kn(t),t.filters,t.limit,t.startAt,t.endAt);else{const n=[];for(const i of Kn(t)){const o=i.dir==="desc"?"asc":"desc";n.push(new xr(i.field,o))}const r=t.endAt?new ui(t.endAt.position,t.endAt.inclusive):null,s=t.startAt?new ui(t.startAt.position,t.startAt.inclusive):null;t.Ie=Yc(t.path,t.collectionGroup,n,t.filters,t.limit,r,s)}return t.Ie}function la(e,t,n){return new Hi(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function zi(e,t){return _l(Le(e),Le(t))&&e.limitType===t.limitType}function Kf(e){return`${ml(Le(e))}|lt:${e.limitType}`}function ca(e){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>qf(s)).join(", ")}]`),qi(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>nr(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>nr(s)).join(",")),`Target(${r})`}(Le(e))}; limitType=${e.limitType})`}function Ki(e,t){return t.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):O.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(e,t)&&function(r,s){for(const i of Kn(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(e,t)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(e,t)&&function(r,s){return!(r.startAt&&!function(o,a,l){const c=Gc(o,a,l);return o.inclusive?c<=0:c<0}(r.startAt,Kn(r),s)||r.endAt&&!function(o,a,l){const c=Gc(o,a,l);return o.inclusive?c>=0:c>0}(r.endAt,Kn(r),s))}(e,t)}function sv(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function Wf(e){return(t,n)=>{let r=!1;for(const s of Kn(e)){const i=iv(s,t,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function iv(e,t,n){const r=e.field.isKeyField()?O.comparator(t.key,n.key):function(i,o,a){const l=o.data.field(i),c=a.data.field(i);return l!==null&&c!==null?er(l,c):B()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return B()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pr{constructor(t,n){this.mapKeyFn=t,this.equalsFn=n,this.inner={},this.innerSize=0}get(t){const n=this.mapKeyFn(t),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,t))return i}}has(t){return this.get(t)!==void 0}set(t,n){const r=this.mapKeyFn(t),s=this.inner[r];if(s===void 0)return this.inner[r]=[[t,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],t))return void(s[i]=[t,n]);s.push([t,n]),this.innerSize++}delete(t){const n=this.mapKeyFn(t),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],t))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(t){dr(this.inner,(n,r)=>{for(const[s,i]of r)t(s,i)})}isEmpty(){return Of(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ov=new gt(O.comparator);function Be(){return ov}const Qf=new gt(O.comparator);function Rr(...e){let t=Qf;for(const n of e)t=t.insert(n.key,n);return t}function Gf(e){let t=Qf;return e.forEach((n,r)=>t=t.insert(n,r.overlayedDocument)),t}function En(){return kr()}function Xf(){return kr()}function kr(){return new pr(e=>e.toString(),(e,t)=>e.isEqual(t))}const av=new gt(O.comparator),lv=new Kt(O.comparator);function G(...e){let t=lv;for(const n of e)t=t.add(n);return t}const cv=new Kt(Z);function uv(){return cv}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yf(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ci(t)?"-0":t}}function Jf(e){return{integerValue:""+e}}function hv(e,t){return UE(t)?Jf(t):Yf(e,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wi{constructor(){this._=void 0}}function fv(e,t,n){return e instanceof hi?function(s,i){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&dl(i)&&(i=pl(i)),i&&(o.fields.__previous_value__=i),{mapValue:o}}(n,t):e instanceof rs?td(e,t):e instanceof ss?ed(e,t):function(s,i){const o=Zf(s,i),a=Zc(o)+Zc(s.Te);return ia(o)&&ia(s.Te)?Jf(a):Yf(s.serializer,a)}(e,t)}function dv(e,t,n){return e instanceof rs?td(e,t):e instanceof ss?ed(e,t):n}function Zf(e,t){return e instanceof fi?function(r){return ia(r)||function(i){return!!i&&"doubleValue"in i}(r)}(t)?t:{integerValue:0}:null}class hi extends Wi{}class rs extends Wi{constructor(t){super(),this.elements=t}}function td(e,t){const n=nd(t);for(const r of e.elements)n.some(s=>Re(s,r))||n.push(r);return{arrayValue:{values:n}}}class ss extends Wi{constructor(t){super(),this.elements=t}}function ed(e,t){let n=nd(t);for(const r of e.elements)n=n.filter(s=>!Re(s,r));return{arrayValue:{values:n}}}class fi extends Wi{constructor(t,n){super(),this.serializer=t,this.Te=n}}function Zc(e){return vt(e.integerValue||e.doubleValue)}function nd(e){return gl(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}function pv(e,t){return e.field.isEqual(t.field)&&function(r,s){return r instanceof rs&&s instanceof rs||r instanceof ss&&s instanceof ss?tr(r.elements,s.elements,Re):r instanceof fi&&s instanceof fi?Re(r.Te,s.Te):r instanceof hi&&s instanceof hi}(e.transform,t.transform)}class gv{constructor(t,n){this.version=t,this.transformResults=n}}class Ne{constructor(t,n){this.updateTime=t,this.exists=n}static none(){return new Ne}static exists(t){return new Ne(void 0,t)}static updateTime(t){return new Ne(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function zs(e,t){return e.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(e.updateTime):e.exists===void 0||e.exists===t.isFoundDocument()}class Qi{}function rd(e,t){if(!e.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return e.isNoDocument()?new id(e.key,Ne.none()):new ys(e.key,e.data,Ne.none());{const n=e.data,r=re.empty();let s=new Kt($t.comparator);for(let i of t.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new Sn(e.key,r,new ce(s.toArray()),Ne.none())}}function mv(e,t,n){e instanceof ys?function(s,i,o){const a=s.value.clone(),l=eu(s.fieldTransforms,i,o.transformResults);a.setAll(l),i.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(e,t,n):e instanceof Sn?function(s,i,o){if(!zs(s.precondition,i))return void i.convertToUnknownDocument(o.version);const a=eu(s.fieldTransforms,i,o.transformResults),l=i.data;l.setAll(sd(s)),l.setAll(a),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(e,t,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,t,n)}function Nr(e,t,n,r){return e instanceof ys?function(i,o,a,l){if(!zs(i.precondition,o))return a;const c=i.value.clone(),u=nu(i.fieldTransforms,l,o);return c.setAll(u),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(e,t,n,r):e instanceof Sn?function(i,o,a,l){if(!zs(i.precondition,o))return a;const c=nu(i.fieldTransforms,l,o),u=o.data;return u.setAll(sd(i)),u.setAll(c),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),a===null?null:a.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(h=>h.field))}(e,t,n,r):function(i,o,a){return zs(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(e,t,n)}function _v(e,t){let n=null;for(const r of e.fieldTransforms){const s=t.data.field(r.field),i=Zf(r.transform,s||null);i!=null&&(n===null&&(n=re.empty()),n.set(r.field,i))}return n||null}function tu(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&tr(r,s,(i,o)=>pv(i,o))}(e.fieldTransforms,t.fieldTransforms)&&(e.type===0?e.value.isEqual(t.value):e.type!==1||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class ys extends Qi{constructor(t,n,r,s=[]){super(),this.key=t,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Sn extends Qi{constructor(t,n,r,s,i=[]){super(),this.key=t,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function sd(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}}),t}function eu(e,t,n){const r=new Map;ft(e.length===n.length);for(let s=0;s<n.length;s++){const i=e[s],o=i.transform,a=t.data.field(i.field);r.set(i.field,dv(o,a,n[s]))}return r}function nu(e,t,n){const r=new Map;for(const s of e){const i=s.transform,o=n.data.field(s.field);r.set(s.field,fv(i,o,t))}return r}class id extends Qi{constructor(t,n){super(),this.key=t,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class yv extends Qi{constructor(t,n){super(),this.key=t,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ev{constructor(t,n,r,s){this.batchId=t,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(t,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(t.key)&&mv(i,t,r[s])}}applyToLocalView(t,n){for(const r of this.baseMutations)r.key.isEqual(t.key)&&(n=Nr(r,t,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(t.key)&&(n=Nr(r,t,n,this.localWriteTime));return n}applyToLocalDocumentSet(t,n){const r=Xf();return this.mutations.forEach(s=>{const i=t.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=n.has(s.key)?null:a;const l=rd(o,a);l!==null&&r.set(s.key,l),o.isValidDocument()||o.convertToNoDocument(H.min())}),r}keys(){return this.mutations.reduce((t,n)=>t.add(n.key),G())}isEqual(t){return this.batchId===t.batchId&&tr(this.mutations,t.mutations,(n,r)=>tu(n,r))&&tr(this.baseMutations,t.baseMutations,(n,r)=>tu(n,r))}}class yl{constructor(t,n,r,s){this.batch=t,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(t,n,r){ft(t.mutations.length===r.length);let s=function(){return av}();const i=t.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new yl(t,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vv{constructor(t,n){this.largestBatchId=t,this.mutation=n}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tv{constructor(t,n){this.count=t,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Et,Y;function wv(e){switch(e){default:return B();case E.CANCELLED:case E.UNKNOWN:case E.DEADLINE_EXCEEDED:case E.RESOURCE_EXHAUSTED:case E.INTERNAL:case E.UNAVAILABLE:case E.UNAUTHENTICATED:return!1;case E.INVALID_ARGUMENT:case E.NOT_FOUND:case E.ALREADY_EXISTS:case E.PERMISSION_DENIED:case E.FAILED_PRECONDITION:case E.ABORTED:case E.OUT_OF_RANGE:case E.UNIMPLEMENTED:case E.DATA_LOSS:return!0}}function od(e){if(e===void 0)return Fe("GRPC error has no .code"),E.UNKNOWN;switch(e){case Et.OK:return E.OK;case Et.CANCELLED:return E.CANCELLED;case Et.UNKNOWN:return E.UNKNOWN;case Et.DEADLINE_EXCEEDED:return E.DEADLINE_EXCEEDED;case Et.RESOURCE_EXHAUSTED:return E.RESOURCE_EXHAUSTED;case Et.INTERNAL:return E.INTERNAL;case Et.UNAVAILABLE:return E.UNAVAILABLE;case Et.UNAUTHENTICATED:return E.UNAUTHENTICATED;case Et.INVALID_ARGUMENT:return E.INVALID_ARGUMENT;case Et.NOT_FOUND:return E.NOT_FOUND;case Et.ALREADY_EXISTS:return E.ALREADY_EXISTS;case Et.PERMISSION_DENIED:return E.PERMISSION_DENIED;case Et.FAILED_PRECONDITION:return E.FAILED_PRECONDITION;case Et.ABORTED:return E.ABORTED;case Et.OUT_OF_RANGE:return E.OUT_OF_RANGE;case Et.UNIMPLEMENTED:return E.UNIMPLEMENTED;case Et.DATA_LOSS:return E.DATA_LOSS;default:return B()}}(Y=Et||(Et={}))[Y.OK=0]="OK",Y[Y.CANCELLED=1]="CANCELLED",Y[Y.UNKNOWN=2]="UNKNOWN",Y[Y.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Y[Y.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Y[Y.NOT_FOUND=5]="NOT_FOUND",Y[Y.ALREADY_EXISTS=6]="ALREADY_EXISTS",Y[Y.PERMISSION_DENIED=7]="PERMISSION_DENIED",Y[Y.UNAUTHENTICATED=16]="UNAUTHENTICATED",Y[Y.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Y[Y.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Y[Y.ABORTED=10]="ABORTED",Y[Y.OUT_OF_RANGE=11]="OUT_OF_RANGE",Y[Y.UNIMPLEMENTED=12]="UNIMPLEMENTED",Y[Y.INTERNAL=13]="INTERNAL",Y[Y.UNAVAILABLE=14]="UNAVAILABLE",Y[Y.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class El{constructor(){this.onExistenceFilterMismatchCallbacks=new Map}static get instance(){return Fs}static getOrCreateInstance(){return Fs===null&&(Fs=new El),Fs}onExistenceFilterMismatch(t){const n=Symbol();return this.onExistenceFilterMismatchCallbacks.set(n,t),()=>this.onExistenceFilterMismatchCallbacks.delete(n)}notifyOnExistenceFilterMismatch(t){this.onExistenceFilterMismatchCallbacks.forEach(n=>n(t))}}let Fs=null;/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Iv(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Av=new zn([4294967295,4294967295],0);function ru(e){const t=Iv().encode(e),n=new RE;return n.update(t),new Uint8Array(n.digest())}function su(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),s=t.getUint32(8,!0),i=t.getUint32(12,!0);return[new zn([n,r],0),new zn([s,i],0)]}class vl{constructor(t,n,r){if(this.bitmap=t,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Pr(`Invalid padding: ${n}`);if(r<0)throw new Pr(`Invalid hash count: ${r}`);if(t.length>0&&this.hashCount===0)throw new Pr(`Invalid hash count: ${r}`);if(t.length===0&&n!==0)throw new Pr(`Invalid padding when bitmap length is 0: ${n}`);this.de=8*t.length-n,this.Ae=zn.fromNumber(this.de)}Re(t,n,r){let s=t.add(n.multiply(zn.fromNumber(r)));return s.compare(Av)===1&&(s=new zn([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Ae).toNumber()}Ve(t){return(this.bitmap[Math.floor(t/8)]&1<<t%8)!=0}mightContain(t){if(this.de===0)return!1;const n=ru(t),[r,s]=su(n);for(let i=0;i<this.hashCount;i++){const o=this.Re(r,s,i);if(!this.Ve(o))return!1}return!0}static create(t,n,r){const s=t%8==0?0:8-t%8,i=new Uint8Array(Math.ceil(t/8)),o=new vl(i,s,n);return r.forEach(a=>o.insert(a)),o}insert(t){if(this.de===0)return;const n=ru(t),[r,s]=su(n);for(let i=0;i<this.hashCount;i++){const o=this.Re(r,s,i);this.me(o)}}me(t){const n=Math.floor(t/8),r=t%8;this.bitmap[n]|=1<<r}}class Pr extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gi{constructor(t,n,r,s,i){this.snapshotVersion=t,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(t,n,r){const s=new Map;return s.set(t,Es.createSynthesizedTargetChangeForCurrentChange(t,n,r)),new Gi(H.min(),s,new gt(Z),Be(),G())}}class Es{constructor(t,n,r,s,i){this.resumeToken=t,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(t,n,r){return new Es(r,n,G(),G(),G())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ks{constructor(t,n,r,s){this.fe=t,this.removedTargetIds=n,this.key=r,this.ge=s}}class ad{constructor(t,n){this.targetId=t,this.pe=n}}class ld{constructor(t,n,r=Wt.EMPTY_BYTE_STRING,s=null){this.state=t,this.targetIds=n,this.resumeToken=r,this.cause=s}}class iu{constructor(){this.ye=0,this.we=au(),this.Se=Wt.EMPTY_BYTE_STRING,this.be=!1,this.De=!0}get current(){return this.be}get resumeToken(){return this.Se}get ve(){return this.ye!==0}get Ce(){return this.De}Fe(t){t.approximateByteSize()>0&&(this.De=!0,this.Se=t)}Me(){let t=G(),n=G(),r=G();return this.we.forEach((s,i)=>{switch(i){case 0:t=t.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:B()}}),new Es(this.Se,this.be,t,n,r)}xe(){this.De=!1,this.we=au()}Oe(t,n){this.De=!0,this.we=this.we.insert(t,n)}Ne(t){this.De=!0,this.we=this.we.remove(t)}Be(){this.ye+=1}Le(){this.ye-=1}ke(){this.De=!0,this.be=!0}}class Rv{constructor(t){this.qe=t,this.Qe=new Map,this.Ke=Be(),this.$e=ou(),this.Ue=new gt(Z)}We(t){for(const n of t.fe)t.ge&&t.ge.isFoundDocument()?this.Ge(n,t.ge):this.ze(n,t.key,t.ge);for(const n of t.removedTargetIds)this.ze(n,t.key,t.ge)}je(t){this.forEachTarget(t,n=>{const r=this.He(n);switch(t.state){case 0:this.Je(n)&&r.Fe(t.resumeToken);break;case 1:r.Le(),r.ve||r.xe(),r.Fe(t.resumeToken);break;case 2:r.Le(),r.ve||this.removeTarget(n);break;case 3:this.Je(n)&&(r.ke(),r.Fe(t.resumeToken));break;case 4:this.Je(n)&&(this.Ye(n),r.Fe(t.resumeToken));break;default:B()}})}forEachTarget(t,n){t.targetIds.length>0?t.targetIds.forEach(n):this.Qe.forEach((r,s)=>{this.Je(s)&&n(s)})}Ze(t){var n,r;const s=t.targetId,i=t.pe.count,o=this.Xe(s);if(o){const a=o.target;if(aa(a))if(i===0){const l=new O(a.path);this.ze(s,l,Bt.newNoDocument(l,H.min()))}else ft(i===1);else{const l=this.et(s);if(l!==i){const c=this.tt(t,l);if(c.status!==0){this.Ye(s);const u=c.status===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ue=this.Ue.insert(s,u)}(n=El.instance)===null||n===void 0||n.notifyOnExistenceFilterMismatch(function(h,d,g,P){var I,b,F,U,W,w;const L={localCacheCount:g,existenceFilterCount:P.count},X=P.unchangedNames;return X&&(L.bloomFilter={applied:h===0,hashCount:(I=X==null?void 0:X.hashCount)!==null&&I!==void 0?I:0,bitmapLength:(U=(F=(b=X==null?void 0:X.bits)===null||b===void 0?void 0:b.bitmap)===null||F===void 0?void 0:F.length)!==null&&U!==void 0?U:0,padding:(w=(W=X==null?void 0:X.bits)===null||W===void 0?void 0:W.padding)!==null&&w!==void 0?w:0},d&&(L.bloomFilter.mightContain=d)),L}(c.status,(r=c.nt)!==null&&r!==void 0?r:null,l,t.pe))}}}}tt(t,n){const{unchangedNames:r,count:s}=t.pe;if(!r||!r.bits)return{status:1};const{bits:{bitmap:i="",padding:o=0},hashCount:a=0}=r;let l,c;try{l=Rn(i).toUint8Array()}catch(h){if(h instanceof Ff)return Zn("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),{status:1};throw h}try{c=new vl(l,o,a)}catch(h){return Zn(h instanceof Pr?"BloomFilter error: ":"Applying bloom filter failed: ",h),{status:1}}const u=h=>{const d=this.qe.rt();return c.mightContain(`projects/${d.projectId}/databases/${d.database}/documents/${h}`)};return c.de===0?{status:1}:{status:s===n-this.it(t.targetId,u)?0:2,nt:u}}it(t,n){const r=this.qe.getRemoteKeysForTarget(t);let s=0;return r.forEach(i=>{n(i.path.canonicalString())||(this.ze(t,i,null),s++)}),s}st(t){const n=new Map;this.Qe.forEach((i,o)=>{const a=this.Xe(o);if(a){if(i.current&&aa(a.target)){const l=new O(a.target.path);this.Ke.get(l)!==null||this.ot(o,l)||this.ze(o,l,Bt.newNoDocument(l,t))}i.Ce&&(n.set(o,i.Me()),i.xe())}});let r=G();this.$e.forEach((i,o)=>{let a=!0;o.forEachWhile(l=>{const c=this.Xe(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(i))}),this.Ke.forEach((i,o)=>o.setReadTime(t));const s=new Gi(t,n,this.Ue,this.Ke,r);return this.Ke=Be(),this.$e=ou(),this.Ue=new gt(Z),s}Ge(t,n){if(!this.Je(t))return;const r=this.ot(t,n.key)?2:0;this.He(t).Oe(n.key,r),this.Ke=this.Ke.insert(n.key,n),this.$e=this.$e.insert(n.key,this._t(n.key).add(t))}ze(t,n,r){if(!this.Je(t))return;const s=this.He(t);this.ot(t,n)?s.Oe(n,1):s.Ne(n),this.$e=this.$e.insert(n,this._t(n).delete(t)),r&&(this.Ke=this.Ke.insert(n,r))}removeTarget(t){this.Qe.delete(t)}et(t){const n=this.He(t).Me();return this.qe.getRemoteKeysForTarget(t).size+n.addedDocuments.size-n.removedDocuments.size}Be(t){this.He(t).Be()}He(t){let n=this.Qe.get(t);return n||(n=new iu,this.Qe.set(t,n)),n}_t(t){let n=this.$e.get(t);return n||(n=new Kt(Z),this.$e=this.$e.insert(t,n)),n}Je(t){const n=this.Xe(t)!==null;return n||x("WatchChangeAggregator","Detected inactive target",t),n}Xe(t){const n=this.Qe.get(t);return n&&n.ve?null:this.qe.ut(t)}Ye(t){this.Qe.set(t,new iu),this.qe.getRemoteKeysForTarget(t).forEach(n=>{this.ze(t,n,null)})}ot(t,n){return this.qe.getRemoteKeysForTarget(t).has(n)}}function ou(){return new gt(O.comparator)}function au(){return new gt(O.comparator)}const Pv=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),Cv=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),Sv=(()=>({and:"AND",or:"OR"}))();class bv{constructor(t,n){this.databaseId=t,this.useProto3Json=n}}function ua(e,t){return e.useProto3Json||qi(t)?t:{value:t}}function di(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function cd(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function Vv(e,t){return di(e,t.toTimestamp())}function Ie(e){return ft(!!e),H.fromTimestamp(function(n){const r=nn(n);return new Rt(r.seconds,r.nanos)}(e))}function Tl(e,t){return function(r){return new dt(["projects",r.projectId,"databases",r.database])}(e).child("documents").child(t).canonicalString()}function ud(e){const t=dt.fromString(e);return ft(pd(t)),t}function ha(e,t){return Tl(e.databaseId,t.path)}function Io(e,t){const n=ud(t);if(n.get(1)!==e.databaseId.projectId)throw new M(E.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new M(E.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new O(hd(n))}function fa(e,t){return Tl(e.databaseId,t)}function Dv(e){const t=ud(e);return t.length===4?dt.emptyPath():hd(t)}function da(e){return new dt(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function hd(e){return ft(e.length>4&&e.get(4)==="documents"),e.popFirst(5)}function lu(e,t,n){return{name:ha(e,t),fields:n.value.mapValue.fields}}function xv(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:B()}(t.targetChange.targetChangeType||"NO_CHANGE"),s=t.targetChange.targetIds||[],i=function(c,u){return c.useProto3Json?(ft(u===void 0||typeof u=="string"),Wt.fromBase64String(u||"")):(ft(u===void 0||u instanceof Uint8Array),Wt.fromUint8Array(u||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,a=o&&function(c){const u=c.code===void 0?E.UNKNOWN:od(c.code);return new M(u,c.message||"")}(o);n=new ld(r,s,i,a||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const s=Io(e,r.document.name),i=Ie(r.document.updateTime),o=r.document.createTime?Ie(r.document.createTime):H.min(),a=new re({mapValue:{fields:r.document.fields}}),l=Bt.newFoundDocument(s,i,o,a),c=r.targetIds||[],u=r.removedTargetIds||[];n=new Ks(c,u,l.key,l)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const s=Io(e,r.document),i=r.readTime?Ie(r.readTime):H.min(),o=Bt.newNoDocument(s,i),a=r.removedTargetIds||[];n=new Ks([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const s=Io(e,r.document),i=r.removedTargetIds||[];n=new Ks([],i,s,null)}else{if(!("filter"in t))return B();{t.filter;const r=t.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new Tv(s,i),a=r.targetId;n=new ad(a,o)}}return n}function kv(e,t){let n;if(t instanceof ys)n={update:lu(e,t.key,t.value)};else if(t instanceof id)n={delete:ha(e,t.key)};else if(t instanceof Sn)n={update:lu(e,t.key,t.data),updateMask:jv(t.fieldMask)};else{if(!(t instanceof yv))return B();n={verify:ha(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(r=>function(i,o){const a=o.transform;if(a instanceof hi)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof rs)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof ss)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof fi)return{fieldPath:o.field.canonicalString(),increment:a.Te};throw B()}(0,r))),t.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:Vv(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:B()}(e,t.precondition)),n}function Nv(e,t){return e&&e.length>0?(ft(t!==void 0),e.map(n=>function(s,i){let o=s.updateTime?Ie(s.updateTime):Ie(i);return o.isEqual(H.min())&&(o=Ie(i)),new gv(o,s.transformResults||[])}(n,t))):[]}function Mv(e,t){return{documents:[fa(e,t.path)]}}function Ov(e,t){const n={structuredQuery:{}},r=t.path;t.collectionGroup!==null?(n.parent=fa(e,r),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=fa(e,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);const s=function(l){if(l.length!==0)return dd(Pe.create(l,"and"))}(t.filters);s&&(n.structuredQuery.where=s);const i=function(l){if(l.length!==0)return l.map(c=>function(h){return{field:Nn(h.field),direction:Bv(h.dir)}}(c))}(t.orderBy);i&&(n.structuredQuery.orderBy=i);const o=ua(e,t.limit);return o!==null&&(n.structuredQuery.limit=o),t.startAt&&(n.structuredQuery.startAt=function(l){return{before:l.inclusive,values:l.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(t.endAt)),n}function Fv(e){let t=Dv(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){ft(r===1);const u=n.from[0];u.allDescendants?s=u.collectionId:t=t.child(u.collectionId)}let i=[];n.where&&(i=function(h){const d=fd(h);return d instanceof Pe&&$f(d)?d.getFilters():[d]}(n.where));let o=[];n.orderBy&&(o=function(h){return h.map(d=>function(P){return new xr(Mn(P.field),function(b){switch(b){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(P.direction))}(d))}(n.orderBy));let a=null;n.limit&&(a=function(h){let d;return d=typeof h=="object"?h.value:h,qi(d)?null:d}(n.limit));let l=null;n.startAt&&(l=function(h){const d=!!h.before,g=h.values||[];return new ui(g,d)}(n.startAt));let c=null;return n.endAt&&(c=function(h){const d=!h.before,g=h.values||[];return new ui(g,d)}(n.endAt)),tv(t,s,o,i,a,"F",l,c)}function Lv(e,t){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return B()}}(t.purpose);return n==null?null:{"goog-listen-tags":n}}function fd(e){return e.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Mn(n.unaryFilter.field);return At.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Mn(n.unaryFilter.field);return At.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Mn(n.unaryFilter.field);return At.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Mn(n.unaryFilter.field);return At.create(o,"!=",{nullValue:"NULL_VALUE"});default:return B()}}(e):e.fieldFilter!==void 0?function(n){return At.create(Mn(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return B()}}(n.fieldFilter.op),n.fieldFilter.value)}(e):e.compositeFilter!==void 0?function(n){return Pe.create(n.compositeFilter.filters.map(r=>fd(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return B()}}(n.compositeFilter.op))}(e):B()}function Bv(e){return Pv[e]}function Uv(e){return Cv[e]}function $v(e){return Sv[e]}function Nn(e){return{fieldPath:e.canonicalString()}}function Mn(e){return $t.fromServerFormat(e.fieldPath)}function dd(e){return e instanceof At?function(n){if(n.op==="=="){if(Qc(n.value))return{unaryFilter:{field:Nn(n.field),op:"IS_NAN"}};if(Wc(n.value))return{unaryFilter:{field:Nn(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(Qc(n.value))return{unaryFilter:{field:Nn(n.field),op:"IS_NOT_NAN"}};if(Wc(n.value))return{unaryFilter:{field:Nn(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Nn(n.field),op:Uv(n.op),value:n.value}}}(e):e instanceof Pe?function(n){const r=n.getFilters().map(s=>dd(s));return r.length===1?r[0]:{compositeFilter:{op:$v(n.op),filters:r}}}(e):B()}function jv(e){const t=[];return e.fields.forEach(n=>t.push(n.canonicalString())),{fieldPaths:t}}function pd(e){return e.length>=4&&e.get(0)==="projects"&&e.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ze{constructor(t,n,r,s,i=H.min(),o=H.min(),a=Wt.EMPTY_BYTE_STRING,l=null){this.target=t,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(t){return new ze(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,n){return new ze(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new ze(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new ze(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qv{constructor(t){this.ct=t}}function Hv(e){const t=Fv({parent:e.parent,structuredQuery:e.structuredQuery});return e.limitType==="LAST"?la(t,t.limit,"L"):t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zv{constructor(){this.sn=new Kv}addToCollectionParentIndex(t,n){return this.sn.add(n),T.resolve()}getCollectionParents(t,n){return T.resolve(this.sn.getEntries(n))}addFieldIndex(t,n){return T.resolve()}deleteFieldIndex(t,n){return T.resolve()}getDocumentsMatchingTarget(t,n){return T.resolve(null)}getIndexType(t,n){return T.resolve(0)}getFieldIndexes(t,n){return T.resolve([])}getNextCollectionGroupToUpdate(t){return T.resolve(null)}getMinOffset(t,n){return T.resolve(en.min())}getMinOffsetFromCollectionGroup(t,n){return T.resolve(en.min())}updateCollectionGroup(t,n,r){return T.resolve()}updateIndexEntries(t,n){return T.resolve()}}class Kv{constructor(){this.index={}}add(t){const n=t.lastSegment(),r=t.popLast(),s=this.index[n]||new Kt(dt.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(t){const n=t.lastSegment(),r=t.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(t){return(this.index[t]||new Kt(dt.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rr{constructor(t){this.Mn=t}next(){return this.Mn+=2,this.Mn}static xn(){return new rr(0)}static On(){return new rr(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wv{constructor(){this.changes=new pr(t=>t.toString(),(t,n)=>t.isEqual(n)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,n){this.assertNotApplied(),this.changes.set(t,Bt.newInvalidDocument(t).setReadTime(n))}getEntry(t,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?T.resolve(r):this.getFromCache(t,n)}getEntries(t,n){return this.getAllFromCache(t,n)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qv{constructor(t,n){this.overlayedDocument=t,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gv{constructor(t,n,r,s){this.remoteDocumentCache=t,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(t,n){let r=null;return this.documentOverlayCache.getOverlay(t,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(t,n))).next(s=>(r!==null&&Nr(r.mutation,s,ce.empty(),Rt.now()),s))}getDocuments(t,n){return this.remoteDocumentCache.getEntries(t,n).next(r=>this.getLocalViewOfDocuments(t,r,G()).next(()=>r))}getLocalViewOfDocuments(t,n,r=G()){const s=En();return this.populateOverlays(t,s,n).next(()=>this.computeViews(t,n,s,r).next(i=>{let o=Rr();return i.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(t,n){const r=En();return this.populateOverlays(t,r,n).next(()=>this.computeViews(t,n,r,G()))}populateOverlays(t,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(t,s).next(i=>{i.forEach((o,a)=>{n.set(o,a)})})}computeViews(t,n,r,s){let i=Be();const o=kr(),a=function(){return kr()}();return n.forEach((l,c)=>{const u=r.get(c.key);s.has(c.key)&&(u===void 0||u.mutation instanceof Sn)?i=i.insert(c.key,c):u!==void 0?(o.set(c.key,u.mutation.getFieldMask()),Nr(u.mutation,c,u.mutation.getFieldMask(),Rt.now())):o.set(c.key,ce.empty())}),this.recalculateAndSaveOverlays(t,i).next(l=>(l.forEach((c,u)=>o.set(c,u)),n.forEach((c,u)=>{var h;return a.set(c,new Qv(u,(h=o.get(c))!==null&&h!==void 0?h:null))}),a))}recalculateAndSaveOverlays(t,n){const r=kr();let s=new gt((o,a)=>o-a),i=G();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const c=n.get(l);if(c===null)return;let u=r.get(l)||ce.empty();u=a.applyToLocalView(c,u),r.set(l,u);const h=(s.get(a.batchId)||G()).add(l);s=s.insert(a.batchId,h)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),c=l.key,u=l.value,h=Xf();u.forEach(d=>{if(!i.has(d)){const g=rd(n.get(d),r.get(d));g!==null&&h.set(d,g),i=i.add(d)}}),o.push(this.documentOverlayCache.saveOverlays(t,c,h))}return T.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(t,n){return this.remoteDocumentCache.getEntries(t,n).next(r=>this.recalculateAndSaveOverlays(t,r))}getDocumentsMatchingQuery(t,n,r){return function(i){return O.isDocumentKey(i.path)&&i.collectionGroup===null&&i.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(t,n.path):rv(n)?this.getDocumentsMatchingCollectionGroupQuery(t,n,r):this.getDocumentsMatchingCollectionQuery(t,n,r)}getNextDocuments(t,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(t,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,n,r.largestBatchId,s-i.size):T.resolve(En());let a=-1,l=i;return o.next(c=>T.forEach(c,(u,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),i.get(u)?T.resolve():this.remoteDocumentCache.getEntry(t,u).next(d=>{l=l.insert(u,d)}))).next(()=>this.populateOverlays(t,c,i)).next(()=>this.computeViews(t,l,c,G())).next(u=>({batchId:a,changes:Gf(u)})))})}getDocumentsMatchingDocumentQuery(t,n){return this.getDocument(t,new O(n)).next(r=>{let s=Rr();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(t,n,r){const s=n.collectionGroup;let i=Rr();return this.indexManager.getCollectionParents(t,s).next(o=>T.forEach(o,a=>{const l=function(u,h){return new Hi(h,null,u.explicitOrderBy.slice(),u.filters.slice(),u.limit,u.limitType,u.startAt,u.endAt)}(n,a.child(s));return this.getDocumentsMatchingCollectionQuery(t,l,r).next(c=>{c.forEach((u,h)=>{i=i.insert(u,h)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(t,n,r){let s;return this.documentOverlayCache.getOverlaysForCollection(t,n.path,r.largestBatchId).next(i=>(s=i,this.remoteDocumentCache.getDocumentsMatchingQuery(t,n,r,s))).next(i=>{s.forEach((a,l)=>{const c=l.getKey();i.get(c)===null&&(i=i.insert(c,Bt.newInvalidDocument(c)))});let o=Rr();return i.forEach((a,l)=>{const c=s.get(a);c!==void 0&&Nr(c.mutation,l,ce.empty(),Rt.now()),Ki(n,l)&&(o=o.insert(a,l))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xv{constructor(t){this.serializer=t,this.ar=new Map,this.ur=new Map}getBundleMetadata(t,n){return T.resolve(this.ar.get(n))}saveBundleMetadata(t,n){return this.ar.set(n.id,function(s){return{id:s.id,version:s.version,createTime:Ie(s.createTime)}}(n)),T.resolve()}getNamedQuery(t,n){return T.resolve(this.ur.get(n))}saveNamedQuery(t,n){return this.ur.set(n.name,function(s){return{name:s.name,query:Hv(s.bundledQuery),readTime:Ie(s.readTime)}}(n)),T.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yv{constructor(){this.overlays=new gt(O.comparator),this.cr=new Map}getOverlay(t,n){return T.resolve(this.overlays.get(n))}getOverlays(t,n){const r=En();return T.forEach(n,s=>this.getOverlay(t,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(t,n,r){return r.forEach((s,i)=>{this.ht(t,n,i)}),T.resolve()}removeOverlaysForBatchId(t,n,r){const s=this.cr.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.cr.delete(r)),T.resolve()}getOverlaysForCollection(t,n,r){const s=En(),i=n.length+1,o=new O(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,c=l.getKey();if(!n.isPrefixOf(c.path))break;c.path.length===i&&l.largestBatchId>r&&s.set(l.getKey(),l)}return T.resolve(s)}getOverlaysForCollectionGroup(t,n,r,s){let i=new gt((c,u)=>c-u);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===n&&c.largestBatchId>r){let u=i.get(c.largestBatchId);u===null&&(u=En(),i=i.insert(c.largestBatchId,u)),u.set(c.getKey(),c)}}const a=En(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,u)=>a.set(c,u)),!(a.size()>=s)););return T.resolve(a)}ht(t,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.cr.get(s.largestBatchId).delete(r.key);this.cr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new vv(n,r));let i=this.cr.get(n);i===void 0&&(i=G(),this.cr.set(n,i)),this.cr.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wl{constructor(){this.lr=new Kt(St.hr),this.Pr=new Kt(St.Ir)}isEmpty(){return this.lr.isEmpty()}addReference(t,n){const r=new St(t,n);this.lr=this.lr.add(r),this.Pr=this.Pr.add(r)}Tr(t,n){t.forEach(r=>this.addReference(r,n))}removeReference(t,n){this.Er(new St(t,n))}dr(t,n){t.forEach(r=>this.removeReference(r,n))}Ar(t){const n=new O(new dt([])),r=new St(n,t),s=new St(n,t+1),i=[];return this.Pr.forEachInRange([r,s],o=>{this.Er(o),i.push(o.key)}),i}Rr(){this.lr.forEach(t=>this.Er(t))}Er(t){this.lr=this.lr.delete(t),this.Pr=this.Pr.delete(t)}Vr(t){const n=new O(new dt([])),r=new St(n,t),s=new St(n,t+1);let i=G();return this.Pr.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(t){const n=new St(t,0),r=this.lr.firstAfterOrEqual(n);return r!==null&&t.isEqual(r.key)}}class St{constructor(t,n){this.key=t,this.mr=n}static hr(t,n){return O.comparator(t.key,n.key)||Z(t.mr,n.mr)}static Ir(t,n){return Z(t.mr,n.mr)||O.comparator(t.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jv{constructor(t,n){this.indexManager=t,this.referenceDelegate=n,this.mutationQueue=[],this.gr=1,this.pr=new Kt(St.hr)}checkEmpty(t){return T.resolve(this.mutationQueue.length===0)}addMutationBatch(t,n,r,s){const i=this.gr;this.gr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Ev(i,n,r,s);this.mutationQueue.push(o);for(const a of s)this.pr=this.pr.add(new St(a.key,i)),this.indexManager.addToCollectionParentIndex(t,a.key.path.popLast());return T.resolve(o)}lookupMutationBatch(t,n){return T.resolve(this.yr(n))}getNextMutationBatchAfterBatchId(t,n){const r=n+1,s=this.wr(r),i=s<0?0:s;return T.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return T.resolve(this.mutationQueue.length===0?-1:this.gr-1)}getAllMutationBatches(t){return T.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,n){const r=new St(n,0),s=new St(n,Number.POSITIVE_INFINITY),i=[];return this.pr.forEachInRange([r,s],o=>{const a=this.yr(o.mr);i.push(a)}),T.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(t,n){let r=new Kt(Z);return n.forEach(s=>{const i=new St(s,0),o=new St(s,Number.POSITIVE_INFINITY);this.pr.forEachInRange([i,o],a=>{r=r.add(a.mr)})}),T.resolve(this.Sr(r))}getAllMutationBatchesAffectingQuery(t,n){const r=n.path,s=r.length+1;let i=r;O.isDocumentKey(i)||(i=i.child(""));const o=new St(new O(i),0);let a=new Kt(Z);return this.pr.forEachWhile(l=>{const c=l.key.path;return!!r.isPrefixOf(c)&&(c.length===s&&(a=a.add(l.mr)),!0)},o),T.resolve(this.Sr(a))}Sr(t){const n=[];return t.forEach(r=>{const s=this.yr(r);s!==null&&n.push(s)}),n}removeMutationBatch(t,n){ft(this.br(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.pr;return T.forEach(n.mutations,s=>{const i=new St(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(t,s.key)}).next(()=>{this.pr=r})}Cn(t){}containsKey(t,n){const r=new St(n,0),s=this.pr.firstAfterOrEqual(r);return T.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(t){return this.mutationQueue.length,T.resolve()}br(t,n){return this.wr(t)}wr(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}yr(t){const n=this.wr(t);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zv{constructor(t){this.Dr=t,this.docs=function(){return new gt(O.comparator)}(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.Dr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(t,r.path.popLast())}removeEntry(t){const n=this.docs.get(t);n&&(this.docs=this.docs.remove(t),this.size-=n.size)}getEntry(t,n){const r=this.docs.get(n);return T.resolve(r?r.document.mutableCopy():Bt.newInvalidDocument(n))}getEntries(t,n){let r=Be();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Bt.newInvalidDocument(s))}),T.resolve(r)}getDocumentsMatchingQuery(t,n,r,s){let i=Be();const o=n.path,a=new O(o.child("")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:c,value:{document:u}}=l.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||FE(OE(u),r)<=0||(s.has(u.key)||Ki(n,u))&&(i=i.insert(u.key,u.mutableCopy()))}return T.resolve(i)}getAllFromCollectionGroup(t,n,r,s){B()}vr(t,n){return T.forEach(this.docs,r=>n(r))}newChangeBuffer(t){return new tT(this)}getSize(t){return T.resolve(this.size)}}class tT extends Wv{constructor(t){super(),this.sr=t}applyChanges(t){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.sr.addEntry(t,s)):this.sr.removeEntry(r)}),T.waitFor(n)}getFromCache(t,n){return this.sr.getEntry(t,n)}getAllFromCache(t,n){return this.sr.getEntries(t,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eT{constructor(t){this.persistence=t,this.Cr=new pr(n=>ml(n),_l),this.lastRemoteSnapshotVersion=H.min(),this.highestTargetId=0,this.Fr=0,this.Mr=new wl,this.targetCount=0,this.Or=rr.xn()}forEachTarget(t,n){return this.Cr.forEach((r,s)=>n(s)),T.resolve()}getLastRemoteSnapshotVersion(t){return T.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return T.resolve(this.Fr)}allocateTargetId(t){return this.highestTargetId=this.Or.next(),T.resolve(this.highestTargetId)}setTargetsMetadata(t,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Fr&&(this.Fr=n),T.resolve()}Ln(t){this.Cr.set(t.target,t);const n=t.targetId;n>this.highestTargetId&&(this.Or=new rr(n),this.highestTargetId=n),t.sequenceNumber>this.Fr&&(this.Fr=t.sequenceNumber)}addTargetData(t,n){return this.Ln(n),this.targetCount+=1,T.resolve()}updateTargetData(t,n){return this.Ln(n),T.resolve()}removeTargetData(t,n){return this.Cr.delete(n.target),this.Mr.Ar(n.targetId),this.targetCount-=1,T.resolve()}removeTargets(t,n,r){let s=0;const i=[];return this.Cr.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.Cr.delete(o),i.push(this.removeMatchingKeysForTargetId(t,a.targetId)),s++)}),T.waitFor(i).next(()=>s)}getTargetCount(t){return T.resolve(this.targetCount)}getTargetData(t,n){const r=this.Cr.get(n)||null;return T.resolve(r)}addMatchingKeys(t,n,r){return this.Mr.Tr(n,r),T.resolve()}removeMatchingKeys(t,n,r){this.Mr.dr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(t,o))}),T.waitFor(i)}removeMatchingKeysForTargetId(t,n){return this.Mr.Ar(n),T.resolve()}getMatchingKeysForTargetId(t,n){const r=this.Mr.Vr(n);return T.resolve(r)}containsKey(t,n){return T.resolve(this.Mr.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nT{constructor(t,n){this.Nr={},this.overlays={},this.Br=new fl(0),this.Lr=!1,this.Lr=!0,this.referenceDelegate=t(this),this.kr=new eT(this),this.indexManager=new zv,this.remoteDocumentCache=function(s){return new Zv(s)}(r=>this.referenceDelegate.qr(r)),this.serializer=new qv(n),this.Qr=new Xv(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Lr=!1,Promise.resolve()}get started(){return this.Lr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let n=this.overlays[t.toKey()];return n||(n=new Yv,this.overlays[t.toKey()]=n),n}getMutationQueue(t,n){let r=this.Nr[t.toKey()];return r||(r=new Jv(n,this.referenceDelegate),this.Nr[t.toKey()]=r),r}getTargetCache(){return this.kr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Qr}runTransaction(t,n,r){x("MemoryPersistence","Starting transaction:",t);const s=new rT(this.Br.next());return this.referenceDelegate.Kr(),r(s).next(i=>this.referenceDelegate.$r(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ur(t,n){return T.or(Object.values(this.Nr).map(r=>()=>r.containsKey(t,n)))}}class rT extends BE{constructor(t){super(),this.currentSequenceNumber=t}}class Il{constructor(t){this.persistence=t,this.Wr=new wl,this.Gr=null}static zr(t){return new Il(t)}get jr(){if(this.Gr)return this.Gr;throw B()}addReference(t,n,r){return this.Wr.addReference(r,n),this.jr.delete(r.toString()),T.resolve()}removeReference(t,n,r){return this.Wr.removeReference(r,n),this.jr.add(r.toString()),T.resolve()}markPotentiallyOrphaned(t,n){return this.jr.add(n.toString()),T.resolve()}removeTarget(t,n){this.Wr.Ar(n.targetId).forEach(s=>this.jr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,n.targetId).next(s=>{s.forEach(i=>this.jr.add(i.toString()))}).next(()=>r.removeTargetData(t,n))}Kr(){this.Gr=new Set}$r(t){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return T.forEach(this.jr,r=>{const s=O.fromPath(r);return this.Hr(t,s).next(i=>{i||n.removeEntry(s,H.min())})}).next(()=>(this.Gr=null,n.apply(t)))}updateLimboDocument(t,n){return this.Hr(t,n).next(r=>{r?this.jr.delete(n.toString()):this.jr.add(n.toString())})}qr(t){return 0}Hr(t,n){return T.or([()=>T.resolve(this.Wr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(t,n),()=>this.persistence.Ur(t,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Al{constructor(t,n,r,s){this.targetId=t,this.fromCache=n,this.Li=r,this.ki=s}static qi(t,n){let r=G(),s=G();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Al(t,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sT{constructor(){this.Qi=!1}initialize(t,n){this.Ki=t,this.indexManager=n,this.Qi=!0}getDocumentsMatchingQuery(t,n,r,s){return this.$i(t,n).next(i=>i||this.Ui(t,n,s,r)).next(i=>i||this.Wi(t,n))}$i(t,n){if(Jc(n))return T.resolve(null);let r=Le(n);return this.indexManager.getIndexType(t,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=la(n,null,"F"),r=Le(n)),this.indexManager.getDocumentsMatchingTarget(t,r).next(i=>{const o=G(...i);return this.Ki.getDocuments(t,o).next(a=>this.indexManager.getMinOffset(t,r).next(l=>{const c=this.Gi(n,a);return this.zi(n,c,o,l.readTime)?this.$i(t,la(n,null,"F")):this.ji(t,c,n,l)}))})))}Ui(t,n,r,s){return Jc(n)||s.isEqual(H.min())?this.Wi(t,n):this.Ki.getDocuments(t,r).next(i=>{const o=this.Gi(n,i);return this.zi(n,o,r,s)?this.Wi(t,n):(qc()<=et.DEBUG&&x("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),ca(n)),this.ji(t,o,n,ME(s,-1)))})}Gi(t,n){let r=new Kt(Wf(t));return n.forEach((s,i)=>{Ki(t,i)&&(r=r.add(i))}),r}zi(t,n,r,s){if(t.limit===null)return!1;if(r.size!==n.size)return!0;const i=t.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Wi(t,n){return qc()<=et.DEBUG&&x("QueryEngine","Using full collection scan to execute query:",ca(n)),this.Ki.getDocumentsMatchingQuery(t,n,en.min())}ji(t,n,r,s){return this.Ki.getDocumentsMatchingQuery(t,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iT{constructor(t,n,r,s){this.persistence=t,this.Hi=n,this.serializer=s,this.Ji=new gt(Z),this.Yi=new pr(i=>ml(i),_l),this.Zi=new Map,this.Xi=t.getRemoteDocumentCache(),this.kr=t.getTargetCache(),this.Qr=t.getBundleCache(),this.es(r)}es(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new Gv(this.Xi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Xi.setIndexManager(this.indexManager),this.Hi.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>t.collect(n,this.Ji))}}function oT(e,t,n,r){return new iT(e,t,n,r)}async function gd(e,t){const n=K(e);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.es(t),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let l=G();for(const c of s){o.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}for(const c of i){a.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}return n.localDocuments.getDocuments(r,l).next(c=>({ts:c,removedBatchIds:o,addedBatchIds:a}))})})}function aT(e,t){const n=K(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=t.batch.keys(),i=n.Xi.newChangeBuffer({trackRemovals:!0});return function(a,l,c,u){const h=c.batch,d=h.keys();let g=T.resolve();return d.forEach(P=>{g=g.next(()=>u.getEntry(l,P)).next(I=>{const b=c.docVersions.get(P);ft(b!==null),I.version.compareTo(b)<0&&(h.applyToRemoteDocument(I,c),I.isValidDocument()&&(I.setReadTime(c.commitVersion),u.addEntry(I)))})}),g.next(()=>a.mutationQueue.removeMutationBatch(l,h))}(n,r,t,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,t.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=G();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(l=l.add(a.batch.mutations[c].key));return l}(t))).next(()=>n.localDocuments.getDocuments(r,s))})}function md(e){const t=K(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",n=>t.kr.getLastRemoteSnapshotVersion(n))}function lT(e,t){const n=K(e),r=t.snapshotVersion;let s=n.Ji;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.Xi.newChangeBuffer({trackRemovals:!0});s=n.Ji;const a=[];t.targetChanges.forEach((u,h)=>{const d=s.get(h);if(!d)return;a.push(n.kr.removeMatchingKeys(i,u.removedDocuments,h).next(()=>n.kr.addMatchingKeys(i,u.addedDocuments,h)));let g=d.withSequenceNumber(i.currentSequenceNumber);t.targetMismatches.get(h)!==null?g=g.withResumeToken(Wt.EMPTY_BYTE_STRING,H.min()).withLastLimboFreeSnapshotVersion(H.min()):u.resumeToken.approximateByteSize()>0&&(g=g.withResumeToken(u.resumeToken,r)),s=s.insert(h,g),function(I,b,F){return I.resumeToken.approximateByteSize()===0||b.snapshotVersion.toMicroseconds()-I.snapshotVersion.toMicroseconds()>=3e8?!0:F.addedDocuments.size+F.modifiedDocuments.size+F.removedDocuments.size>0}(d,g,u)&&a.push(n.kr.updateTargetData(i,g))});let l=Be(),c=G();if(t.documentUpdates.forEach(u=>{t.resolvedLimboDocuments.has(u)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(i,u))}),a.push(cT(i,o,t.documentUpdates).next(u=>{l=u.ns,c=u.rs})),!r.isEqual(H.min())){const u=n.kr.getLastRemoteSnapshotVersion(i).next(h=>n.kr.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(u)}return T.waitFor(a).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,l,c)).next(()=>l)}).then(i=>(n.Ji=s,i))}function cT(e,t,n){let r=G(),s=G();return n.forEach(i=>r=r.add(i)),t.getEntries(e,r).next(i=>{let o=Be();return n.forEach((a,l)=>{const c=i.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(s=s.add(a)),l.isNoDocument()&&l.version.isEqual(H.min())?(t.removeEntry(a,l.readTime),o=o.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(t.addEntry(l),o=o.insert(a,l)):x("LocalStore","Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)}),{ns:o,rs:s}})}function uT(e,t){const n=K(e);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(t===void 0&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,t)))}function hT(e,t){const n=K(e);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.kr.getTargetData(r,t).next(i=>i?(s=i,T.resolve(s)):n.kr.allocateTargetId(r).next(o=>(s=new ze(t,o,"TargetPurposeListen",r.currentSequenceNumber),n.kr.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.Ji.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.Ji=n.Ji.insert(r.targetId,r),n.Yi.set(t,r.targetId)),r})}async function pa(e,t,n){const r=K(e),s=r.Ji.get(t),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!_s(o))throw o;x("LocalStore",`Failed to update sequence numbers for target ${t}: ${o}`)}r.Ji=r.Ji.remove(t),r.Yi.delete(s.target)}function cu(e,t,n){const r=K(e);let s=H.min(),i=G();return r.persistence.runTransaction("Execute query","readonly",o=>function(l,c,u){const h=K(l),d=h.Yi.get(u);return d!==void 0?T.resolve(h.Ji.get(d)):h.kr.getTargetData(c,u)}(r,o,Le(t)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.kr.getMatchingKeysForTargetId(o,a.targetId).next(l=>{i=l})}).next(()=>r.Hi.getDocumentsMatchingQuery(o,t,n?s:H.min(),n?i:G())).next(a=>(fT(r,sv(t),a),{documents:a,ss:i})))}function fT(e,t,n){let r=e.Zi.get(t)||H.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),e.Zi.set(t,r)}class uu{constructor(){this.activeTargetIds=uv()}hs(t){this.activeTargetIds=this.activeTargetIds.add(t)}Ps(t){this.activeTargetIds=this.activeTargetIds.delete(t)}ls(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class dT{constructor(){this.Hs=new uu,this.Js={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,n,r){}addLocalQueryTarget(t){return this.Hs.hs(t),this.Js[t]||"not-current"}updateQueryState(t,n,r){this.Js[t]=n}removeLocalQueryTarget(t){this.Hs.Ps(t)}isLocalQueryTarget(t){return this.Hs.activeTargetIds.has(t)}clearQueryState(t){delete this.Js[t]}getAllActiveQueryTargets(){return this.Hs.activeTargetIds}isActiveQueryTarget(t){return this.Hs.activeTargetIds.has(t)}start(){return this.Hs=new uu,Promise.resolve()}handleUserChange(t,n,r){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pT{Ys(t){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hu{constructor(){this.Zs=()=>this.Xs(),this.eo=()=>this.no(),this.ro=[],this.io()}Ys(t){this.ro.push(t)}shutdown(){window.removeEventListener("online",this.Zs),window.removeEventListener("offline",this.eo)}io(){window.addEventListener("online",this.Zs),window.addEventListener("offline",this.eo)}Xs(){x("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.ro)t(0)}no(){x("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.ro)t(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ls=null;function Ao(){return Ls===null?Ls=function(){return 268435456+Math.round(2147483648*Math.random())}():Ls++,"0x"+Ls.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gT={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mT{constructor(t){this.so=t.so,this.oo=t.oo}_o(t){this.ao=t}uo(t){this.co=t}onMessage(t){this.lo=t}close(){this.oo()}send(t){this.so(t)}ho(){this.ao()}Po(t){this.co(t)}Io(t){this.lo(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ft="WebChannelConnection";class _T extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http";this.To=r+"://"+n.host,this.Eo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get Ao(){return!1}Ro(n,r,s,i,o){const a=Ao(),l=this.Vo(n,r);x("RestConnection",`Sending RPC '${n}' ${a}:`,l,s);const c={};return this.mo(c,i,o),this.fo(n,l,c,s).then(u=>(x("RestConnection",`Received RPC '${n}' ${a}: `,u),u),u=>{throw Zn("RestConnection",`RPC '${n}' ${a} failed with error: `,u,"url: ",l,"request:",s),u})}po(n,r,s,i,o,a){return this.Ro(n,r,s,i,o)}mo(n,r,s){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+fr}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,o)=>n[o]=i),s&&s.headers.forEach((i,o)=>n[o]=i)}Vo(n,r){const s=gT[n];return`${this.To}/v1/${r}:${s}`}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}fo(t,n,r,s){const i=Ao();return new Promise((o,a)=>{const l=new AE;l.setWithCredentials(!0),l.listenOnce(TE.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case wo.NO_ERROR:const u=l.getResponseJson();x(Ft,`XHR for RPC '${t}' ${i} received:`,JSON.stringify(u)),o(u);break;case wo.TIMEOUT:x(Ft,`RPC '${t}' ${i} timed out`),a(new M(E.DEADLINE_EXCEEDED,"Request time out"));break;case wo.HTTP_ERROR:const h=l.getStatus();if(x(Ft,`RPC '${t}' ${i} failed with status:`,h,"response text:",l.getResponseText()),h>0){let d=l.getResponseJson();Array.isArray(d)&&(d=d[0]);const g=d==null?void 0:d.error;if(g&&g.status&&g.message){const P=function(b){const F=b.toLowerCase().replace(/_/g,"-");return Object.values(E).indexOf(F)>=0?F:E.UNKNOWN}(g.status);a(new M(P,g.message))}else a(new M(E.UNKNOWN,"Server responded with status "+l.getStatus()))}else a(new M(E.UNAVAILABLE,"Connection failed."));break;default:B()}}finally{x(Ft,`RPC '${t}' ${i} completed.`)}});const c=JSON.stringify(s);x(Ft,`RPC '${t}' ${i} sending request:`,s),l.send(n,"POST",c,r,15)})}yo(t,n,r){const s=Ao(),i=[this.To,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=EE(),a=vE(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.xmlHttpFactory=new IE({})),this.mo(l.initMessageHeaders,n,r),l.encodeInitMessageHeaders=!0;const u=i.join("");x(Ft,`Creating RPC '${t}' stream ${s}: ${u}`,l);const h=o.createWebChannel(u,l);let d=!1,g=!1;const P=new mT({so:b=>{g?x(Ft,`Not sending because RPC '${t}' stream ${s} is closed:`,b):(d||(x(Ft,`Opening RPC '${t}' stream ${s} transport.`),h.open(),d=!0),x(Ft,`RPC '${t}' stream ${s} sending:`,b),h.send(b))},oo:()=>h.close()}),I=(b,F,U)=>{b.listen(F,W=>{try{U(W)}catch(w){setTimeout(()=>{throw w},0)}})};return I(h,Ns.EventType.OPEN,()=>{g||x(Ft,`RPC '${t}' stream ${s} transport opened.`)}),I(h,Ns.EventType.CLOSE,()=>{g||(g=!0,x(Ft,`RPC '${t}' stream ${s} transport closed`),P.Po())}),I(h,Ns.EventType.ERROR,b=>{g||(g=!0,Zn(Ft,`RPC '${t}' stream ${s} transport errored:`,b),P.Po(new M(E.UNAVAILABLE,"The operation could not be completed")))}),I(h,Ns.EventType.MESSAGE,b=>{var F;if(!g){const U=b.data[0];ft(!!U);const W=U,w=W.error||((F=W[0])===null||F===void 0?void 0:F.error);if(w){x(Ft,`RPC '${t}' stream ${s} received error:`,w);const L=w.status;let X=function(xt){const Pt=Et[xt];if(Pt!==void 0)return od(Pt)}(L),It=w.message;X===void 0&&(X=E.INTERNAL,It="Unknown error status: "+L+" with message "+w.message),g=!0,P.Po(new M(X,It)),h.close()}else x(Ft,`RPC '${t}' stream ${s} received:`,U),P.Io(U)}}),I(a,wE.STAT_EVENT,b=>{b.stat===$c.PROXY?x(Ft,`RPC '${t}' stream ${s} detected buffering proxy`):b.stat===$c.NOPROXY&&x(Ft,`RPC '${t}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{P.ho()},0),P}}function Ro(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xi(e){return new bv(e,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _d{constructor(t,n,r=1e3,s=1.5,i=6e4){this.ii=t,this.timerId=n,this.wo=r,this.So=s,this.bo=i,this.Do=0,this.vo=null,this.Co=Date.now(),this.reset()}reset(){this.Do=0}Fo(){this.Do=this.bo}Mo(t){this.cancel();const n=Math.floor(this.Do+this.xo()),r=Math.max(0,Date.now()-this.Co),s=Math.max(0,n-r);s>0&&x("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Do} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.vo=this.ii.enqueueAfterDelay(this.timerId,s,()=>(this.Co=Date.now(),t())),this.Do*=this.So,this.Do<this.wo&&(this.Do=this.wo),this.Do>this.bo&&(this.Do=this.bo)}Oo(){this.vo!==null&&(this.vo.skipDelay(),this.vo=null)}cancel(){this.vo!==null&&(this.vo.cancel(),this.vo=null)}xo(){return(Math.random()-.5)*this.Do}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yd{constructor(t,n,r,s,i,o,a,l){this.ii=t,this.No=r,this.Bo=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.Lo=0,this.ko=null,this.qo=null,this.stream=null,this.Qo=new _d(t,n)}Ko(){return this.state===1||this.state===5||this.$o()}$o(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Uo()}async stop(){this.Ko()&&await this.close(0)}Wo(){this.state=0,this.Qo.reset()}Go(){this.$o()&&this.ko===null&&(this.ko=this.ii.enqueueAfterDelay(this.No,6e4,()=>this.zo()))}jo(t){this.Ho(),this.stream.send(t)}async zo(){if(this.$o())return this.close(0)}Ho(){this.ko&&(this.ko.cancel(),this.ko=null)}Jo(){this.qo&&(this.qo.cancel(),this.qo=null)}async close(t,n){this.Ho(),this.Jo(),this.Qo.cancel(),this.Lo++,t!==4?this.Qo.reset():n&&n.code===E.RESOURCE_EXHAUSTED?(Fe(n.toString()),Fe("Using maximum backoff delay to prevent overloading the backend."),this.Qo.Fo()):n&&n.code===E.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.Yo(),this.stream.close(),this.stream=null),this.state=t,await this.listener.uo(n)}Yo(){}auth(){this.state=1;const t=this.Zo(this.Lo),n=this.Lo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Lo===n&&this.Xo(r,s)},r=>{t(()=>{const s=new M(E.UNKNOWN,"Fetching auth token failed: "+r.message);return this.e_(s)})})}Xo(t,n){const r=this.Zo(this.Lo);this.stream=this.t_(t,n),this.stream._o(()=>{r(()=>(this.state=2,this.qo=this.ii.enqueueAfterDelay(this.Bo,1e4,()=>(this.$o()&&(this.state=3),Promise.resolve())),this.listener._o()))}),this.stream.uo(s=>{r(()=>this.e_(s))}),this.stream.onMessage(s=>{r(()=>this.onMessage(s))})}Uo(){this.state=5,this.Qo.Mo(async()=>{this.state=0,this.start()})}e_(t){return x("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}Zo(t){return n=>{this.ii.enqueueAndForget(()=>this.Lo===t?n():(x("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class yT extends yd{constructor(t,n,r,s,i,o){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}t_(t,n){return this.connection.yo("Listen",t,n)}onMessage(t){this.Qo.reset();const n=xv(this.serializer,t),r=function(i){if(!("targetChange"in i))return H.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?H.min():o.readTime?Ie(o.readTime):H.min()}(t);return this.listener.n_(n,r)}r_(t){const n={};n.database=da(this.serializer),n.addTarget=function(i,o){let a;const l=o.target;if(a=aa(l)?{documents:Mv(i,l)}:{query:Ov(i,l)},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=cd(i,o.resumeToken);const c=ua(i,o.expectedCount);c!==null&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(H.min())>0){a.readTime=di(i,o.snapshotVersion.toTimestamp());const c=ua(i,o.expectedCount);c!==null&&(a.expectedCount=c)}return a}(this.serializer,t);const r=Lv(this.serializer,t);r&&(n.labels=r),this.jo(n)}i_(t){const n={};n.database=da(this.serializer),n.removeTarget=t,this.jo(n)}}class ET extends yd{constructor(t,n,r,s,i,o){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i,this.s_=!1}get o_(){return this.s_}start(){this.s_=!1,this.lastStreamToken=void 0,super.start()}Yo(){this.s_&&this.__([])}t_(t,n){return this.connection.yo("Write",t,n)}onMessage(t){if(ft(!!t.streamToken),this.lastStreamToken=t.streamToken,this.s_){this.Qo.reset();const n=Nv(t.writeResults,t.commitTime),r=Ie(t.commitTime);return this.listener.a_(r,n)}return ft(!t.writeResults||t.writeResults.length===0),this.s_=!0,this.listener.u_()}c_(){const t={};t.database=da(this.serializer),this.jo(t)}__(t){const n={streamToken:this.lastStreamToken,writes:t.map(r=>kv(this.serializer,r))};this.jo(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vT extends class{}{constructor(t,n,r,s){super(),this.authCredentials=t,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.l_=!1}h_(){if(this.l_)throw new M(E.FAILED_PRECONDITION,"The client has already been terminated.")}Ro(t,n,r){return this.h_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,i])=>this.connection.Ro(t,n,r,s,i)).catch(s=>{throw s.name==="FirebaseError"?(s.code===E.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new M(E.UNKNOWN,s.toString())})}po(t,n,r,s){return this.h_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.po(t,n,r,i,o,s)).catch(i=>{throw i.name==="FirebaseError"?(i.code===E.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new M(E.UNKNOWN,i.toString())})}terminate(){this.l_=!0}}class TT{constructor(t,n){this.asyncQueue=t,this.onlineStateHandler=n,this.state="Unknown",this.I_=0,this.T_=null,this.E_=!0}d_(){this.I_===0&&(this.A_("Unknown"),this.T_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.T_=null,this.R_("Backend didn't respond within 10 seconds."),this.A_("Offline"),Promise.resolve())))}V_(t){this.state==="Online"?this.A_("Unknown"):(this.I_++,this.I_>=1&&(this.m_(),this.R_(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.A_("Offline")))}set(t){this.m_(),this.I_=0,t==="Online"&&(this.E_=!1),this.A_(t)}A_(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}R_(t){const n=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.E_?(Fe(n),this.E_=!1):x("OnlineStateTracker",n)}m_(){this.T_!==null&&(this.T_.cancel(),this.T_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wT{constructor(t,n,r,s,i){this.localStore=t,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.f_=[],this.g_=new Map,this.p_=new Set,this.y_=[],this.w_=i,this.w_.Ys(o=>{r.enqueueAndForget(async()=>{bn(this)&&(x("RemoteStore","Restarting streams for network reachability change."),await async function(l){const c=K(l);c.p_.add(4),await vs(c),c.S_.set("Unknown"),c.p_.delete(4),await Yi(c)}(this))})}),this.S_=new TT(r,s)}}async function Yi(e){if(bn(e))for(const t of e.y_)await t(!0)}async function vs(e){for(const t of e.y_)await t(!1)}function Ed(e,t){const n=K(e);n.g_.has(t.targetId)||(n.g_.set(t.targetId,t),Cl(n)?Pl(n):gr(n).$o()&&Rl(n,t))}function vd(e,t){const n=K(e),r=gr(n);n.g_.delete(t),r.$o()&&Td(n,t),n.g_.size===0&&(r.$o()?r.Go():bn(n)&&n.S_.set("Unknown"))}function Rl(e,t){if(e.b_.Be(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(H.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}gr(e).r_(t)}function Td(e,t){e.b_.Be(t),gr(e).i_(t)}function Pl(e){e.b_=new Rv({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),ut:t=>e.g_.get(t)||null,rt:()=>e.datastore.serializer.databaseId}),gr(e).start(),e.S_.d_()}function Cl(e){return bn(e)&&!gr(e).Ko()&&e.g_.size>0}function bn(e){return K(e).p_.size===0}function wd(e){e.b_=void 0}async function IT(e){e.g_.forEach((t,n)=>{Rl(e,t)})}async function AT(e,t){wd(e),Cl(e)?(e.S_.V_(t),Pl(e)):e.S_.set("Unknown")}async function RT(e,t,n){if(e.S_.set("Online"),t instanceof ld&&t.state===2&&t.cause)try{await async function(s,i){const o=i.cause;for(const a of i.targetIds)s.g_.has(a)&&(await s.remoteSyncer.rejectListen(a,o),s.g_.delete(a),s.b_.removeTarget(a))}(e,t)}catch(r){x("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),r),await pi(e,r)}else if(t instanceof Ks?e.b_.We(t):t instanceof ad?e.b_.Ze(t):e.b_.je(t),!n.isEqual(H.min()))try{const r=await md(e.localStore);n.compareTo(r)>=0&&await function(i,o){const a=i.b_.st(o);return a.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const u=i.g_.get(c);u&&i.g_.set(c,u.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,c)=>{const u=i.g_.get(l);if(!u)return;i.g_.set(l,u.withResumeToken(Wt.EMPTY_BYTE_STRING,u.snapshotVersion)),Td(i,l);const h=new ze(u.target,l,c,u.sequenceNumber);Rl(i,h)}),i.remoteSyncer.applyRemoteEvent(a)}(e,n)}catch(r){x("RemoteStore","Failed to raise snapshot:",r),await pi(e,r)}}async function pi(e,t,n){if(!_s(t))throw t;e.p_.add(1),await vs(e),e.S_.set("Offline"),n||(n=()=>md(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{x("RemoteStore","Retrying IndexedDB access"),await n(),e.p_.delete(1),await Yi(e)})}function Id(e,t){return t().catch(n=>pi(e,n,t))}async function Ji(e){const t=K(e),n=rn(t);let r=t.f_.length>0?t.f_[t.f_.length-1].batchId:-1;for(;PT(t);)try{const s=await uT(t.localStore,r);if(s===null){t.f_.length===0&&n.Go();break}r=s.batchId,CT(t,s)}catch(s){await pi(t,s)}Ad(t)&&Rd(t)}function PT(e){return bn(e)&&e.f_.length<10}function CT(e,t){e.f_.push(t);const n=rn(e);n.$o()&&n.o_&&n.__(t.mutations)}function Ad(e){return bn(e)&&!rn(e).Ko()&&e.f_.length>0}function Rd(e){rn(e).start()}async function ST(e){rn(e).c_()}async function bT(e){const t=rn(e);for(const n of e.f_)t.__(n.mutations)}async function VT(e,t,n){const r=e.f_.shift(),s=yl.from(r,t,n);await Id(e,()=>e.remoteSyncer.applySuccessfulWrite(s)),await Ji(e)}async function DT(e,t){t&&rn(e).o_&&await async function(r,s){if(function(o){return wv(o)&&o!==E.ABORTED}(s.code)){const i=r.f_.shift();rn(r).Wo(),await Id(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await Ji(r)}}(e,t),Ad(e)&&Rd(e)}async function fu(e,t){const n=K(e);n.asyncQueue.verifyOperationInProgress(),x("RemoteStore","RemoteStore received new credentials");const r=bn(n);n.p_.add(3),await vs(n),r&&n.S_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.p_.delete(3),await Yi(n)}async function xT(e,t){const n=K(e);t?(n.p_.delete(2),await Yi(n)):t||(n.p_.add(2),await vs(n),n.S_.set("Unknown"))}function gr(e){return e.D_||(e.D_=function(n,r,s){const i=K(n);return i.h_(),new yT(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(e.datastore,e.asyncQueue,{_o:IT.bind(null,e),uo:AT.bind(null,e),n_:RT.bind(null,e)}),e.y_.push(async t=>{t?(e.D_.Wo(),Cl(e)?Pl(e):e.S_.set("Unknown")):(await e.D_.stop(),wd(e))})),e.D_}function rn(e){return e.v_||(e.v_=function(n,r,s){const i=K(n);return i.h_(),new ET(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(e.datastore,e.asyncQueue,{_o:ST.bind(null,e),uo:DT.bind(null,e),u_:bT.bind(null,e),a_:VT.bind(null,e)}),e.y_.push(async t=>{t?(e.v_.Wo(),await Ji(e)):(await e.v_.stop(),e.f_.length>0&&(x("RemoteStore",`Stopping write stream with ${e.f_.length} pending writes`),e.f_=[]))})),e.v_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sl{constructor(t,n,r,s,i){this.asyncQueue=t,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new Ye,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}static createAndSchedule(t,n,r,s,i){const o=Date.now()+r,a=new Sl(t,n,o,s,i);return a.start(r),a}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new M(E.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function bl(e,t){if(Fe("AsyncQueue",`${t}: ${e}`),_s(e))return new M(E.UNAVAILABLE,`${t}: ${e}`);throw e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wn{constructor(t){this.comparator=t?(n,r)=>t(n,r)||O.comparator(n.key,r.key):(n,r)=>O.comparator(n.key,r.key),this.keyedMap=Rr(),this.sortedSet=new gt(this.comparator)}static emptySet(t){return new Wn(t.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const n=this.keyedMap.get(t);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((n,r)=>(t(n),!1))}add(t){const n=this.delete(t.key);return n.copy(n.keyedMap.insert(t.key,t),n.sortedSet.insert(t,null))}delete(t){const n=this.get(t);return n?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(n)):this}isEqual(t){if(!(t instanceof Wn)||this.size!==t.size)return!1;const n=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const t=[];return this.forEach(n=>{t.push(n.toString())}),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,n){const r=new Wn;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class du{constructor(){this.C_=new gt(O.comparator)}track(t){const n=t.doc.key,r=this.C_.get(n);r?t.type!==0&&r.type===3?this.C_=this.C_.insert(n,t):t.type===3&&r.type!==1?this.C_=this.C_.insert(n,{type:r.type,doc:t.doc}):t.type===2&&r.type===2?this.C_=this.C_.insert(n,{type:2,doc:t.doc}):t.type===2&&r.type===0?this.C_=this.C_.insert(n,{type:0,doc:t.doc}):t.type===1&&r.type===0?this.C_=this.C_.remove(n):t.type===1&&r.type===2?this.C_=this.C_.insert(n,{type:1,doc:r.doc}):t.type===0&&r.type===1?this.C_=this.C_.insert(n,{type:2,doc:t.doc}):B():this.C_=this.C_.insert(n,t)}F_(){const t=[];return this.C_.inorderTraversal((n,r)=>{t.push(r)}),t}}class sr{constructor(t,n,r,s,i,o,a,l,c){this.query=t,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(t,n,r,s,i){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new sr(t,n,Wn.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&zi(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const n=this.docChanges,r=t.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kT{constructor(){this.M_=void 0,this.listeners=[]}}class NT{constructor(){this.queries=new pr(t=>Kf(t),zi),this.onlineState="Unknown",this.x_=new Set}}async function MT(e,t){const n=K(e),r=t.query;let s=!1,i=n.queries.get(r);if(i||(s=!0,i=new kT),s)try{i.M_=await n.onListen(r)}catch(o){const a=bl(o,`Initialization of query '${ca(t.query)}' failed`);return void t.onError(a)}n.queries.set(r,i),i.listeners.push(t),t.O_(n.onlineState),i.M_&&t.N_(i.M_)&&Vl(n)}async function OT(e,t){const n=K(e),r=t.query;let s=!1;const i=n.queries.get(r);if(i){const o=i.listeners.indexOf(t);o>=0&&(i.listeners.splice(o,1),s=i.listeners.length===0)}if(s)return n.queries.delete(r),n.onUnlisten(r)}function FT(e,t){const n=K(e);let r=!1;for(const s of t){const i=s.query,o=n.queries.get(i);if(o){for(const a of o.listeners)a.N_(s)&&(r=!0);o.M_=s}}r&&Vl(n)}function LT(e,t,n){const r=K(e),s=r.queries.get(t);if(s)for(const i of s.listeners)i.onError(n);r.queries.delete(t)}function Vl(e){e.x_.forEach(t=>{t.next()})}class BT{constructor(t,n,r){this.query=t,this.B_=n,this.L_=!1,this.k_=null,this.onlineState="Unknown",this.options=r||{}}N_(t){if(!this.options.includeMetadataChanges){const r=[];for(const s of t.docChanges)s.type!==3&&r.push(s);t=new sr(t.query,t.docs,t.oldDocs,r,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let n=!1;return this.L_?this.q_(t)&&(this.B_.next(t),n=!0):this.Q_(t,this.onlineState)&&(this.K_(t),n=!0),this.k_=t,n}onError(t){this.B_.error(t)}O_(t){this.onlineState=t;let n=!1;return this.k_&&!this.L_&&this.Q_(this.k_,t)&&(this.K_(this.k_),n=!0),n}Q_(t,n){if(!t.fromCache)return!0;const r=n!=="Offline";return(!this.options.U_||!r)&&(!t.docs.isEmpty()||t.hasCachedResults||n==="Offline")}q_(t){if(t.docChanges.length>0)return!0;const n=this.k_&&this.k_.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}K_(t){t=sr.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.L_=!0,this.B_.next(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pd{constructor(t){this.key=t}}class Cd{constructor(t){this.key=t}}class UT{constructor(t,n){this.query=t,this.Z_=n,this.X_=null,this.hasCachedResults=!1,this.current=!1,this.ea=G(),this.mutatedKeys=G(),this.ta=Wf(t),this.na=new Wn(this.ta)}get ra(){return this.Z_}ia(t,n){const r=n?n.sa:new du,s=n?n.na:this.na;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,a=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,c=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(t.inorderTraversal((u,h)=>{const d=s.get(u),g=Ki(this.query,h)?h:null,P=!!d&&this.mutatedKeys.has(d.key),I=!!g&&(g.hasLocalMutations||this.mutatedKeys.has(g.key)&&g.hasCommittedMutations);let b=!1;d&&g?d.data.isEqual(g.data)?P!==I&&(r.track({type:3,doc:g}),b=!0):this.oa(d,g)||(r.track({type:2,doc:g}),b=!0,(l&&this.ta(g,l)>0||c&&this.ta(g,c)<0)&&(a=!0)):!d&&g?(r.track({type:0,doc:g}),b=!0):d&&!g&&(r.track({type:1,doc:d}),b=!0,(l||c)&&(a=!0)),b&&(g?(o=o.add(g),i=I?i.add(u):i.delete(u)):(o=o.delete(u),i=i.delete(u)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const u=this.query.limitType==="F"?o.last():o.first();o=o.delete(u.key),i=i.delete(u.key),r.track({type:1,doc:u})}return{na:o,sa:r,zi:a,mutatedKeys:i}}oa(t,n){return t.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(t,n,r){const s=this.na;this.na=t.na,this.mutatedKeys=t.mutatedKeys;const i=t.sa.F_();i.sort((c,u)=>function(d,g){const P=I=>{switch(I){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return B()}};return P(d)-P(g)}(c.type,u.type)||this.ta(c.doc,u.doc)),this._a(r);const o=n?this.aa():[],a=this.ea.size===0&&this.current?1:0,l=a!==this.X_;return this.X_=a,i.length!==0||l?{snapshot:new sr(this.query,t.na,s,i,t.mutatedKeys,a===0,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),ua:o}:{ua:o}}O_(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({na:this.na,sa:new du,mutatedKeys:this.mutatedKeys,zi:!1},!1)):{ua:[]}}ca(t){return!this.Z_.has(t)&&!!this.na.has(t)&&!this.na.get(t).hasLocalMutations}_a(t){t&&(t.addedDocuments.forEach(n=>this.Z_=this.Z_.add(n)),t.modifiedDocuments.forEach(n=>{}),t.removedDocuments.forEach(n=>this.Z_=this.Z_.delete(n)),this.current=t.current)}aa(){if(!this.current)return[];const t=this.ea;this.ea=G(),this.na.forEach(r=>{this.ca(r.key)&&(this.ea=this.ea.add(r.key))});const n=[];return t.forEach(r=>{this.ea.has(r)||n.push(new Cd(r))}),this.ea.forEach(r=>{t.has(r)||n.push(new Pd(r))}),n}la(t){this.Z_=t.ss,this.ea=G();const n=this.ia(t.documents);return this.applyChanges(n,!0)}ha(){return sr.fromInitialDocuments(this.query,this.na,this.mutatedKeys,this.X_===0,this.hasCachedResults)}}class $T{constructor(t,n,r){this.query=t,this.targetId=n,this.view=r}}class jT{constructor(t){this.key=t,this.Pa=!1}}class qT{constructor(t,n,r,s,i,o){this.localStore=t,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Ia={},this.Ta=new pr(a=>Kf(a),zi),this.Ea=new Map,this.da=new Set,this.Aa=new gt(O.comparator),this.Ra=new Map,this.Va=new wl,this.ma={},this.fa=new Map,this.ga=rr.On(),this.onlineState="Unknown",this.pa=void 0}get isPrimaryClient(){return this.pa===!0}}async function HT(e,t){const n=t0(e);let r,s;const i=n.Ta.get(t);if(i)r=i.targetId,n.sharedClientState.addLocalQueryTarget(r),s=i.view.ha();else{const o=await hT(n.localStore,Le(t)),a=n.sharedClientState.addLocalQueryTarget(o.targetId);r=o.targetId,s=await zT(n,t,r,a==="current",o.resumeToken),n.isPrimaryClient&&Ed(n.remoteStore,o)}return s}async function zT(e,t,n,r,s){e.ya=(h,d,g)=>async function(I,b,F,U){let W=b.view.ia(F);W.zi&&(W=await cu(I.localStore,b.query,!1).then(({documents:X})=>b.view.ia(X,W)));const w=U&&U.targetChanges.get(b.targetId),L=b.view.applyChanges(W,I.isPrimaryClient,w);return gu(I,b.targetId,L.ua),L.snapshot}(e,h,d,g);const i=await cu(e.localStore,t,!0),o=new UT(t,i.ss),a=o.ia(i.documents),l=Es.createSynthesizedTargetChangeForCurrentChange(n,r&&e.onlineState!=="Offline",s),c=o.applyChanges(a,e.isPrimaryClient,l);gu(e,n,c.ua);const u=new $T(t,n,o);return e.Ta.set(t,u),e.Ea.has(n)?e.Ea.get(n).push(t):e.Ea.set(n,[t]),c.snapshot}async function KT(e,t){const n=K(e),r=n.Ta.get(t),s=n.Ea.get(r.targetId);if(s.length>1)return n.Ea.set(r.targetId,s.filter(i=>!zi(i,t))),void n.Ta.delete(t);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await pa(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),vd(n.remoteStore,r.targetId),ga(n,r.targetId)}).catch(ms)):(ga(n,r.targetId),await pa(n.localStore,r.targetId,!0))}async function WT(e,t,n){const r=e0(e);try{const s=await function(o,a){const l=K(o),c=Rt.now(),u=a.reduce((g,P)=>g.add(P.key),G());let h,d;return l.persistence.runTransaction("Locally write mutations","readwrite",g=>{let P=Be(),I=G();return l.Xi.getEntries(g,u).next(b=>{P=b,P.forEach((F,U)=>{U.isValidDocument()||(I=I.add(F))})}).next(()=>l.localDocuments.getOverlayedDocuments(g,P)).next(b=>{h=b;const F=[];for(const U of a){const W=_v(U,h.get(U.key).overlayedDocument);W!=null&&F.push(new Sn(U.key,W,Lf(W.value.mapValue),Ne.exists(!0)))}return l.mutationQueue.addMutationBatch(g,c,F,a)}).next(b=>{d=b;const F=b.applyToLocalDocumentSet(h,I);return l.documentOverlayCache.saveOverlays(g,b.batchId,F)})}).then(()=>({batchId:d.batchId,changes:Gf(h)}))}(r.localStore,t);r.sharedClientState.addPendingMutation(s.batchId),function(o,a,l){let c=o.ma[o.currentUser.toKey()];c||(c=new gt(Z)),c=c.insert(a,l),o.ma[o.currentUser.toKey()]=c}(r,s.batchId,n),await Ts(r,s.changes),await Ji(r.remoteStore)}catch(s){const i=bl(s,"Failed to persist write");n.reject(i)}}async function Sd(e,t){const n=K(e);try{const r=await lT(n.localStore,t);t.targetChanges.forEach((s,i)=>{const o=n.Ra.get(i);o&&(ft(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.Pa=!0:s.modifiedDocuments.size>0?ft(o.Pa):s.removedDocuments.size>0&&(ft(o.Pa),o.Pa=!1))}),await Ts(n,r,t)}catch(r){await ms(r)}}function pu(e,t,n){const r=K(e);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Ta.forEach((i,o)=>{const a=o.view.O_(t);a.snapshot&&s.push(a.snapshot)}),function(o,a){const l=K(o);l.onlineState=a;let c=!1;l.queries.forEach((u,h)=>{for(const d of h.listeners)d.O_(a)&&(c=!0)}),c&&Vl(l)}(r.eventManager,t),s.length&&r.Ia.n_(s),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function QT(e,t,n){const r=K(e);r.sharedClientState.updateQueryState(t,"rejected",n);const s=r.Ra.get(t),i=s&&s.key;if(i){let o=new gt(O.comparator);o=o.insert(i,Bt.newNoDocument(i,H.min()));const a=G().add(i),l=new Gi(H.min(),new Map,new gt(Z),o,a);await Sd(r,l),r.Aa=r.Aa.remove(i),r.Ra.delete(t),Dl(r)}else await pa(r.localStore,t,!1).then(()=>ga(r,t,n)).catch(ms)}async function GT(e,t){const n=K(e),r=t.batch.batchId;try{const s=await aT(n.localStore,t);Vd(n,r,null),bd(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Ts(n,s)}catch(s){await ms(s)}}async function XT(e,t,n){const r=K(e);try{const s=await function(o,a){const l=K(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let u;return l.mutationQueue.lookupMutationBatch(c,a).next(h=>(ft(h!==null),u=h.keys(),l.mutationQueue.removeMutationBatch(c,h))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,u,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,u)).next(()=>l.localDocuments.getDocuments(c,u))})}(r.localStore,t);Vd(r,t,n),bd(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await Ts(r,s)}catch(s){await ms(s)}}function bd(e,t){(e.fa.get(t)||[]).forEach(n=>{n.resolve()}),e.fa.delete(t)}function Vd(e,t,n){const r=K(e);let s=r.ma[r.currentUser.toKey()];if(s){const i=s.get(t);i&&(n?i.reject(n):i.resolve(),s=s.remove(t)),r.ma[r.currentUser.toKey()]=s}}function ga(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.Ea.get(t))e.Ta.delete(r),n&&e.Ia.wa(r,n);e.Ea.delete(t),e.isPrimaryClient&&e.Va.Ar(t).forEach(r=>{e.Va.containsKey(r)||Dd(e,r)})}function Dd(e,t){e.da.delete(t.path.canonicalString());const n=e.Aa.get(t);n!==null&&(vd(e.remoteStore,n),e.Aa=e.Aa.remove(t),e.Ra.delete(n),Dl(e))}function gu(e,t,n){for(const r of n)r instanceof Pd?(e.Va.addReference(r.key,t),YT(e,r)):r instanceof Cd?(x("SyncEngine","Document no longer in limbo: "+r.key),e.Va.removeReference(r.key,t),e.Va.containsKey(r.key)||Dd(e,r.key)):B()}function YT(e,t){const n=t.key,r=n.path.canonicalString();e.Aa.get(n)||e.da.has(r)||(x("SyncEngine","New document in limbo: "+n),e.da.add(r),Dl(e))}function Dl(e){for(;e.da.size>0&&e.Aa.size<e.maxConcurrentLimboResolutions;){const t=e.da.values().next().value;e.da.delete(t);const n=new O(dt.fromString(t)),r=e.ga.next();e.Ra.set(r,new jT(n)),e.Aa=e.Aa.insert(n,r),Ed(e.remoteStore,new ze(Le(zf(n.path)),r,"TargetPurposeLimboResolution",fl.ae))}}async function Ts(e,t,n){const r=K(e),s=[],i=[],o=[];r.Ta.isEmpty()||(r.Ta.forEach((a,l)=>{o.push(r.ya(l,t,n).then(c=>{if((c||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(l.targetId,c!=null&&c.fromCache?"not-current":"current"),c){s.push(c);const u=Al.qi(l.targetId,c);i.push(u)}}))}),await Promise.all(o),r.Ia.n_(s),await async function(l,c){const u=K(l);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>T.forEach(c,d=>T.forEach(d.Li,g=>u.persistence.referenceDelegate.addReference(h,d.targetId,g)).next(()=>T.forEach(d.ki,g=>u.persistence.referenceDelegate.removeReference(h,d.targetId,g)))))}catch(h){if(!_s(h))throw h;x("LocalStore","Failed to update sequence numbers: "+h)}for(const h of c){const d=h.targetId;if(!h.fromCache){const g=u.Ji.get(d),P=g.snapshotVersion,I=g.withLastLimboFreeSnapshotVersion(P);u.Ji=u.Ji.insert(d,I)}}}(r.localStore,i))}async function JT(e,t){const n=K(e);if(!n.currentUser.isEqual(t)){x("SyncEngine","User change. New user:",t.toKey());const r=await gd(n.localStore,t);n.currentUser=t,function(i,o){i.fa.forEach(a=>{a.forEach(l=>{l.reject(new M(E.CANCELLED,o))})}),i.fa.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,r.removedBatchIds,r.addedBatchIds),await Ts(n,r.ts)}}function ZT(e,t){const n=K(e),r=n.Ra.get(t);if(r&&r.Pa)return G().add(r.key);{let s=G();const i=n.Ea.get(t);if(!i)return s;for(const o of i){const a=n.Ta.get(o);s=s.unionWith(a.view.ra)}return s}}function t0(e){const t=K(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=Sd.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=ZT.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=QT.bind(null,t),t.Ia.n_=FT.bind(null,t.eventManager),t.Ia.wa=LT.bind(null,t.eventManager),t}function e0(e){const t=K(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=GT.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=XT.bind(null,t),t}class mu{constructor(){this.synchronizeTabs=!1}async initialize(t){this.serializer=Xi(t.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(t),this.persistence=this.createPersistence(t),await this.persistence.start(),this.localStore=this.createLocalStore(t),this.gcScheduler=this.createGarbageCollectionScheduler(t,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(t,this.localStore)}createGarbageCollectionScheduler(t,n){return null}createIndexBackfillerScheduler(t,n){return null}createLocalStore(t){return oT(this.persistence,new sT,t.initialUser,this.serializer)}createPersistence(t){return new nT(Il.zr,this.serializer)}createSharedClientState(t){return new dT}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class n0{async initialize(t,n){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>pu(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=JT.bind(null,this.syncEngine),await xT(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return function(){return new NT}()}createDatastore(t){const n=Xi(t.databaseInfo.databaseId),r=function(i){return new _T(i)}(t.databaseInfo);return function(i,o,a,l){return new vT(i,o,a,l)}(t.authCredentials,t.appCheckCredentials,r,n)}createRemoteStore(t){return function(r,s,i,o,a){return new wT(r,s,i,o,a)}(this.localStore,this.datastore,t.asyncQueue,n=>pu(this.syncEngine,n,0),function(){return hu.v()?new hu:new pT}())}createSyncEngine(t,n){return function(s,i,o,a,l,c,u){const h=new qT(s,i,o,a,l,c);return u&&(h.pa=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,n)}terminate(){return async function(n){const r=K(n);x("RemoteStore","RemoteStore shutting down."),r.p_.add(5),await vs(r),r.w_.shutdown(),r.S_.set("Unknown")}(this.remoteStore)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r0{constructor(t){this.observer=t,this.muted=!1}next(t){this.observer.next&&this.Da(this.observer.next,t)}error(t){this.observer.error?this.Da(this.observer.error,t):Fe("Uncaught Error in snapshot listener:",t.toString())}va(){this.muted=!0}Da(t,n){this.muted||setTimeout(()=>{this.muted||t(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s0{constructor(t,n,r,s){this.authCredentials=t,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=Lt.UNAUTHENTICATED,this.clientId=Mf.V(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,async i=>{x("FirestoreClient","Received user=",i.uid),await this.authCredentialListener(i),this.user=i}),this.appCheckCredentials.start(r,i=>(x("FirestoreClient","Received new app check token=",i),this.appCheckCredentialListener(i,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new M(E.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const t=new Ye;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(n){const r=bl(n,"Failed to shutdown persistence");t.reject(r)}}),t.promise}}async function Po(e,t){e.asyncQueue.verifyOperationInProgress(),x("FirestoreClient","Initializing OfflineComponentProvider");const n=await e.getConfiguration();await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener(async s=>{r.isEqual(s)||(await gd(t.localStore,s),r=s)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function _u(e,t){e.asyncQueue.verifyOperationInProgress();const n=await o0(e);x("FirestoreClient","Initializing OnlineComponentProvider");const r=await e.getConfiguration();await t.initialize(n,r),e.setCredentialChangeListener(s=>fu(t.remoteStore,s)),e.setAppCheckTokenChangeListener((s,i)=>fu(t.remoteStore,i)),e._onlineComponents=t}function i0(e){return e.name==="FirebaseError"?e.code===E.FAILED_PRECONDITION||e.code===E.UNIMPLEMENTED:!(typeof DOMException<"u"&&e instanceof DOMException)||e.code===22||e.code===20||e.code===11}async function o0(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){x("FirestoreClient","Using user provided OfflineComponentProvider");try{await Po(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!i0(n))throw n;Zn("Error using user provided cache. Falling back to memory cache: "+n),await Po(e,new mu)}}else x("FirestoreClient","Using default OfflineComponentProvider"),await Po(e,new mu);return e._offlineComponents}async function xd(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(x("FirestoreClient","Using user provided OnlineComponentProvider"),await _u(e,e._uninitializedComponentsProvider._online)):(x("FirestoreClient","Using default OnlineComponentProvider"),await _u(e,new n0))),e._onlineComponents}function a0(e){return xd(e).then(t=>t.syncEngine)}async function l0(e){const t=await xd(e),n=t.eventManager;return n.onListen=HT.bind(null,t.syncEngine),n.onUnlisten=KT.bind(null,t.syncEngine),n}function c0(e,t,n={}){const r=new Ye;return e.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,c){const u=new r0({next:d=>{o.enqueueAndForget(()=>OT(i,h)),d.fromCache&&l.source==="server"?c.reject(new M(E.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(d)},error:d=>c.reject(d)}),h=new BT(a,u,{includeMetadataChanges:!0,U_:!0});return MT(i,h)}(await l0(e),e.asyncQueue,t,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kd(e){const t={};return e.timeoutSeconds!==void 0&&(t.timeoutSeconds=e.timeoutSeconds),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yu=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nd(e,t,n){if(!n)throw new M(E.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function u0(e,t,n,r){if(t===!0&&r===!0)throw new M(E.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)}function Eu(e){if(!O.isDocumentKey(e))throw new M(E.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function vu(e){if(O.isDocumentKey(e))throw new M(E.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function xl(e){if(e===void 0)return"undefined";if(e===null)return"null";if(typeof e=="string")return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if(typeof e=="number"||typeof e=="boolean")return""+e;if(typeof e=="object"){if(e instanceof Array)return"an array";{const t=function(r){return r.constructor?r.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return typeof e=="function"?"a function":B()}function gi(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new M(E.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=xl(e);throw new M(E.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tu{constructor(t){var n,r;if(t.host===void 0){if(t.ssl!==void 0)throw new M(E.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=(n=t.ssl)===null||n===void 0||n;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<1048576)throw new M(E.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}u0("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=kd((r=t.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new M(E.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new M(E.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new M(E.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class Zi{constructor(t,n,r,s){this._authCredentials=t,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Tu({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new M(E.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(t){if(this._settingsFrozen)throw new M(E.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Tu(t),t.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new PE;switch(r.type){case"firstParty":return new VE(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new M(E.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=yu.get(n);r&&(x("ComponentProvider","Removing Datastore"),yu.delete(n),r.terminate())}(this),Promise.resolve()}}function h0(e,t,n,r={}){var s;const i=(e=gi(e,Zi))._getSettings(),o=`${t}:${n}`;if(i.host!=="firestore.googleapis.com"&&i.host!==o&&Zn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},i),{host:o,ssl:!1})),r.mockUserToken){let a,l;if(typeof r.mockUserToken=="string")a=r.mockUserToken,l=Lt.MOCK_USER;else{a=i_(r.mockUserToken,(s=e._app)===null||s===void 0?void 0:s.options.projectId);const c=r.mockUserToken.sub||r.mockUserToken.user_id;if(!c)throw new M(E.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new Lt(c)}e._authCredentials=new CE(new Nf(a,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class to{constructor(t,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=t}withConverter(t){return new to(this.firestore,t,this._query)}}class fe{constructor(t,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Je(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new fe(this.firestore,t,this._key)}}class Je extends to{constructor(t,n,r){super(t,n,zf(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new fe(this.firestore,null,new O(t))}withConverter(t){return new Je(this.firestore,t,this._path)}}function wu(e,t,...n){if(e=jr(e),Nd("collection","path",t),e instanceof Zi){const r=dt.fromString(t,...n);return vu(r),new Je(e,null,r)}{if(!(e instanceof fe||e instanceof Je))throw new M(E.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(dt.fromString(t,...n));return vu(r),new Je(e.firestore,null,r)}}function f0(e,t,...n){if(e=jr(e),arguments.length===1&&(t=Mf.V()),Nd("doc","path",t),e instanceof Zi){const r=dt.fromString(t,...n);return Eu(r),new fe(e,null,new O(r))}{if(!(e instanceof fe||e instanceof Je))throw new M(E.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(dt.fromString(t,...n));return Eu(r),new fe(e.firestore,e instanceof Je?e.converter:null,new O(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d0{constructor(){this.Ua=Promise.resolve(),this.Wa=[],this.Ga=!1,this.za=[],this.ja=null,this.Ha=!1,this.Ja=!1,this.Ya=[],this.Qo=new _d(this,"async_queue_retry"),this.Za=()=>{const n=Ro();n&&x("AsyncQueue","Visibility state changed to "+n.visibilityState),this.Qo.Oo()};const t=Ro();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Za)}get isShuttingDown(){return this.Ga}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.Xa(),this.eu(t)}enterRestrictedMode(t){if(!this.Ga){this.Ga=!0,this.Ja=t||!1;const n=Ro();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Za)}}enqueue(t){if(this.Xa(),this.Ga)return new Promise(()=>{});const n=new Ye;return this.eu(()=>this.Ga&&this.Ja?Promise.resolve():(t().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Wa.push(t),this.tu()))}async tu(){if(this.Wa.length!==0){try{await this.Wa[0](),this.Wa.shift(),this.Qo.reset()}catch(t){if(!_s(t))throw t;x("AsyncQueue","Operation failed with retryable error: "+t)}this.Wa.length>0&&this.Qo.Mo(()=>this.tu())}}eu(t){const n=this.Ua.then(()=>(this.Ha=!0,t().catch(r=>{this.ja=r,this.Ha=!1;const s=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw Fe("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.Ha=!1,r))));return this.Ua=n,n}enqueueAfterDelay(t,n,r){this.Xa(),this.Ya.indexOf(t)>-1&&(n=0);const s=Sl.createAndSchedule(this,t,n,r,i=>this.nu(i));return this.za.push(s),s}Xa(){this.ja&&B()}verifyOperationInProgress(){}async ru(){let t;do t=this.Ua,await t;while(t!==this.Ua)}iu(t){for(const n of this.za)if(n.timerId===t)return!0;return!1}su(t){return this.ru().then(()=>{this.za.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.za)if(n.skipDelay(),t!=="all"&&n.timerId===t)break;return this.ru()})}ou(t){this.Ya.push(t)}nu(t){const n=this.za.indexOf(t);this.za.splice(n,1)}}class kl extends Zi{constructor(t,n,r,s){super(t,n,r,s),this.type="firestore",this._queue=function(){return new d0}(),this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||Od(this),this._firestoreClient.terminate()}}function p0(e,t){const n=typeof e=="object"?e:cy(),r=typeof e=="string"?e:t||"(default)",s=iy(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=r_("firestore");i&&h0(s,...i)}return s}function Md(e){return e._firestoreClient||Od(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function Od(e){var t,n,r;const s=e._freezeSettings(),i=function(a,l,c,u){return new jE(a,l,c,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,kd(u.experimentalLongPollingOptions),u.useFetchStreams)}(e._databaseId,((t=e._app)===null||t===void 0?void 0:t.options.appId)||"",e._persistenceKey,s);e._firestoreClient=new s0(e._authCredentials,e._appCheckCredentials,e._queue,i),!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(e._firestoreClient._uninitializedComponentsProvider={_offlineKind:s.localCache.kind,_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ir{constructor(t){this._byteString=t}static fromBase64String(t){try{return new ir(Wt.fromBase64String(t))}catch(n){throw new M(E.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(t){return new ir(Wt.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nl{constructor(...t){for(let n=0;n<t.length;++n)if(t[n].length===0)throw new M(E.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new $t(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fd{constructor(t){this._methodName=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ml{constructor(t,n){if(!isFinite(t)||t<-90||t>90)throw new M(E.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(n)||n<-180||n>180)throw new M(E.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=t,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return Z(this._lat,t._lat)||Z(this._long,t._long)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g0=/^__.*__$/;class m0{constructor(t,n,r){this.data=t,this.fieldMask=n,this.fieldTransforms=r}toMutation(t,n){return this.fieldMask!==null?new Sn(t,this.data,this.fieldMask,n,this.fieldTransforms):new ys(t,this.data,n,this.fieldTransforms)}}function Ld(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw B()}}class Ol{constructor(t,n,r,s,i,o){this.settings=t,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this._u(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get au(){return this.settings.au}uu(t){return new Ol(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}cu(t){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(t),s=this.uu({path:r,lu:!1});return s.hu(t),s}Pu(t){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(t),s=this.uu({path:r,lu:!1});return s._u(),s}Iu(t){return this.uu({path:void 0,lu:!0})}Tu(t){return mi(t,this.settings.methodName,this.settings.Eu||!1,this.path,this.settings.du)}contains(t){return this.fieldMask.find(n=>t.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>t.isPrefixOf(n.field))!==void 0}_u(){if(this.path)for(let t=0;t<this.path.length;t++)this.hu(this.path.get(t))}hu(t){if(t.length===0)throw this.Tu("Document fields must not be empty");if(Ld(this.au)&&g0.test(t))throw this.Tu('Document fields cannot begin and end with "__"')}}class _0{constructor(t,n,r){this.databaseId=t,this.ignoreUndefinedProperties=n,this.serializer=r||Xi(t)}Au(t,n,r,s=!1){return new Ol({au:t,methodName:n,du:r,path:$t.emptyPath(),lu:!1,Eu:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function y0(e){const t=e._freezeSettings(),n=Xi(e._databaseId);return new _0(e._databaseId,!!t.ignoreUndefinedProperties,n)}function E0(e,t,n,r,s,i={}){const o=e.Au(i.merge||i.mergeFields?2:0,t,n,s);jd("Data must be an object, but it was:",o,r);const a=Ud(r,o);let l,c;if(i.merge)l=new ce(o.fieldMask),c=o.fieldTransforms;else if(i.mergeFields){const u=[];for(const h of i.mergeFields){const d=v0(t,h,n);if(!o.contains(d))throw new M(E.INVALID_ARGUMENT,`Field '${d}' is specified in your field mask but missing from your input data.`);w0(u,d)||u.push(d)}l=new ce(u),c=o.fieldTransforms.filter(h=>l.covers(h.field))}else l=null,c=o.fieldTransforms;return new m0(new re(a),l,c)}function Bd(e,t){if($d(e=jr(e)))return jd("Unsupported field value:",t,e),Ud(e,t);if(e instanceof Fd)return function(r,s){if(!Ld(s.au))throw s.Tu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Tu(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(e,t),null;if(e===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.lu&&t.au!==4)throw t.Tu("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const a of r){let l=Bd(a,s.Iu(o));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),o++}return{arrayValue:{values:i}}}(e,t)}return function(r,s){if((r=jr(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return hv(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=Rt.fromDate(r);return{timestampValue:di(s.serializer,i)}}if(r instanceof Rt){const i=new Rt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:di(s.serializer,i)}}if(r instanceof Ml)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof ir)return{bytesValue:cd(s.serializer,r._byteString)};if(r instanceof fe){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Tu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Tl(r.firestore._databaseId||s.databaseId,r._key.path)}}throw s.Tu(`Unsupported field value: ${xl(r)}`)}(e,t)}function Ud(e,t){const n={};return Of(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):dr(e,(r,s)=>{const i=Bd(s,t.cu(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function $d(e){return!(typeof e!="object"||e===null||e instanceof Array||e instanceof Date||e instanceof Rt||e instanceof Ml||e instanceof ir||e instanceof fe||e instanceof Fd)}function jd(e,t,n){if(!$d(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const r=xl(n);throw r==="an object"?t.Tu(e+" a custom object"):t.Tu(e+" "+r)}}function v0(e,t,n){if((t=jr(t))instanceof Nl)return t._internalPath;if(typeof t=="string")return qd(e,t);throw mi("Field path arguments must be of type string or ",e,!1,void 0,n)}const T0=new RegExp("[~\\*/\\[\\]]");function qd(e,t,n){if(t.search(T0)>=0)throw mi(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new Nl(...t.split("."))._internalPath}catch{throw mi(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function mi(e,t,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${t}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(i||o)&&(l+=" (found",i&&(l+=` in field ${r}`),o&&(l+=` in document ${s}`),l+=")"),new M(E.INVALID_ARGUMENT,a+e+l)}function w0(e,t){return e.some(n=>n.isEqual(t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hd{constructor(t,n,r,s,i){this._firestore=t,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new fe(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new I0(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const n=this._document.data.field(zd("DocumentSnapshot.get",t));if(n!==null)return this._userDataWriter.convertValue(n)}}}class I0 extends Hd{data(){return super.data()}}function zd(e,t){return typeof t=="string"?qd(e,t):t instanceof Nl?t._internalPath:t._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A0(e){if(e.limitType==="L"&&e.explicitOrderBy.length===0)throw new M(E.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class R0{convertValue(t,n="none"){switch(Pn(t)){case 0:return null;case 1:return t.booleanValue;case 2:return vt(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,n);case 5:return t.stringValue;case 6:return this.convertBytes(Rn(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,n);case 10:return this.convertObject(t.mapValue,n);default:throw B()}}convertObject(t,n){return this.convertObjectMap(t.fields,n)}convertObjectMap(t,n="none"){const r={};return dr(t,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertGeoPoint(t){return new Ml(vt(t.latitude),vt(t.longitude))}convertArray(t,n){return(t.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(t,n){switch(n){case"previous":const r=pl(t);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(ts(t));default:return null}}convertTimestamp(t){const n=nn(t);return new Rt(n.seconds,n.nanos)}convertDocumentKey(t,n){const r=dt.fromString(t);ft(pd(r));const s=new es(r.get(1),r.get(3)),i=new O(r.popFirst(5));return s.isEqual(n)||Fe(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P0(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bs{constructor(t,n){this.hasPendingWrites=t,this.fromCache=n}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class C0 extends Hd{constructor(t,n,r,s,i,o){super(t,n,r,s,o),this._firestore=t,this._firestoreImpl=t,this.metadata=i}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const n=new Ws(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,n={}){if(this._document){const r=this._document.data.field(zd("DocumentSnapshot.get",t));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class Ws extends C0{data(t={}){return super.data(t)}}class S0{constructor(t,n,r,s){this._firestore=t,this._userDataWriter=n,this._snapshot=s,this.metadata=new Bs(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const t=[];return this.forEach(n=>t.push(n)),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,n){this._snapshot.docs.forEach(r=>{t.call(n,new Ws(this._firestore,this._userDataWriter,r.key,r,new Bs(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(t={}){const n=!!t.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new M(E.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(a=>{const l=new Ws(s._firestore,s._userDataWriter,a.doc.key,a.doc,new Bs(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(a=>i||a.type!==3).map(a=>{const l=new Ws(s._firestore,s._userDataWriter,a.doc.key,a.doc,new Bs(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);let c=-1,u=-1;return a.type!==0&&(c=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),u=o.indexOf(a.doc.key)),{type:b0(a.type),doc:l,oldIndex:c,newIndex:u}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function b0(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return B()}}class V0 extends R0{constructor(t){super(),this.firestore=t}convertBytes(t){return new ir(t)}convertReference(t){const n=this.convertDocumentKey(t,this.firestore._databaseId);return new fe(this.firestore,null,n)}}function D0(e){e=gi(e,to);const t=gi(e.firestore,kl),n=Md(t),r=new V0(t);return A0(e._query),c0(n,e._query).then(s=>new S0(t,r,e,s))}function x0(e,t){const n=gi(e.firestore,kl),r=f0(e),s=P0(e.converter,t);return k0(n,[E0(y0(e.firestore),"addDoc",r._key,s,e.converter!==null,{}).toMutation(r._key,Ne.exists(!1))]).then(()=>r)}function k0(e,t){return function(r,s){const i=new Ye;return r.asyncQueue.enqueueAndForget(async()=>WT(await a0(r),s,i)),i.promise}(Md(e),t)}(function(t,n=!0){(function(s){fr=s})(ly),ei(new qr("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),a=new kl(new SE(r.getProvider("auth-internal")),new xE(r.getProvider("app-check-internal")),function(c,u){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new M(E.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new es(c.options.projectId,u)}(o,s),o);return i=Object.assign({useFetchStreams:n},i),a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),qn(jc,"4.0.0",t),qn(jc,"4.0.0","esm2017")})();var N0="firebase",M0="10.0.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */qn(N0,M0,"app");const O0={apiKey:{}.FIREBASE_API_KEY,authDomain:"placename-guesser.firebaseapp.com",projectId:"placename-guesser",storageBucket:"placename-guesser.appspot.com",messagingSenderId:"136146579197",appId:"1:136146579197:web:a46e28128dc514e71c9894"},F0=Sh(O0);F0||console.log("something");const Iu=p0(),L0={class:"meter-wrapper"},B0={key:0,class:"meter"},U0=Ce({__name:"AverageScore",props:{score:{}},async setup(e){let t,n;const r=e;let s=!1;const i=wu(Iu,"scores"),o={score:r.score};[t,n]=ec(()=>x0(i,o)),await t,n();const a=async()=>{let L=0,X=0;return(await D0(wu(Iu,"scores"))).forEach(ct=>{L+=ct.data().score,X+=1}),L/X},l=([t,n]=ec(()=>a()),t=await t,n(),t),c=Math.trunc(l),u=`${c/20*100}%`,h=`${o.score/20*100}%`;let d=0,g=0,P="",I="",b="";c>o.score?(g=2,d=1,I="30%",P="95%"):c===o.score?b="(the same!)":(g=1,d=2,I="95%",P="30%");const F=gn({width:u,zIndex:d}),U=gn({width:h,zIndex:g}),W=gn({left:P}),w=gn({left:I});return s=!0,(L,X)=>(nt(),_t("div",L0,[wn(s)===!0?(nt(),_t("div",B0,[it("span",{class:"average-score",style:pn(F)},[it("span",{class:"tooltip",style:pn(W)},"Average Score",4)],4),it("span",{class:"user-score",style:pn(U)},[it("span",{class:"tooltip-lower",style:pn(w)},"Your Score "+Bn(wn(b)),5)],4)])):_h("",!0)]))}});const $0=pe(U0,[["__scopeId","data-v-e69696bf"]]),j0={class:"quiz"},q0={key:0},H0={class:"score-wrapper"},z0={class:"results"},K0={class:"result-label"},W0={key:0,class:"correct"},Q0={key:1,class:"incorrect"},G0={class:"fun-fact"},X0=Ce({__name:"ResultsSection",props:{results:{}},emits:["updateStage"],setup(e,{emit:t}){const n=e,r=ke(!1),s=ke(0),i=[],a=(()=>(n.results.forEach(c=>{const u=Wm(c);if(c.isCorrect===!0){const h={isCorrect:!0,string:`${c.answer} is not a real place.`};s.value+=1,i.push(h)}else{const h={isCorrect:!1,string:`${u}`};i.push(h)}}),r.value=!0,i))(),l=()=>{t("updateStage")};return(c,u)=>(nt(),_t("div",j0,[r.value===!0?(nt(),_t("div",q0,[it("h1",null,"You Scored: "+Bn(s.value)+"/20",1),it("div",H0,[(nt(),qe(eg,null,{default:Br(()=>[Tt($0,{score:s.value},null,8,["score"])]),_:1}))]),(nt(!0),_t(Yt,null,sh(wn(a),(h,d)=>(nt(),_t("div",z0,[it("div",K0,[it("h2",null,"Question "+Bn(d+1)+":",1),h.isCorrect===!0?(nt(),_t("h2",W0,"Correct")):(nt(),_t("h2",Q0,"Incorrect!"))]),it("p",G0,Bn(h.string),1)]))),256))])):_h("",!0),Tt($a,{onClick:l},{default:Br(()=>[os("Play Again")]),_:1})]))}});const Y0=pe(X0,[["__scopeId","data-v-cd0d1152"]]);const J0={},Z0=e=>(Da("data-v-16013df0"),e=e(),xa(),e),tw={height:"100%",version:"1.1",id:"_x32_",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512","xml:space":"preserve"},ew=Z0(()=>it("g",null,[it("path",{class:"st0",d:`M396.138,85.295c-13.172-25.037-33.795-45.898-59.342-61.03C311.26,9.2,280.435,0.001,246.98,0.001
		c-41.238-0.102-75.5,10.642-101.359,25.521c-25.962,14.826-37.156,32.088-37.156,32.088c-4.363,3.786-6.824,9.294-6.721,15.056
		c0.118,5.77,2.775,11.186,7.273,14.784l35.933,28.78c7.324,5.864,17.806,5.644,24.875-0.518c0,0,4.414-7.978,18.247-15.88
		c13.91-7.85,31.945-14.173,58.908-14.258c23.517-0.051,44.022,8.725,58.016,20.717c6.952,5.941,12.145,12.594,15.328,18.68
		c3.208,6.136,4.379,11.5,4.363,15.574c-0.068,13.766-2.742,22.77-6.603,30.442c-2.945,5.729-6.789,10.813-11.738,15.744
		c-7.384,7.384-17.398,14.207-28.634,20.479c-11.245,6.348-23.365,11.932-35.612,18.68c-13.978,7.74-28.77,18.858-39.701,35.544
		c-5.449,8.249-9.71,17.686-12.416,27.641c-2.742,9.964-3.98,20.412-3.98,31.071c0,11.372,0,20.708,0,20.708
		c0,10.719,8.69,19.41,19.41,19.41h46.762c10.719,0,19.41-8.691,19.41-19.41c0,0,0-9.336,0-20.708c0-4.107,0.467-6.755,0.917-8.436
		c0.773-2.512,1.206-3.14,2.47-4.668c1.29-1.452,3.895-3.674,8.698-6.331c7.019-3.946,18.298-9.276,31.07-16.176
		c19.121-10.456,42.367-24.646,61.972-48.062c9.752-11.686,18.374-25.758,24.323-41.968c6.001-16.21,9.242-34.431,9.226-53.96
		C410.243,120.761,404.879,101.971,396.138,85.295z`}),it("path",{class:"st0",d:`M228.809,406.44c-29.152,0-52.788,23.644-52.788,52.788c0,29.136,23.637,52.772,52.788,52.772
		c29.136,0,52.763-23.636,52.763-52.772C281.572,430.084,257.945,406.44,228.809,406.44z`})],-1)),nw=[ew];function rw(e,t){return nt(),_t("svg",tw,nw)}const sw=pe(J0,[["render",rw],["__scopeId","data-v-16013df0"]]),iw={class:"icon-box"},ow=Ce({__name:"HelpButton",setup(e){return(t,n)=>(nt(),_t("div",iw,[Tt(sw)]))}});const aw=pe(ow,[["__scopeId","data-v-bde30913"]]),lw={},cw={width:"2rem",viewBox:"0 0 15 15",version:"1.1",id:"cross",xmlns:"http://www.w3.org/2000/svg"},uw=it("path",{d:`M2.64,1.27L7.5,6.13l4.84-4.84C12.5114,1.1076,12.7497,1.0029,13,1c0.5523,0,1,0.4477,1,1
	c0.0047,0.2478-0.093,0.4866-0.27,0.66L8.84,7.5l4.89,4.89c0.1648,0.1612,0.2615,0.3796,0.27,0.61c0,0.5523-0.4477,1-1,1
	c-0.2577,0.0107-0.508-0.0873-0.69-0.27L7.5,8.87l-4.85,4.85C2.4793,13.8963,2.2453,13.9971,2,14c-0.5523,0-1-0.4477-1-1
	c-0.0047-0.2478,0.093-0.4866,0.27-0.66L6.16,7.5L1.27,2.61C1.1052,2.4488,1.0085,2.2304,1,2c0-0.5523,0.4477-1,1-1
	C2.2404,1.0029,2.4701,1.0998,2.64,1.27z`},null,-1),hw=[uw];function fw(e,t){return nt(),_t("svg",cw,hw)}const dw=pe(lw,[["render",fw]]),pw={class:"icon-box"},gw=Ce({__name:"CloseButton",setup(e){return(t,n)=>(nt(),_t("div",pw,[Tt(dw)]))}});const mw=pe(gw,[["__scopeId","data-v-be5410d3"]]),Kd=e=>(Da("data-v-6fc07798"),e=e(),xa(),e),_w={class:"quiz"},yw=Kd(()=>it("h1",null,"Place Name or Fake Name?",-1)),Ew=Kd(()=>it("h2",null,"Guess which of the three UK placenames is fake",-1)),vw=[yw,Ew],Tw=Ce({__name:"HelpModal",setup(e){return(t,n)=>(nt(),_t("div",_w,vw))}});const ww=pe(Tw,[["__scopeId","data-v-6fc07798"]]),Iw={class:"content"},Aw={class:"main"},Rw=Ce({__name:"App",setup(e){const t=ke(!1),n=ke([]),r=()=>{o.value="quiz"},s=l=>{n.value=l,o.value="answers"},i=()=>{o.value="home"};let o=ke("home");const a=()=>{t.value=!t.value};return(l,c)=>(nt(),_t(Yt,null,[it("div",{class:"top-menu",onClick:a},[t.value===!1?(nt(),qe(aw,{key:0})):(nt(),qe(mw,{key:1}))]),it("div",Iw,[Zl(Tt(ww,{class:"modal"},null,512),[[yc,t.value===!0]]),Zl(it("div",Aw,[wn(o)==="home"?(nt(),qe(Km,{key:0,onUpdateStage:r})):wn(o)==="quiz"?(nt(),qe($m,{key:1,onUpdateStage:s})):(nt(),qe(Y0,{key:2,onUpdateStage:i,results:n.value},null,8,["results"]))],512),[[yc,t.value===!1]])])],64))}});Tm(Rw).mount("#app");
